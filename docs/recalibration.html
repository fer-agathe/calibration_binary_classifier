<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>From Uncertainty to Precision: Enhancing Binary Classifier Performance through Calibration - 2&nbsp; Recalibration</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./rf-single.html" rel="next">
<link href="./calibration.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({ TeX: { extensions: ["color.js"] }});
</script>
<script type="text/x-mathjax-config">
	MathJax.Hub.Register.StartupHook("TeX color Ready", function() {
	     MathJax.Extension["TeX/color"].colors["wongBlack"] = '#000000';
		 MathJax.Extension["TeX/color"].colors["wongGold"] = '#E69F00';
		 MathJax.Extension["TeX/color"].colors["wongLightBlue"] = '#56B4E9';
		 MathJax.Extension["TeX/color"].colors["wongGreen"] = '#009E73';
		 MathJax.Extension["TeX/color"].colors["wongYellow"] = '#F0E442';
		 MathJax.Extension["TeX/color"].colors["wongBlue"] = '#0072B2';
		 MathJax.Extension["TeX/color"].colors["wongOrange"] = '#D55E00';
		 MathJax.Extension["TeX/color"].colors["wongPurple"] = '#CC79A7';
		 
		 
		 MathJax.Extension["TeX/color"].colors["IBMBlue"] = '#648FFF';
		 MathJax.Extension["TeX/color"].colors["IBMPurple"] = '#785EF0';
		 MathJax.Extension["TeX/color"].colors["IBMMagenta"] = '#DC267F';
		 MathJax.Extension["TeX/color"].colors["IBMOrange"] = '#FE6100';
		 MathJax.Extension["TeX/color"].colors["IBMYellow"] = '#FFB000';
	});
</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./calibration.html">Calibration and Recalibration</a></li><li class="breadcrumb-item"><a href="./recalibration.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Recalibration</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">From Uncertainty to Precision: Enhancing Binary Classifier Performance through Calibration</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Calibration and Recalibration</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./calibration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Calibration</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./recalibration.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Recalibration</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Machine Learning and Calibration</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rf-single.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">(Re)Calibration of a Random Forest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rf-calibration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Calibration of Random Forests</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rf-recalibration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Recalibration of Random Forests</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Real-world Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rf-grid-search.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Grid Search</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rf-simulations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Simulations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rf-simul-metrics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Simulation Metrics and Viz</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#data-generating-process" id="toc-data-generating-process" class="nav-link active" data-scroll-target="#data-generating-process"><span class="header-section-number">2.1</span> Data Generating Process</a></li>
  <li><a href="#sec-recalibration-methods" id="toc-sec-recalibration-methods" class="nav-link" data-scroll-target="#sec-recalibration-methods"><span class="header-section-number">2.2</span> Recalibration Methods</a>
  <ul class="collapse">
  <li><a href="#platt-scaling" id="toc-platt-scaling" class="nav-link" data-scroll-target="#platt-scaling"><span class="header-section-number">2.2.1</span> Platt Scaling</a></li>
  <li><a href="#isotonic-regression" id="toc-isotonic-regression" class="nav-link" data-scroll-target="#isotonic-regression"><span class="header-section-number">2.2.2</span> Isotonic Regression</a></li>
  <li><a href="#beta-calibration" id="toc-beta-calibration" class="nav-link" data-scroll-target="#beta-calibration"><span class="header-section-number">2.2.3</span> Beta Calibration</a></li>
  <li><a href="#local-regression" id="toc-local-regression" class="nav-link" data-scroll-target="#local-regression"><span class="header-section-number">2.2.4</span> Local Regression</a></li>
  </ul></li>
  <li><a href="#simulations-setup" id="toc-simulations-setup" class="nav-link" data-scroll-target="#simulations-setup"><span class="header-section-number">2.3</span> Simulations: setup</a>
  <ul class="collapse">
  <li><a href="#sec-recalib-helper-functions" id="toc-sec-recalib-helper-functions" class="nav-link" data-scroll-target="#sec-recalib-helper-functions"><span class="header-section-number">2.3.1</span> Helper Functions</a></li>
  </ul></li>
  <li><a href="#running-the-simulations" id="toc-running-the-simulations" class="nav-link" data-scroll-target="#running-the-simulations"><span class="header-section-number">2.4</span> Running the Simulations</a></li>
  <li><a href="#standard-metrics-on-simulations" id="toc-standard-metrics-on-simulations" class="nav-link" data-scroll-target="#standard-metrics-on-simulations"><span class="header-section-number">2.5</span> Standard Metrics on Simulations</a></li>
  <li><a href="#calibration-maps-single-replication" id="toc-calibration-maps-single-replication" class="nav-link" data-scroll-target="#calibration-maps-single-replication"><span class="header-section-number">2.6</span> Calibration Maps (single replication)</a>
  <ul class="collapse">
  <li><a href="#quantile-based-bins" id="toc-quantile-based-bins" class="nav-link" data-scroll-target="#quantile-based-bins"><span class="header-section-number">2.6.1</span> Quantile-Based Bins</a></li>
  <li><a href="#calibration-curve-with-moving-average" id="toc-calibration-curve-with-moving-average" class="nav-link" data-scroll-target="#calibration-curve-with-moving-average"><span class="header-section-number">2.6.2</span> Calibration Curve with Moving Average</a></li>
  </ul></li>
  <li><a href="#calibration-maps-200-replications" id="toc-calibration-maps-200-replications" class="nav-link" data-scroll-target="#calibration-maps-200-replications"><span class="header-section-number">2.7</span> Calibration Maps (200 replications)</a>
  <ul class="collapse">
  <li><a href="#quantile-based-bins-1" id="toc-quantile-based-bins-1" class="nav-link" data-scroll-target="#quantile-based-bins-1"><span class="header-section-number">2.7.1</span> Quantile-Based Bins</a></li>
  <li><a href="#calibration-curve-with-local-regression" id="toc-calibration-curve-with-local-regression" class="nav-link" data-scroll-target="#calibration-curve-with-local-regression"><span class="header-section-number">2.7.2</span> Calibration Curve with Local Regression</a></li>
  <li><a href="#calibration-curve-with-moving-average-1" id="toc-calibration-curve-with-moving-average-1" class="nav-link" data-scroll-target="#calibration-curve-with-moving-average-1"><span class="header-section-number">2.7.3</span> Calibration Curve with Moving Average</a></li>
  </ul></li>
  <li><a href="#boxplots-of-the-metrics" id="toc-boxplots-of-the-metrics" class="nav-link" data-scroll-target="#boxplots-of-the-metrics"><span class="header-section-number">2.8</span> Boxplots of the Metrics</a></li>
  <li><a href="#summary-tables" id="toc-summary-tables" class="nav-link" data-scroll-target="#summary-tables"><span class="header-section-number">2.9</span> Summary Tables</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-recalibration" class="quarto-section-identifier"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Recalibration</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>In this chapter, we explore different methods used in the literature to recalibrate a model. The basic idea is to learn a function <span class="math inline">\(g(\cdot)\)</span> mapping scores <span class="math inline">\(s(x)\)</span> into probability estimates <span class="math inline">\(g(p) := \mathbb{E}[D \mid s(x) = p]\)</span>. To avoid overfitting the training data while learning that mapping, we will rely on data from the calibration set.</p>
<p>As in <a href="calibration.html">Chapter&nbsp;<span>1</span></a>, we will transform the true probabilities <span class="math inline">\(p\)</span> of simulated data and consider these transformed values <span class="math inline">\(p^u\)</span> to be scores that could be returned by a classifier model.</p>
<div class="cell">
<details>
<summary>Display the definitions of colors.</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.4     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.0
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<details>
<summary>Display the definitions of colors.</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>wongBlack     <span class="ot">&lt;-</span> <span class="st">"#000000"</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>wongGold      <span class="ot">&lt;-</span> <span class="st">"#E69F00"</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>wongLightBlue <span class="ot">&lt;-</span> <span class="st">"#56B4E9"</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>wongGreen     <span class="ot">&lt;-</span> <span class="st">"#009E73"</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>wongYellow    <span class="ot">&lt;-</span> <span class="st">"#F0E442"</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>wongBlue      <span class="ot">&lt;-</span> <span class="st">"#0072B2"</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>wongOrange    <span class="ot">&lt;-</span> <span class="st">"#D55E00"</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>wongPurple    <span class="ot">&lt;-</span> <span class="st">"#CC79A7"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="data-generating-process" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="data-generating-process"><span class="header-section-number">2.1</span> Data Generating Process</h2>
<p>We use the same DGP as that presented in <a href="calibration.html#sec-dgp"><span>Section&nbsp;1.1</span></a> in <a href="calibration.html">Chapter&nbsp;<span>1</span></a>. Let us redefine here the function which simulates data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Simulates data</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param n_obs number of desired observations</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param seed seed to use to generate the data</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param alpha scale parameter for the latent probability (if different </span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#'   from 1, the probabilities are transformed and it may induce decalibration)</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param gamma scale parameter for the latent score (if different from 1, </span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">#'   the probabilities are transformed and it may induce decalibration)</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>sim_data <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n_obs =</span> <span class="dv">2000</span>, </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>                     seed, </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">alpha =</span> <span class="dv">1</span>, </span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">gamma =</span> <span class="dv">1</span>) {</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_obs)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_obs)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  x3 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_obs)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  x4 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_obs)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  epsilon_p <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_obs, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> .<span class="dv">5</span>)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># True latent score</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  eta <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.1</span><span class="sc">*</span>x1 <span class="sc">+</span> <span class="fl">0.05</span><span class="sc">*</span>x2 <span class="sc">+</span> <span class="fl">0.2</span><span class="sc">*</span>x3 <span class="sc">-</span> <span class="fl">0.05</span><span class="sc">*</span>x4  <span class="sc">+</span> epsilon_p</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Transformed latent score</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  eta_u <span class="ot">&lt;-</span> gamma <span class="sc">*</span> eta</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># True probability</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>eta)))</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Transformed probability</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>  p_u <span class="ot">&lt;-</span> ((<span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>eta_u))))<span class="sc">^</span>alpha</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Observed event</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n_obs, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> p)</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Event Probability</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">p =</span> p,</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_u =</span> p_u,</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Binary outcome variable</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">d =</span> d,</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Variables</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">x1 =</span> x1,</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">x2 =</span> x2,</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">x3 =</span> x3,</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">x4 =</span> x4</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sec-recalibration-methods" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="sec-recalibration-methods"><span class="header-section-number">2.2</span> Recalibration Methods</h2>
<p>To compare different calibration metrics, we will split our dataset into the following sets:</p>
<ol type="1">
<li>a calibration set: to train the recalibrator</li>
<li>a test set: on which we will compute the calibration metrics.</li>
</ol>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>In the general case where the scores are obtained using a classifier, the dataset needs to be split into three parts instead of two:</p>
<ol type="1">
<li>a train set: to train the classifier</li>
<li>a calibration set: to train the recalibrator</li>
<li>a test set: on which we will compute the calibration metrics.</li>
</ol>
</div>
</div>
<p>We define (as in the <a href="calibration.html">previous chapter&nbsp;<span>1</span></a>) a function to create the splits.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Get calibration/test samples from the DGP</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param seed seed to use to generate the data</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param n_obs number of desired observations</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param alpha scale parameter for the latent probability (if different </span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#'   from 1, the probabilities are transformed and it may induce decalibration)</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param gamma scale parameter for the latent score (if different from 1, </span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#'   the probabilities are transformed and it may induce decalibration)</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>get_samples <span class="ot">&lt;-</span> <span class="cf">function</span>(seed,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">n_obs =</span> <span class="dv">2000</span>,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">alpha =</span> <span class="dv">1</span>,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">gamma =</span> <span class="dv">1</span>) {</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  data_all <span class="ot">&lt;-</span> <span class="fu">sim_data</span>(</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_obs =</span> n_obs, <span class="at">seed =</span> seed, <span class="at">alpha =</span> alpha, <span class="at">gamma =</span> gamma</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calibration/test sets----</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> data_all <span class="sc">|&gt;</span> <span class="fu">select</span>(d, x1<span class="sc">:</span>x4)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  probas <span class="ot">&lt;-</span> data_all <span class="sc">|&gt;</span> <span class="fu">select</span>(p)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  calib_index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data), <span class="at">size =</span> .<span class="dv">6</span> <span class="sc">*</span> <span class="fu">nrow</span>(data), <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  tb_calib <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> <span class="fu">slice</span>(calib_index)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  tb_test <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="sc">-</span>calib_index)</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>  probas_calib <span class="ot">&lt;-</span> probas <span class="sc">|&gt;</span> <span class="fu">slice</span>(calib_index)</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>  probas_test <span class="ot">&lt;-</span> probas <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="sc">-</span>calib_index)</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">data_all =</span> data_all,</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> data,</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">tb_calib =</span> tb_calib,</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">tb_test =</span> tb_test,</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">probas_calib =</span> probas_calib,</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">probas_test =</span> probas_test,</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">calib_index =</span> calib_index,</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> seed,</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_obs =</span> n_obs,</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> alpha,</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">gamma =</span> gamma</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We simulate a single toy dataset to begin with. Simulations made on replications will be done later.</p>
<p>Let us consider a case where the probabilities are distorted using <span class="math inline">\(\alpha=.25\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>n_obs <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>toy_data <span class="ot">&lt;-</span> <span class="fu">get_samples</span>(<span class="at">seed =</span> <span class="dv">1</span>, <span class="at">n_obs =</span> <span class="dv">2000</span>, <span class="at">alpha =</span> .<span class="dv">25</span>, <span class="at">gamma =</span> <span class="dv">1</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>toy_data<span class="sc">$</span>data_all</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,000 × 7
       p   p_u     d     x1     x2     x3     x4
   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1 0.366 0.778     0 0.266  0.872  0.188  0.770 
 2 0.613 0.885     1 0.372  0.967  0.505  0.690 
 3 0.561 0.865     1 0.573  0.867  0.0273 0.650 
 4 0.343 0.765     1 0.908  0.438  0.496  0.0747
 5 0.293 0.736     0 0.202  0.192  0.947  0.903 
 6 0.569 0.869     0 0.898  0.0823 0.381  0.133 
 7 0.345 0.766     0 0.945  0.583  0.698  0.211 
 8 0.705 0.916     0 0.661  0.0704 0.689  0.155 
 9 0.726 0.923     1 0.629  0.528  0.478  0.0545
10 0.673 0.906     1 0.0618 0.472  0.273  0.715 
# ℹ 1,990 more rows</code></pre>
</div>
</div>
<p>We extract the calib/test datasets with true probabilities:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>data_all_calib <span class="ot">&lt;-</span> toy_data<span class="sc">$</span>data_all <span class="sc">|&gt;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(toy_data<span class="sc">$</span>calib_index)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>data_all_calib</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,200 × 7
       p   p_u     d     x1      x2    x3     x4
   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 0.670 0.905     0 0.262  0.155   0.818 0.0906
 2 0.650 0.898     1 0.975  0.683   0.697 0.367 
 3 0.413 0.802     0 0.229  0.687   0.554 0.734 
 4 0.750 0.930     1 0.0438 0.0907  0.816 0.0173
 5 0.304 0.742     0 0.0275 0.591   0.239 0.872 
 6 0.652 0.899     0 0.753  0.121   0.953 0.704 
 7 0.309 0.746     0 0.0747 0.922   0.557 0.408 
 8 0.355 0.772     0 0.914  0.493   0.205 0.175 
 9 0.555 0.863     0 0.513  0.00726 0.963 0.333 
10 0.425 0.807     0 0.386  0.802   0.313 0.571 
# ℹ 1,190 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>data_all_test <span class="ot">&lt;-</span> toy_data<span class="sc">$</span>data_all <span class="sc">|&gt;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(<span class="sc">-</span>toy_data<span class="sc">$</span>calib_index)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>data_all_test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 800 × 7
       p   p_u     d    x1     x2      x3      x4
   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
 1 0.613 0.885     1 0.372 0.967  0.505   0.690  
 2 0.498 0.840     1 0.498 0.396  0.566   0.973  
 3 0.402 0.796     1 0.718 0.106  0.0169  0.970  
 4 0.302 0.741     1 0.126 0.0102 0.554   0.507  
 5 0.684 0.909     0 0.382 0.0704 0.869   0.478  
 6 0.457 0.822     1 0.340 0.413  0.822   0.914  
 7 0.566 0.867     0 0.600 0.0802 0.983   0.377  
 8 0.760 0.934     1 0.494 0.277  0.266   0.231  
 9 0.444 0.816     1 0.827 0.0911 0.191   0.00274
10 0.637 0.894     1 0.668 0.277  0.00375 0.653  
# ℹ 790 more rows</code></pre>
</div>
</div>
<section id="platt-scaling" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="platt-scaling"><span class="header-section-number">2.2.1</span> Platt Scaling</h3>
<p>Platt scaling <span class="citation" data-cites="platt1999probabilistic">(<a href="references.html#ref-platt1999probabilistic" role="doc-biblioref">Platt et al. 1999</a>)</span> consists of applying logistic regression to <span class="math inline">\((d,s(x))\)</span> where <span class="math inline">\(d\)</span> denotes the binary outcome and <span class="math inline">\(s(x)\)</span> is the vector of predicted scores.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Logistic regression</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>lr <span class="ot">&lt;-</span> <span class="fu">glm</span>(d <span class="sc">~</span> p_u, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">'logit'</span>), <span class="at">data =</span> data_all_calib)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The predicted values in the calibration set and in the test set:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>score_c_platt_calib <span class="ot">&lt;-</span> <span class="fu">predict</span>(lr, <span class="at">newdata =</span> data_all_calib, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>score_c_platt_test <span class="ot">&lt;-</span> <span class="fu">predict</span>(lr, <span class="at">newdata =</span> data_all_test, <span class="at">type =</span> <span class="st">"response"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us create a vector of values to estimate the calibration curve.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>linspace <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can then use the fitted logistic regression to make predictions on this vector of values:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>score_c_platt_linspace <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  lr, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">p_u =</span> linspace), </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"response"</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us put these values in a tibble:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>tb_scores_c_platt <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">linspace =</span> linspace,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_c =</span> score_c_platt_linspace <span class="co">#recalibrated score</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>tb_scores_c_platt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 100 × 2
   linspace       p_c
      &lt;dbl&gt;     &lt;dbl&gt;
 1   0      0.0000729
 2   0.0101 0.0000817
 3   0.0202 0.0000917
 4   0.0303 0.000103 
 5   0.0404 0.000115 
 6   0.0505 0.000129 
 7   0.0606 0.000145 
 8   0.0707 0.000163 
 9   0.0808 0.000183 
10   0.0909 0.000205 
# ℹ 90 more rows</code></pre>
</div>
</div>
<p>The predicted probabilities <span class="math inline">\(p_u\)</span> will then be transformed according to the logistic model depicted in <a href="rf-recalibration.html#fig-recalib-platt">Figure&nbsp;<span>5.1</span></a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span>, <span class="fl">2.1</span>))</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  data_all_calib<span class="sc">$</span>p_u, data_all_calib<span class="sc">$</span>d, <span class="at">type =</span> <span class="st">"p"</span>, <span class="at">cex =</span> .<span class="dv">5</span>, <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">"black"</span>, <span class="at">alpha.f =</span> .<span class="dv">4</span>),</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"p"</span>, <span class="at">ylab =</span> <span class="st">"g(p)"</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> tb_scores_c_platt<span class="sc">$</span>linspace, <span class="at">y =</span> tb_scores_c_platt<span class="sc">$</span>p_c, </span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"#D55E00"</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-recalib-platt" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.1: Recalibration Using Platt Scaling</figcaption>
<p><img src="recalibration_files/figure-html/fig-recalib-platt-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="isotonic-regression" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="isotonic-regression"><span class="header-section-number">2.2.2</span> Isotonic Regression</h3>
<p>Isotonic regression is a non parametric approach using the pool-adjacent-violators (PAV) algorithm, introduced by <span class="citation" data-cites="Zadrozny_2002">Zadrozny and Elkan (<a href="references.html#ref-Zadrozny_2002" role="doc-biblioref">2002</a>)</span>. In a nutshell, it assumes that the predicted scores of the initial model (random forest in this notebook) reproduces well the ranks of the observations. Under this assumption, the mapping <span class="math inline">\(g(\cdot)\)</span> from the scores <span class="math inline">\(s(x)\)</span> into the probabilities <span class="math inline">\(g(p)\)</span> is non-decreasing. It is then possible to use isotonic regression to learn the mapping. The PAV algorithm works as follows:</p>
<ul>
<li><p>At a given iteration: consider the ranked examples <span class="math inline">\(x_{i-1}\)</span> and <span class="math inline">\(x_{i}\)</span>.</p>
<ul>
<li>If the current values of the function to be learned is such that <span class="math inline">\(g(x_{i-1}) \leq g(x_{i})\)</span>, nothing changes.</li>
<li>Otherwise, <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> are called <em>pair-adjacent violators</em>. The values of <span class="math inline">\(g(x_{i-1})\)</span> and <span class="math inline">\(g(x_{i})\)</span> are replaced by their mean <span class="math inline">\((g(x_{i-1}) + g(x_{i})) / 2\)</span>. If this move creates earlier violations (<span class="math inline">\(g(x_{i-1})\)</span> might be lower than <span class="math inline">\(g(x_{i-2})\)</span>), a new value is set for <span class="math inline">\(g(x_{i-2})\)</span>, <span class="math inline">\(g(x_{i-1})\)</span>, and <span class="math inline">\(g(x_{i})\)</span>, as the average in the group.</li>
</ul></li>
</ul>
<p>Let us compute the isototic least squares regression on the scores <span class="math inline">\(p_u\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>iso <span class="ot">&lt;-</span> <span class="fu">isoreg</span>(<span class="at">x =</span> data_all_calib<span class="sc">$</span>p_u, <span class="at">y =</span> data_all_calib<span class="sc">$</span>d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Transforming the fit into a function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>fit_iso <span class="ot">&lt;-</span> <span class="fu">as.stepfun</span>(iso)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The predicted values on the calibration set and on the test set:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>score_c_isotonic_calib <span class="ot">&lt;-</span> <span class="fu">fit_iso</span>(data_all_calib<span class="sc">$</span>p_u)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>score_c_isotonic_test <span class="ot">&lt;-</span> <span class="fu">fit_iso</span>(data_all_test<span class="sc">$</span>p_u)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, we can use this function to get estimated probabilities at some specific values (<code>linspace</code>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>score_c_isotonic_linspace <span class="ot">&lt;-</span> <span class="fu">fit_iso</span>(linspace)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us recreate the tibble with the recalibrated scores:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>tb_scores_c_isotonic <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">linspace =</span> linspace,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_c =</span> score_c_isotonic_linspace</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The predicted probabilities <span class="math inline">\(p_u\)</span> will then be transformed according to the logistic model depicted in <a href="rf-recalibration.html#fig-recalib-isotonic">Figure&nbsp;<span>5.2</span></a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span>, <span class="fl">2.1</span>))</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  data_all_calib<span class="sc">$</span>p_u, data_all_calib<span class="sc">$</span>d, <span class="at">type =</span> <span class="st">"p"</span>, <span class="at">cex =</span> .<span class="dv">5</span>, <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">"black"</span>, <span class="at">alpha.f =</span> .<span class="dv">4</span>),</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"p"</span>, <span class="at">ylab =</span> <span class="st">"g(p)"</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> tb_scores_c_isotonic<span class="sc">$</span>linspace, <span class="at">y =</span> tb_scores_c_isotonic<span class="sc">$</span>p_c, </span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"#D55E00"</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-recalib-isotonic" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.2: Recalibration Using Isotonic Regression</figcaption>
<p><img src="recalibration_files/figure-html/fig-recalib-isotonic-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="beta-calibration" class="level3" data-number="2.2.3">
<h3 data-number="2.2.3" class="anchored" data-anchor-id="beta-calibration"><span class="header-section-number">2.2.3</span> Beta Calibration</h3>
<p>Instead of fitting a logistic regression on the predicted values, as we know that the distribution of the values are bounded to <span class="math inline">\([0,1]\)</span>, it is possible to use beta calibration <span class="citation" data-cites="Kull_2017">Kull, Silva Filho, and Flach (<a href="references.html#ref-Kull_2017" role="doc-biblioref">2017</a>)</span>. With this method, instead of assuming that the scores obtained by the classifier are normally distributed (as is the underlying assumption when using Platt scaling), the scores are assumed to follow a Beta distribution. We estimate : <span class="math display">\[\mu(s;a,b,c) = \frac{1}{1 + \frac{1}{e^c \frac{s^a}{(1-s)^b}}}\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(betacal)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Beta calibration using the paper package</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>bc <span class="ot">&lt;-</span> <span class="fu">beta_calibration</span>(</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">p =</span> data_all_calib<span class="sc">$</span>p_u, </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> data_all_calib<span class="sc">$</span>d, </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameters =</span> <span class="st">"abm"</span> <span class="co"># 3 parameters a, b &amp; m</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -126.7104
[1] 42.94288</code></pre>
</div>
</div>
<p>The predicted values on the calibration set and on the test set:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>score_c_beta_calib <span class="ot">&lt;-</span> <span class="fu">beta_predict</span>(<span class="at">p =</span> data_all_calib<span class="sc">$</span>p_u, bc)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>score_c_beta_test <span class="ot">&lt;-</span> <span class="fu">beta_predict</span>(<span class="at">p =</span> data_all_test<span class="sc">$</span>p_u, bc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can then use the beta calibration model to make predictions at the desired values (<code>linspace</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>score_c_beta_linspace <span class="ot">&lt;-</span> <span class="fu">beta_predict</span>(linspace, bc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us recreate the tibble with the recalibrated scores:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>tb_scores_c_beta <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">linspace =</span> linspace,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_c =</span> score_c_beta_linspace</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The predicted probabilities <span class="math inline">\(p_u\)</span> will then be transformed according to the logistic model depicted in <a href="rf-recalibration.html#fig-recalib-beta">Figure&nbsp;<span>5.3</span></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span>, <span class="fl">2.1</span>))</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  data_all_calib<span class="sc">$</span>p_u, data_all_calib<span class="sc">$</span>d, <span class="at">type =</span> <span class="st">"p"</span>, <span class="at">cex =</span> .<span class="dv">5</span>, <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">"black"</span>, <span class="at">alpha.f =</span> .<span class="dv">4</span>),</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"p"</span>, <span class="at">ylab =</span> <span class="st">"g(p)"</span>,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> tb_scores_c_beta<span class="sc">$</span>linspace, <span class="at">y =</span> tb_scores_c_beta<span class="sc">$</span>p_c, </span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"#D55E00"</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-recalib-beta" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.3: Recalibration Using Beta Calibration</figcaption>
<p><img src="recalibration_files/figure-html/fig-recalib-beta-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="local-regression" class="level3" data-number="2.2.4">
<h3 data-number="2.2.4" class="anchored" data-anchor-id="local-regression"><span class="header-section-number">2.2.4</span> Local Regression</h3>
<p>Local regression fits polynomials locally to each bin defined by <code>nn</code> argument of the <code class="sourceCode r"><span class="fu">locfit</span>()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(locfit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>locfit 1.5-9.8   2023-06-11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'locfit'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    none</code></pre>
</div>
</div>
<p>We consider three versions here, with different degrees for the polynomials (0, 1, or 2). We set the number of nearest neighbors to use to <code class="sourceCode r">nn <span class="ot">=</span> <span class="fl">0.15</span></code>, that is, 15%.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Deg 0</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Deg 1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Deg 2</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Deg 0</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>locfit_0 <span class="ot">&lt;-</span> <span class="fu">locfit</span>(</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> d <span class="sc">~</span> <span class="fu">lp</span>(p_u, <span class="at">nn =</span> <span class="fl">0.15</span>, <span class="at">deg =</span> <span class="dv">0</span>), </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">kern =</span> <span class="st">"rect"</span>, <span class="at">maxk =</span> <span class="dv">200</span>, <span class="at">data =</span> data_all_calib</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us get the predicted values in the calibration data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>score_c_locfit_0_calib <span class="ot">&lt;-</span> <span class="fu">predict</span>(locfit_0, <span class="at">newdata =</span> data_all_calib)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>score_c_locfit_0_test <span class="ot">&lt;-</span> <span class="fu">predict</span>(locfit_0, <span class="at">newdata =</span> data_all_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, we can use the estimated mapping to get estimated probabilities at some specific values (<code>linspace</code>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>score_c_locfit_0_linspace <span class="ot">&lt;-</span> <span class="fu">predict</span>(locfit_0, <span class="at">newdata =</span> linspace)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Deg 1</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>locfit_1 <span class="ot">&lt;-</span> <span class="fu">locfit</span>(</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> d <span class="sc">~</span> <span class="fu">lp</span>(p_u, <span class="at">nn =</span> <span class="fl">0.15</span>, <span class="at">deg =</span> <span class="dv">1</span>), </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">kern =</span> <span class="st">"rect"</span>, <span class="at">maxk =</span> <span class="dv">200</span>, <span class="at">data =</span> data_all_calib</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us get the predicted values in the calibration data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>score_c_locfit_1_calib <span class="ot">&lt;-</span> <span class="fu">predict</span>(locfit_1, <span class="at">newdata =</span> data_all_calib)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>score_c_locfit_1_test <span class="ot">&lt;-</span> <span class="fu">predict</span>(locfit_1, <span class="at">newdata =</span> data_all_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, we can use the estimated mapping to get estimated probabilities at some specific values (<code>linspace</code>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>score_c_locfit_1_linspace <span class="ot">&lt;-</span> <span class="fu">predict</span>(locfit_1, <span class="at">newdata =</span> linspace)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Deg 2</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>locfit_2 <span class="ot">&lt;-</span> <span class="fu">locfit</span>(</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> d <span class="sc">~</span> <span class="fu">lp</span>(p_u, <span class="at">nn =</span> <span class="fl">0.15</span>, <span class="at">deg =</span> <span class="dv">2</span>), </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">kern =</span> <span class="st">"rect"</span>, <span class="at">maxk =</span> <span class="dv">200</span>, <span class="at">data =</span> data_all_calib</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us get the predicted values in the calibration data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>score_c_locfit_2_calib <span class="ot">&lt;-</span> <span class="fu">predict</span>(locfit_2, <span class="at">newdata =</span> data_all_calib)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>score_c_locfit_2_test <span class="ot">&lt;-</span> <span class="fu">predict</span>(locfit_2, <span class="at">newdata =</span> data_all_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, we can use the estimated mapping to get estimated probabilities at some specific values (<code>linspace</code>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>score_c_locfit_2_linspace <span class="ot">&lt;-</span> <span class="fu">predict</span>(locfit_2, <span class="at">newdata =</span> linspace)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>The predicted probabilities <span class="math inline">\(p_u\)</span> will then be transformed according to the logistic model depicted in <a href="rf-recalibration.html#fig-recalib-locfic-0">Figure&nbsp;<span>5.4</span></a>, <a href="rf-recalibration.html#fig-recalib-locfic-1">Figure&nbsp;<span>5.5</span></a>, and <a href="rf-recalibration.html#fig-recalib-locfic-0">Figure&nbsp;<span>5.4</span></a></p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Deg 0</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Deg 1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Deg 2</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span>, <span class="fl">2.1</span>))</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  data_all_calib<span class="sc">$</span>p_u, data_all_calib<span class="sc">$</span>d, <span class="at">type =</span> <span class="st">"p"</span>, <span class="at">cex =</span> .<span class="dv">5</span>, <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">"black"</span>, <span class="at">alpha.f =</span> .<span class="dv">4</span>),</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"p"</span>, <span class="at">ylab =</span> <span class="st">"g(p)"</span>,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> linspace, <span class="at">y =</span> score_c_locfit_0_linspace, </span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"#D55E00"</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-recalib-locfic-0" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.4: Recalibration Using Local Regression</figcaption>
<p><img src="recalibration_files/figure-html/fig-recalib-locfic-0-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span>, <span class="fl">2.1</span>))</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  data_all_calib<span class="sc">$</span>p_u, data_all_calib<span class="sc">$</span>d, <span class="at">type =</span> <span class="st">"p"</span>, <span class="at">cex =</span> .<span class="dv">5</span>, <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">"black"</span>, <span class="at">alpha.f =</span> .<span class="dv">4</span>),</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"p"</span>, <span class="at">ylab =</span> <span class="st">"g(p)"</span>,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> linspace, <span class="at">y =</span> score_c_locfit_1_linspace, </span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"#D55E00"</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-recalib-locfic-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.5: Recalibration Using Local Regression</figcaption>
<p><img src="recalibration_files/figure-html/fig-recalib-locfic-1-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span>, <span class="fl">2.1</span>))</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  data_all_calib<span class="sc">$</span>p_u, data_all_calib<span class="sc">$</span>d, <span class="at">type =</span> <span class="st">"p"</span>, <span class="at">cex =</span> .<span class="dv">5</span>, <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">"black"</span>, <span class="at">alpha.f =</span> .<span class="dv">4</span>),</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"p"</span>, <span class="at">ylab =</span> <span class="st">"g(p)"</span>,</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> linspace, <span class="at">y =</span> score_c_locfit_2_linspace, </span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"#D55E00"</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-recalib-locfic-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.6: Recalibration Using Local Regression</figcaption>
<p><img src="recalibration_files/figure-html/fig-recalib-locfic-2-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="simulations-setup" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="simulations-setup"><span class="header-section-number">2.3</span> Simulations: setup</h2>
<p>Let us now consider multiple scenarios in which the scores are distorded by varying either <span class="math inline">\(\alpha\)</span> or <span class="math inline">\(\gamma\)</span> (see <a href="calibration.html#sec-dgp"><span>Section&nbsp;1.1</span></a> in <a href="calibration.html">Chapter&nbsp;<span>1</span></a>).</p>
<p>For each value of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\gamma\)</span>, we will generate 200 replications of the whole process consisting in the following steps:</p>
<ol type="1">
<li>generate data from the PGD and transform true probabilities <span class="math inline">\(p\)</span> accordingly with either <span class="math inline">\(\alpha\)</span> or <span class="math inline">\(\gamma\)</span> to obtain <span class="math inline">\(p^u\)</span></li>
<li>split the data into two sets: calibration and test set</li>
<li>apply each recalibration method on the calibration set 4.compute calibration metrics on both sets (for comparison) using either:</li>
</ol>
<ul>
<li>the recalibrated scores <span class="math inline">\(p^c := g(s(x))\)</span></li>
<li>the estimated scores <span class="math inline">\(p^u := s(x)\)</span></li>
<li>the true probabilities <span class="math inline">\(p\)</span>.</li>
</ul>
<section id="sec-recalib-helper-functions" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="sec-recalib-helper-functions"><span class="header-section-number">2.3.1</span> Helper Functions</h3>
<p>We (re)define a helper function to compute standard metrics (see <a href="calibration.html#sec-calib-standard-metrics-simul"><span>Section&nbsp;1.4</span></a> in <a href="calibration.html">Chapter&nbsp;<span>1</span></a>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Computes goodness of fit metrics</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param true_prob true probabilities</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param obs observed values (binary outcome)</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param pred predicted scores</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param threshold classification threshold (default to `.5`)</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>compute_gof <span class="ot">&lt;-</span> <span class="cf">function</span>(true_prob,</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>                        obs, </span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>                        pred, </span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">threshold =</span> .<span class="dv">5</span>) {</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># MSE</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((true_prob <span class="sc">-</span> pred)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  pred_class <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(pred <span class="sc">&gt;</span> threshold)</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>  confusion_tb <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">obs =</span> obs,</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred =</span> pred_class</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(obs, pred)</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>  TN <span class="ot">&lt;-</span> confusion_tb <span class="sc">|&gt;</span> <span class="fu">filter</span>(obs <span class="sc">==</span> <span class="dv">0</span>, pred <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">|&gt;</span> <span class="fu">pull</span>(n)</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>  TP <span class="ot">&lt;-</span> confusion_tb <span class="sc">|&gt;</span> <span class="fu">filter</span>(obs <span class="sc">==</span> <span class="dv">1</span>, pred <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">pull</span>(n)</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>  FP <span class="ot">&lt;-</span> confusion_tb <span class="sc">|&gt;</span> <span class="fu">filter</span>(obs <span class="sc">==</span> <span class="dv">0</span>, pred <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">pull</span>(n)</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>  FN <span class="ot">&lt;-</span> confusion_tb <span class="sc">|&gt;</span> <span class="fu">filter</span>(obs <span class="sc">==</span> <span class="dv">1</span>, pred <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">|&gt;</span> <span class="fu">pull</span>(n)</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(TN) <span class="sc">==</span> <span class="dv">0</span>) TN <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(TP) <span class="sc">==</span> <span class="dv">0</span>) TP <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(FP) <span class="sc">==</span> <span class="dv">0</span>) FP <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(FN) <span class="sc">==</span> <span class="dv">0</span>) FN <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>  n_pos <span class="ot">&lt;-</span> <span class="fu">sum</span>(obs <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>  n_neg <span class="ot">&lt;-</span> <span class="fu">sum</span>(obs <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Accuracy</span></span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a>  acc <span class="ot">&lt;-</span> (TP <span class="sc">+</span> TN) <span class="sc">/</span> (n_pos <span class="sc">+</span> n_neg)</span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Missclassification rate</span></span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a>  missclass_rate <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> acc</span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sensitivity (True positive rate)</span></span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># proportion of actual positives that are correctly identified as such</span></span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a>  TPR <span class="ot">&lt;-</span> TP <span class="sc">/</span> n_pos</span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Specificity (True negative rate)</span></span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># proportion of actual negatives that are correctly identified as such</span></span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a>  TNR <span class="ot">&lt;-</span> TN <span class="sc">/</span> n_neg</span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># False positive Rate</span></span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a>  FPR <span class="ot">&lt;-</span> FP <span class="sc">/</span> n_neg</span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-48"><a href="#cb47-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb47-49"><a href="#cb47-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">mse =</span> mse,</span>
<span id="cb47-50"><a href="#cb47-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">accuracy =</span> acc,</span>
<span id="cb47-51"><a href="#cb47-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">missclass_rate =</span> missclass_rate,</span>
<span id="cb47-52"><a href="#cb47-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">sensitivity =</span> TPR,</span>
<span id="cb47-53"><a href="#cb47-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">specificity =</span> TNR,</span>
<span id="cb47-54"><a href="#cb47-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">threshold =</span> threshold,</span>
<span id="cb47-55"><a href="#cb47-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">FPR =</span> FPR</span>
<span id="cb47-56"><a href="#cb47-56" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-57"><a href="#cb47-57" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We (re)define a few helper functions to compute calibration metrics (see <a href="calibration.html#sec-measuring-calibration"><span>Section&nbsp;1.2</span></a> in <a href="calibration.html">Chapter&nbsp;<span>1</span></a>):</p>
<ul>
<li><code class="sourceCode r"><span class="fu">brier_score</span>()</code> to compute <strong>Brier Score</strong> (see <a href="calibration.html#sec-brier-score"><span>Section&nbsp;1.2.1.2</span></a> in <a href="calibration.html">Chapter&nbsp;<span>1</span></a>).</li>
</ul>
<div class="cell">
<details>
<summary>Display the functions used to compute Brier Score</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>brier_score <span class="ot">&lt;-</span> <span class="cf">function</span>(obs, scores) <span class="fu">mean</span>((scores <span class="sc">-</span> obs)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li><code class="sourceCode r"><span class="fu">e_calib_error</span>()</code> to compute the <strong>Expected Calibration Error</strong> (see <a href="calibration.html#sec-ece"><span>Section&nbsp;1.2.1.3</span></a> in <a href="calibration.html">Chapter&nbsp;<span>1</span></a>). This function relies on <code class="sourceCode r"><span class="fu">get_summary_bins</span>()</code> which computes summary statistics for binomial observed data and predicted scores returned by a model.</li>
</ul>
<div class="cell">
<details>
<summary>Display the functions used to compute the ECE</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Computes summary statistics for binomial observed data and predicted scores</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' returned by a model</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param obs vector of observed events</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param scores vector of predicted probabilities</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param k number of classes to create (quantiles, default to `10`)</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param threshold classification threshold (default to `.5`)</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="co">#' @return a tibble where each row correspond to a bin, and each columns are:</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="co">#' - `score_class`: level of the decile that the bin represents</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="co">#' - `nb`: number of observation</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="co">#' - `mean_obs`: average of obs (proportion of positive events)</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="co">#' - `mean_score`: average predicted score (confidence)</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="co">#' - `sum_obs`: number of positive events (number of positive events)</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="co">#' - `accuracy`: accuracy (share of correctly predicted, using the</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="co">#'    threshold)</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>get_summary_bins <span class="ot">&lt;-</span> <span class="cf">function</span>(obs,</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>                             scores,</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>                             <span class="at">k =</span> <span class="dv">10</span>, </span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>                             <span class="at">threshold =</span> .<span class="dv">5</span>) {</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>  breaks <span class="ot">&lt;-</span> <span class="fu">quantile</span>(scores, <span class="at">probs =</span> (<span class="dv">0</span><span class="sc">:</span>k) <span class="sc">/</span> k)</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>  tb_breaks <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">breaks =</span> breaks, <span class="at">labels =</span> <span class="dv">0</span><span class="sc">:</span>k) <span class="sc">|&gt;</span></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(breaks) <span class="sc">|&gt;</span></span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_tail</span>(<span class="at">n =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>  x_with_class <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">obs =</span> obs,</span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">score =</span> scores,</span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">score_class =</span> <span class="fu">cut</span>(</span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a>        score,</span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> tb_breaks<span class="sc">$</span>breaks,</span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">labels =</span> tb_breaks<span class="sc">$</span>labels[<span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">include.lowest =</span> <span class="cn">TRUE</span></span>
<span id="cb49-36"><a href="#cb49-36" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb49-37"><a href="#cb49-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">pred_class =</span> <span class="fu">ifelse</span>(score <span class="sc">&gt;</span> threshold, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb49-38"><a href="#cb49-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">correct_pred =</span> obs <span class="sc">==</span> pred_class</span>
<span id="cb49-39"><a href="#cb49-39" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb49-40"><a href="#cb49-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-41"><a href="#cb49-41" aria-hidden="true" tabindex="-1"></a>  x_with_class <span class="sc">|&gt;</span></span>
<span id="cb49-42"><a href="#cb49-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(score_class) <span class="sc">|&gt;</span></span>
<span id="cb49-43"><a href="#cb49-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb49-44"><a href="#cb49-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">nb =</span> <span class="fu">n</span>(),</span>
<span id="cb49-45"><a href="#cb49-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">mean_obs =</span> <span class="fu">mean</span>(obs),</span>
<span id="cb49-46"><a href="#cb49-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">mean_score =</span> <span class="fu">mean</span>(score), <span class="co"># confidence</span></span>
<span id="cb49-47"><a href="#cb49-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">sum_obs =</span> <span class="fu">sum</span>(obs),</span>
<span id="cb49-48"><a href="#cb49-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">accuracy =</span> <span class="fu">mean</span>(correct_pred)</span>
<span id="cb49-49"><a href="#cb49-49" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb49-50"><a href="#cb49-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb49-51"><a href="#cb49-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb49-52"><a href="#cb49-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">score_class =</span> <span class="fu">as.character</span>(score_class) <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb49-53"><a href="#cb49-53" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb49-54"><a href="#cb49-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(score_class)</span>
<span id="cb49-55"><a href="#cb49-55" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-56"><a href="#cb49-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-57"><a href="#cb49-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-58"><a href="#cb49-58" aria-hidden="true" tabindex="-1"></a><span class="co">#' Expected Calibration Error</span></span>
<span id="cb49-59"><a href="#cb49-59" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb49-60"><a href="#cb49-60" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param obs vector of observed events</span></span>
<span id="cb49-61"><a href="#cb49-61" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param scores vector of predicted probabilities</span></span>
<span id="cb49-62"><a href="#cb49-62" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param k number of classes to create (quantiles, default to `10`)</span></span>
<span id="cb49-63"><a href="#cb49-63" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param threshold classification threshold (default to `.5`)</span></span>
<span id="cb49-64"><a href="#cb49-64" aria-hidden="true" tabindex="-1"></a>e_calib_error <span class="ot">&lt;-</span> <span class="cf">function</span>(obs,</span>
<span id="cb49-65"><a href="#cb49-65" aria-hidden="true" tabindex="-1"></a>                          scores, </span>
<span id="cb49-66"><a href="#cb49-66" aria-hidden="true" tabindex="-1"></a>                          <span class="at">k =</span> <span class="dv">10</span>, </span>
<span id="cb49-67"><a href="#cb49-67" aria-hidden="true" tabindex="-1"></a>                          <span class="at">threshold =</span> .<span class="dv">5</span>) {</span>
<span id="cb49-68"><a href="#cb49-68" aria-hidden="true" tabindex="-1"></a>  summary_bins <span class="ot">&lt;-</span> <span class="fu">get_summary_bins</span>(</span>
<span id="cb49-69"><a href="#cb49-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">obs =</span> obs, <span class="at">scores =</span> scores, <span class="at">k =</span> k, <span class="at">threshold =</span> .<span class="dv">5</span></span>
<span id="cb49-70"><a href="#cb49-70" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb49-71"><a href="#cb49-71" aria-hidden="true" tabindex="-1"></a>  summary_bins <span class="sc">|&gt;</span></span>
<span id="cb49-72"><a href="#cb49-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ece_bin =</span> nb <span class="sc">*</span> <span class="fu">abs</span>(accuracy <span class="sc">-</span> mean_score)) <span class="sc">|&gt;</span></span>
<span id="cb49-73"><a href="#cb49-73" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">ece =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">sum</span>(nb) <span class="sc">*</span> <span class="fu">sum</span>(ece_bin)) <span class="sc">|&gt;</span></span>
<span id="cb49-74"><a href="#cb49-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(ece)</span>
<span id="cb49-75"><a href="#cb49-75" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li><code class="sourceCode r"><span class="fu">qmse_error</span>()</code> to compute <strong>Quantile-based MSE</strong> (see <a href="calibration.html#sec-qmse"><span>Section&nbsp;1.2.1.4</span></a> in <a href="calibration.html">Chapter&nbsp;<span>1</span></a>). This function also relies on <code class="sourceCode r"><span class="fu">get_summary_bins</span>()</code>.</li>
</ul>
<div class="cell">
<details>
<summary>Display the functions used to compute the QMSE</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Quantile-Based MSE</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param obs vector of observed events</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param scores vector of predicted probabilities</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param k number of classes to create (quantiles, default to `10`)</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param threshold classification threshold (default to `.5`)</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>qmse_error <span class="ot">&lt;-</span> <span class="cf">function</span>(obs,</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>                       scores, </span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">k =</span> <span class="dv">10</span>, </span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">threshold =</span> .<span class="dv">5</span>) {</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  summary_bins <span class="ot">&lt;-</span> <span class="fu">get_summary_bins</span>(</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">obs =</span> obs, <span class="at">scores =</span> scores, <span class="at">k =</span> k, <span class="at">threshold =</span> .<span class="dv">5</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  summary_bins <span class="sc">|&gt;</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">qmse_bin =</span> nb <span class="sc">*</span> (mean_obs <span class="sc">-</span> mean_score)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">|&gt;</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">qmse =</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">sum</span>(nb) <span class="sc">*</span> <span class="fu">sum</span>(qmse_bin)) <span class="sc">|&gt;</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(qmse)</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li><code class="sourceCode r"><span class="fu">wmse_error</span>()</code> to compute <strong>Weighted MSE</strong> (see <a href="calibration.html#sec-wmse"><span>Section&nbsp;1.2.1.5</span></a> in <a href="calibration.html">Chapter&nbsp;<span>1</span></a>). This function relies on <code class="sourceCode r"><span class="fu">local_ci_scores</span>()</code> which identifies the nearest neighbors of a certain predicted score and then calculates the mean scores in that neighborhood accompanied with its confidence interval.</li>
</ul>
<div class="cell">
<details>
<summary>Display the functions used to compute the WMSE</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param obs vector of observed events</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param scores vector of predicted probabilities</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param tau value at which to compute the confidence interval</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param nn fraction of nearest neighbors</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param prob level of the confidence interval (default to `.95`)</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param method Which method to use to construct the interval. Any combination</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="co">#'  of c("exact", "ac", "asymptotic", "wilson", "prop.test", "bayes", "logit",</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="co">#'  "cloglog", "probit") is allowed. Default is "all".</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="co">#' @return a tibble with a single row that corresponds to estimations made in</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="co">#'   the neighborhood of a probability $p=\tau$`, using the fraction `nn` of</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="co">#'   neighbors, where the columns are:</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="co">#'  - `score`: score tau in the neighborhood of which statistics are computed</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="co">#'  - `mean`: estimation of $E(d | s(x) = \tau)$</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a><span class="co">#'  - `lower`: lower bound of the confidence interval</span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a><span class="co">#'  - `upper`: upper bound of the confidence interval</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>local_ci_scores <span class="ot">&lt;-</span> <span class="cf">function</span>(obs,</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>                            scores,</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>                            tau,</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>                            nn,</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>                            <span class="at">prob =</span> .<span class="dv">95</span>,</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>                            <span class="at">method =</span> <span class="st">"probit"</span>) {</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Identify the k nearest neighbors based on hat{p}</span></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">length</span>(scores) <span class="sc">*</span> nn)</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>  rgs <span class="ot">&lt;-</span> <span class="fu">rank</span>(<span class="fu">abs</span>(scores <span class="sc">-</span> tau), <span class="at">ties.method =</span> <span class="st">"first"</span>)</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>  idx <span class="ot">&lt;-</span> <span class="fu">which</span>(rgs <span class="sc">&lt;=</span> k)</span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">binom.confint</span>(</span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">sum</span>(obs[idx]),</span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">length</span>(idx),</span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">conf.level =</span> prob,</span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">methods =</span> method</span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>  )[, <span class="fu">c</span>(<span class="st">"mean"</span>, <span class="st">"lower"</span>, <span class="st">"upper"</span>)] <span class="sc">|&gt;</span></span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">xlim =</span> tau) <span class="sc">|&gt;</span></span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">relocate</span>(xlim, <span class="at">.before =</span> mean)</span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a><span class="co">#' Compute the Weighted Mean Squared Error to assess the calibration of a model</span></span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param local_scores tibble with expected scores obtained with the </span></span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a><span class="co">#'   `local_ci_scores()` function</span></span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param scores vector of raw predicted probabilities</span></span>
<span id="cb51-44"><a href="#cb51-44" aria-hidden="true" tabindex="-1"></a>weighted_mse <span class="ot">&lt;-</span> <span class="cf">function</span>(local_scores, scores) {</span>
<span id="cb51-45"><a href="#cb51-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># To account for border bias (support is [0,1])</span></span>
<span id="cb51-46"><a href="#cb51-46" aria-hidden="true" tabindex="-1"></a>  scores_reflected <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span>scores, scores, <span class="dv">2</span> <span class="sc">-</span> scores)</span>
<span id="cb51-47"><a href="#cb51-47" aria-hidden="true" tabindex="-1"></a>  dens <span class="ot">&lt;-</span> <span class="fu">density</span>(</span>
<span id="cb51-48"><a href="#cb51-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> scores_reflected, <span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, </span>
<span id="cb51-49"><a href="#cb51-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">length</span>(local_scores<span class="sc">$</span>xlim)</span>
<span id="cb51-50"><a href="#cb51-50" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb51-51"><a href="#cb51-51" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The weights</span></span>
<span id="cb51-52"><a href="#cb51-52" aria-hidden="true" tabindex="-1"></a>  weights <span class="ot">&lt;-</span> dens<span class="sc">$</span>y</span>
<span id="cb51-53"><a href="#cb51-53" aria-hidden="true" tabindex="-1"></a>  local_scores <span class="sc">|&gt;</span></span>
<span id="cb51-54"><a href="#cb51-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb51-55"><a href="#cb51-55" aria-hidden="true" tabindex="-1"></a>      <span class="at">wmse_p =</span> (xlim <span class="sc">-</span> mean)<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb51-56"><a href="#cb51-56" aria-hidden="true" tabindex="-1"></a>      <span class="at">weight =</span> <span class="sc">!!</span>weights</span>
<span id="cb51-57"><a href="#cb51-57" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb51-58"><a href="#cb51-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">wmse =</span> <span class="fu">sum</span>(weight <span class="sc">*</span> wmse_p) <span class="sc">/</span> <span class="fu">sum</span>(weight)) <span class="sc">|&gt;</span></span>
<span id="cb51-59"><a href="#cb51-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(wmse)</span>
<span id="cb51-60"><a href="#cb51-60" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li><code class="sourceCode r"><span class="fu">local_calib_score</span>()</code> to compute <strong>Local Calibration Score</strong> (see <a href="calibration.html#sec-calib-lcs"><span>Section&nbsp;1.2.1.6</span></a> in <a href="calibration.html">Chapter&nbsp;<span>1</span></a>).</li>
</ul>
<div class="cell">
<details>
<summary>Display the functions used to compute the LCS</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Calibration score using Local Regression</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param obs vector of observed events</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param scores vector of predicted probabilities</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>local_calib_score <span class="ot">&lt;-</span> <span class="cf">function</span>(obs, </span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>                              scores) {</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add a little noise to the scores, to avoir crashing R</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  scores <span class="ot">&lt;-</span> scores <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(scores), <span class="dv">0</span>, .<span class="dv">001</span>)</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  locfit_0 <span class="ot">&lt;-</span> <span class="fu">locfit</span>(</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> d <span class="sc">~</span> <span class="fu">lp</span>(scores, <span class="at">nn =</span> <span class="fl">0.15</span>, <span class="at">deg =</span> <span class="dv">0</span>), </span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">kern =</span> <span class="st">"rect"</span>, <span class="at">maxk =</span> <span class="dv">200</span>, </span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">tibble</span>(</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">d =</span> obs,</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">scores =</span> scores</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Predictions on [0,1]</span></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>  linspace_raw <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Restricting this space to the range of observed scores</span></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>  keep_linspace <span class="ot">&lt;-</span> <span class="fu">which</span>(linspace_raw <span class="sc">&gt;=</span> <span class="fu">min</span>(scores) <span class="sc">&amp;</span> linspace_raw <span class="sc">&lt;=</span> <span class="fu">max</span>(scores))</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>  linspace <span class="ot">&lt;-</span> linspace_raw[keep_linspace]</span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>  locfit_0_linspace <span class="ot">&lt;-</span> <span class="fu">predict</span>(locfit_0, <span class="at">newdata =</span> linspace)</span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>  locfit_0_linspace[locfit_0_linspace <span class="sc">&gt;</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a>  locfit_0_linspace[locfit_0_linspace <span class="sc">&lt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Squared difference between predicted value and the bissector, weighted by the density of values</span></span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a>  scores_reflected <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span>scores, scores, <span class="dv">2</span> <span class="sc">-</span> scores)</span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a>  dens <span class="ot">&lt;-</span> <span class="fu">density</span>(</span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> scores_reflected, <span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, </span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">length</span>(linspace_raw)</span>
<span id="cb52-33"><a href="#cb52-33" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb52-34"><a href="#cb52-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The weights</span></span>
<span id="cb52-35"><a href="#cb52-35" aria-hidden="true" tabindex="-1"></a>  weights <span class="ot">&lt;-</span> dens<span class="sc">$</span>y[keep_linspace]</span>
<span id="cb52-36"><a href="#cb52-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-37"><a href="#cb52-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">weighted.mean</span>((linspace <span class="sc">-</span> locfit_0_linspace)<span class="sc">^</span><span class="dv">2</span>, weights)</span>
<span id="cb52-38"><a href="#cb52-38" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Then, we define the <code class="sourceCode r"><span class="fu">recalibrate</span>()</code> function which recalibrate a model using the observed events <span class="math inline">\(d\)</span>, the predicted associated probabilities <span class="math inline">\(p^u\)</span> and a given recalibration technique (as presented above in <a href="#sec-recalibration-methods"><span>Section&nbsp;2.2</span></a>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Recalibrates scores using a calibration</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param obs_calib vector of observed events in the calibration set</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param scores_calib vector of predicted probabilities in the calibration set</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co">#' #' @param obs_test vector of observed events in the test set</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param scores_test vector of predicted probabilities in the test set</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param method recalibration method (`"platt"` for Platt-Scaling, </span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="co">#'   `"isotonic"` for isotonic regression, `"beta"` for beta calibration, </span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="co">#'   `"locfit"` for local regression)</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param iso_params list of named parameters to use in the local regression </span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="co">#'   (`nn` for fraction of nearest neighbors to use, `deg` for degree)</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param linspace vector of alues at which to compute the recalibrated scores</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="co">#' @returns list of three elements: recalibrated scores on the calibration set,</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a><span class="co">#'   recalibrated scores on the test set, and recalibrated scores on a segment </span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="co">#'   of values</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>recalibrate <span class="ot">&lt;-</span> <span class="cf">function</span>(obs_calib,</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>                        scores_calib,</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>                        obs_test,</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>                        scores_test,</span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>                        <span class="at">method =</span> <span class="fu">c</span>(<span class="st">"platt"</span>, <span class="st">"isotonic"</span>, <span class="st">"beta"</span>, <span class="st">"locfit"</span>),</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>                        <span class="at">iso_params =</span> <span class="cn">NULL</span>,</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>                        <span class="at">linspace =</span> <span class="cn">NULL</span>) {</span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(linspace)) linspace <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>  data_calib <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">d =</span> obs_calib, <span class="at">p_u =</span> scores_calib)</span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>  data_test <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">d =</span> obs_test, <span class="at">p_u =</span> scores_test)</span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (method <span class="sc">==</span> <span class="st">"platt"</span>) {</span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>    lr <span class="ot">&lt;-</span> <span class="fu">glm</span>(d <span class="sc">~</span> p_u, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">'logit'</span>), <span class="at">data =</span> data_calib)</span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Recalibrated scores on calibration and test set</span></span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a>    score_c_calib <span class="ot">&lt;-</span> <span class="fu">predict</span>(lr, <span class="at">newdata =</span> data_calib, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a>    score_c_test <span class="ot">&lt;-</span> <span class="fu">predict</span>(lr, <span class="at">newdata =</span> data_test, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Recalibrated values along a segment</span></span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a>    score_c_linspace <span class="ot">&lt;-</span> <span class="fu">predict</span>(</span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a>      lr, </span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">p_u =</span> linspace), </span>
<span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">type =</span> <span class="st">"response"</span></span>
<span id="cb53-39"><a href="#cb53-39" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb53-40"><a href="#cb53-40" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (method <span class="sc">==</span> <span class="st">"isotonic"</span>) {</span>
<span id="cb53-41"><a href="#cb53-41" aria-hidden="true" tabindex="-1"></a>    iso <span class="ot">&lt;-</span> <span class="fu">isoreg</span>(<span class="at">x =</span> data_calib<span class="sc">$</span>p_u, <span class="at">y =</span> data_calib<span class="sc">$</span>d)</span>
<span id="cb53-42"><a href="#cb53-42" aria-hidden="true" tabindex="-1"></a>    fit_iso <span class="ot">&lt;-</span> <span class="fu">as.stepfun</span>(iso)</span>
<span id="cb53-43"><a href="#cb53-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Recalibrated scores on calibration and test set</span></span>
<span id="cb53-44"><a href="#cb53-44" aria-hidden="true" tabindex="-1"></a>    score_c_calib <span class="ot">&lt;-</span> <span class="fu">fit_iso</span>(data_calib<span class="sc">$</span>p_u)</span>
<span id="cb53-45"><a href="#cb53-45" aria-hidden="true" tabindex="-1"></a>    score_c_test <span class="ot">&lt;-</span> <span class="fu">fit_iso</span>(data_test<span class="sc">$</span>p_u)</span>
<span id="cb53-46"><a href="#cb53-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Recalibrated values along a segment</span></span>
<span id="cb53-47"><a href="#cb53-47" aria-hidden="true" tabindex="-1"></a>    score_c_linspace <span class="ot">&lt;-</span> <span class="fu">fit_iso</span>(linspace)</span>
<span id="cb53-48"><a href="#cb53-48" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (method <span class="sc">==</span> <span class="st">"beta"</span>) {</span>
<span id="cb53-49"><a href="#cb53-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">capture.output</span>({</span>
<span id="cb53-50"><a href="#cb53-50" aria-hidden="true" tabindex="-1"></a>      bc <span class="ot">&lt;-</span> <span class="fu">beta_calibration</span>(</span>
<span id="cb53-51"><a href="#cb53-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">p =</span> data_calib<span class="sc">$</span>p_u, </span>
<span id="cb53-52"><a href="#cb53-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> data_calib<span class="sc">$</span>d, </span>
<span id="cb53-53"><a href="#cb53-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">parameters =</span> <span class="st">"abm"</span> <span class="co"># 3 parameters a, b &amp; m</span></span>
<span id="cb53-54"><a href="#cb53-54" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb53-55"><a href="#cb53-55" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb53-56"><a href="#cb53-56" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Recalibrated scores on calibration and test set</span></span>
<span id="cb53-57"><a href="#cb53-57" aria-hidden="true" tabindex="-1"></a>    score_c_calib <span class="ot">&lt;-</span> <span class="fu">beta_predict</span>(<span class="at">p =</span> data_calib<span class="sc">$</span>p_u, bc)</span>
<span id="cb53-58"><a href="#cb53-58" aria-hidden="true" tabindex="-1"></a>    score_c_test <span class="ot">&lt;-</span> <span class="fu">beta_predict</span>(<span class="at">p =</span> data_test<span class="sc">$</span>p_u, bc)</span>
<span id="cb53-59"><a href="#cb53-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Recalibrated values along a segment</span></span>
<span id="cb53-60"><a href="#cb53-60" aria-hidden="true" tabindex="-1"></a>    score_c_linspace <span class="ot">&lt;-</span> <span class="fu">beta_predict</span>(linspace, bc)</span>
<span id="cb53-61"><a href="#cb53-61" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (method <span class="sc">==</span> <span class="st">"locfit"</span>) {</span>
<span id="cb53-62"><a href="#cb53-62" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Deg 0</span></span>
<span id="cb53-63"><a href="#cb53-63" aria-hidden="true" tabindex="-1"></a>    locfit_reg <span class="ot">&lt;-</span> <span class="fu">locfit</span>(</span>
<span id="cb53-64"><a href="#cb53-64" aria-hidden="true" tabindex="-1"></a>      <span class="at">formula =</span> d <span class="sc">~</span> <span class="fu">lp</span>(p_u, <span class="at">nn =</span> iso_params<span class="sc">$</span>nn, <span class="at">deg =</span> iso_params<span class="sc">$</span>deg), </span>
<span id="cb53-65"><a href="#cb53-65" aria-hidden="true" tabindex="-1"></a>      <span class="at">kern =</span> <span class="st">"rect"</span>, <span class="at">maxk =</span> <span class="dv">200</span>, <span class="at">data =</span> data_calib</span>
<span id="cb53-66"><a href="#cb53-66" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb53-67"><a href="#cb53-67" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Recalibrated scores on calibration and test set</span></span>
<span id="cb53-68"><a href="#cb53-68" aria-hidden="true" tabindex="-1"></a>    score_c_calib <span class="ot">&lt;-</span> <span class="fu">predict</span>(locfit_reg, <span class="at">newdata =</span> data_calib)</span>
<span id="cb53-69"><a href="#cb53-69" aria-hidden="true" tabindex="-1"></a>    score_c_calib[score_c_calib <span class="sc">&lt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb53-70"><a href="#cb53-70" aria-hidden="true" tabindex="-1"></a>    score_c_calib[score_c_calib <span class="sc">&gt;</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb53-71"><a href="#cb53-71" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb53-72"><a href="#cb53-72" aria-hidden="true" tabindex="-1"></a>    score_c_test <span class="ot">&lt;-</span> <span class="fu">predict</span>(locfit_reg, <span class="at">newdata =</span> data_test)</span>
<span id="cb53-73"><a href="#cb53-73" aria-hidden="true" tabindex="-1"></a>    score_c_test[score_c_test <span class="sc">&lt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb53-74"><a href="#cb53-74" aria-hidden="true" tabindex="-1"></a>    score_c_test[score_c_test <span class="sc">&gt;</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb53-75"><a href="#cb53-75" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb53-76"><a href="#cb53-76" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Recalibrated values along a segment</span></span>
<span id="cb53-77"><a href="#cb53-77" aria-hidden="true" tabindex="-1"></a>    score_c_linspace <span class="ot">&lt;-</span> <span class="fu">predict</span>(locfit_reg, <span class="at">newdata =</span> linspace)</span>
<span id="cb53-78"><a href="#cb53-78" aria-hidden="true" tabindex="-1"></a>    score_c_linspace[score_c_linspace <span class="sc">&lt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb53-79"><a href="#cb53-79" aria-hidden="true" tabindex="-1"></a>    score_c_linspace[score_c_linspace <span class="sc">&gt;</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb53-80"><a href="#cb53-80" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb53-81"><a href="#cb53-81" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="fu">str_c</span>(</span>
<span id="cb53-82"><a href="#cb53-82" aria-hidden="true" tabindex="-1"></a>      <span class="st">'Wrong method. Use one of the following:'</span>,</span>
<span id="cb53-83"><a href="#cb53-83" aria-hidden="true" tabindex="-1"></a>      <span class="st">'"platt", "isotonic", "beta", "locfit"'</span></span>
<span id="cb53-84"><a href="#cb53-84" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb53-85"><a href="#cb53-85" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb53-86"><a href="#cb53-86" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-87"><a href="#cb53-87" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Format results in tibbles:</span></span>
<span id="cb53-88"><a href="#cb53-88" aria-hidden="true" tabindex="-1"></a>  <span class="co"># For calibration set</span></span>
<span id="cb53-89"><a href="#cb53-89" aria-hidden="true" tabindex="-1"></a>  tb_score_c_calib <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb53-90"><a href="#cb53-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">d =</span> obs_calib,</span>
<span id="cb53-91"><a href="#cb53-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_u =</span> scores_calib,</span>
<span id="cb53-92"><a href="#cb53-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_c =</span> score_c_calib</span>
<span id="cb53-93"><a href="#cb53-93" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb53-94"><a href="#cb53-94" aria-hidden="true" tabindex="-1"></a>  <span class="co"># For test set</span></span>
<span id="cb53-95"><a href="#cb53-95" aria-hidden="true" tabindex="-1"></a>  tb_score_c_test <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb53-96"><a href="#cb53-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">d =</span> obs_test,</span>
<span id="cb53-97"><a href="#cb53-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_u =</span> scores_test,</span>
<span id="cb53-98"><a href="#cb53-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_c =</span> score_c_test</span>
<span id="cb53-99"><a href="#cb53-99" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb53-100"><a href="#cb53-100" aria-hidden="true" tabindex="-1"></a>  <span class="co"># For linear space</span></span>
<span id="cb53-101"><a href="#cb53-101" aria-hidden="true" tabindex="-1"></a>  tb_score_c_linspace <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb53-102"><a href="#cb53-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">linspace =</span> linspace,</span>
<span id="cb53-103"><a href="#cb53-103" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_c =</span> score_c_linspace</span>
<span id="cb53-104"><a href="#cb53-104" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb53-105"><a href="#cb53-105" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-106"><a href="#cb53-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb53-107"><a href="#cb53-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">tb_score_c_calib =</span> tb_score_c_calib,</span>
<span id="cb53-108"><a href="#cb53-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">tb_score_c_test =</span> tb_score_c_test,</span>
<span id="cb53-109"><a href="#cb53-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">tb_score_c_linspace =</span> tb_score_c_linspace</span>
<span id="cb53-110"><a href="#cb53-110" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb53-111"><a href="#cb53-111" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us define a function that computes the different calibration metrics for a single replication of the simulations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Computes the calibration metrics for a set of observed and predicted </span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' probabilities</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param obs observed events</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param scores predicted scores</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param true_probas true probabilities from the PGD (to compute MSE)</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param linspace vector of values at which to compute the WMSE</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>compute_metrics <span class="ot">&lt;-</span> <span class="cf">function</span>(obs, </span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>                            scores, </span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>                            true_probas,</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>                            linspace) {</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((true_probas <span class="sc">-</span> scores)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>  brier <span class="ot">&lt;-</span> <span class="fu">brier_score</span>(<span class="at">obs =</span> obs, <span class="at">scores =</span> scores)</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(<span class="fu">unique</span>(scores)) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>    ece <span class="ot">&lt;-</span> <span class="fu">e_calib_error</span>(<span class="at">obs =</span> obs, <span class="at">scores =</span> scores, <span class="at">k =</span> <span class="dv">10</span>, <span class="at">threshold =</span> .<span class="dv">5</span>)</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>    qmse <span class="ot">&lt;-</span> <span class="fu">qmse_error</span>(<span class="at">obs =</span> obs, <span class="at">scores =</span> scores, <span class="at">k =</span> <span class="dv">10</span>, <span class="at">threshold =</span> .<span class="dv">5</span>)</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>    ece <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>    qmse <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>  expected_events <span class="ot">&lt;-</span> <span class="fu">map</span>(</span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">.x =</span> linspace,</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">.f =</span> <span class="sc">~</span><span class="fu">local_ci_scores</span>(</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">obs =</span> obs, </span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">scores =</span> scores,</span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">tau =</span> .x, <span class="at">nn =</span> .<span class="dv">15</span>, <span class="at">prob =</span> .<span class="dv">95</span>, <span class="at">method =</span> <span class="st">"probit"</span>)</span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>()</span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a>  wmse <span class="ot">&lt;-</span> <span class="fu">weighted_mse</span>(<span class="at">local_scores =</span> expected_events, <span class="at">scores =</span> scores)</span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a>  lcs <span class="ot">&lt;-</span> <span class="fu">local_calib_score</span>(<span class="at">obs =</span> obs, <span class="at">scores =</span> scores)</span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">mse =</span> mse, <span class="at">brier =</span> brier, <span class="at">ece =</span> ece, <span class="at">qmse =</span> qmse, <span class="at">wmse =</span> wmse, <span class="at">lcs =</span> lcs</span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Lastly, we define the <code class="sourceCode r"><span class="fu">f_simul</span>()</code> function to perform one simulation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Performs one replication for a simulation</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param i row number of the grid to use for the simulation</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param grid grid tibble with the seed number (column `seed`) and the deformations value (either `alpha` or `gamma`)</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param n_obs desired number of observation</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param type deformation probability type (either `alpha` or `gamma`); the </span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="co">#' name should match with the `grid` tibble</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param linspace values at which to compute the mean observed event when computing the WMSE</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>f_simul <span class="ot">&lt;-</span> <span class="cf">function</span>(i, </span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>                    grid, </span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>                    n_obs, </span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"alpha"</span>, <span class="st">"gamma"</span>),</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">linspace =</span> <span class="cn">NULL</span>) {</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(linspace)) linspace <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>  <span class="do">## 1. Generate Data----</span></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>  current_seed <span class="ot">&lt;-</span> grid<span class="sc">$</span>seed[i]</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">"alpha"</span>) {</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>    transform_scale <span class="ot">&lt;-</span> grid<span class="sc">$</span>alpha[i]</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>    current_data <span class="ot">&lt;-</span> <span class="fu">get_samples</span>(</span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> current_seed, <span class="at">n_obs =</span> n_obs, <span class="at">alpha =</span> transform_scale, <span class="at">gamma =</span> <span class="dv">1</span></span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">"gamma"</span>) {</span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>    transform_scale <span class="ot">&lt;-</span> grid<span class="sc">$</span>gamma[i]</span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>    current_data <span class="ot">&lt;-</span> <span class="fu">get_samples</span>(</span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> current_seed, <span class="at">n_obs =</span> n_obs, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">gamma =</span> transform_scale</span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Transform type should be either alpha or gamma."</span>)</span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a>  <span class="do">## 2. Calibration/Test sets----</span></span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Datasets with true probabilities</span></span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a>  data_all_calib <span class="ot">&lt;-</span> current_data<span class="sc">$</span>data_all <span class="sc">|&gt;</span></span>
<span id="cb55-36"><a href="#cb55-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(current_data<span class="sc">$</span>calib_index)</span>
<span id="cb55-37"><a href="#cb55-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-38"><a href="#cb55-38" aria-hidden="true" tabindex="-1"></a>  data_all_test <span class="ot">&lt;-</span> current_data<span class="sc">$</span>data_all <span class="sc">|&gt;</span></span>
<span id="cb55-39"><a href="#cb55-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(<span class="sc">-</span>current_data<span class="sc">$</span>calib_index)</span>
<span id="cb55-40"><a href="#cb55-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-41"><a href="#cb55-41" aria-hidden="true" tabindex="-1"></a>  <span class="do">## 3. Recalibration----</span></span>
<span id="cb55-42"><a href="#cb55-42" aria-hidden="true" tabindex="-1"></a>  methods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"platt"</span>, <span class="st">"isotonic"</span>, <span class="st">"beta"</span>, <span class="st">"locfit"</span>, <span class="st">"locfit"</span>, <span class="st">"locfit"</span>)</span>
<span id="cb55-43"><a href="#cb55-43" aria-hidden="true" tabindex="-1"></a>  params <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb55-44"><a href="#cb55-44" aria-hidden="true" tabindex="-1"></a>    <span class="cn">NULL</span>, <span class="cn">NULL</span>, <span class="cn">NULL</span>, </span>
<span id="cb55-45"><a href="#cb55-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">nn =</span> .<span class="dv">15</span>, <span class="at">deg =</span> <span class="dv">0</span>), <span class="fu">list</span>(<span class="at">nn =</span> .<span class="dv">15</span>, <span class="at">deg =</span> <span class="dv">1</span>), <span class="fu">list</span>(<span class="at">nn =</span> .<span class="dv">15</span>, <span class="at">deg =</span> <span class="dv">2</span>)</span>
<span id="cb55-46"><a href="#cb55-46" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb55-47"><a href="#cb55-47" aria-hidden="true" tabindex="-1"></a>  method_names <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb55-48"><a href="#cb55-48" aria-hidden="true" tabindex="-1"></a>    <span class="st">"platt"</span>, <span class="st">"isotonic"</span>, <span class="st">"beta"</span>, <span class="st">"locfit_0"</span>, <span class="st">"locfit_1"</span>, <span class="st">"locfit_2"</span></span>
<span id="cb55-49"><a href="#cb55-49" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb55-50"><a href="#cb55-50" aria-hidden="true" tabindex="-1"></a>  res_recalibration <span class="ot">&lt;-</span> <span class="fu">map2</span>(</span>
<span id="cb55-51"><a href="#cb55-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">.x =</span> methods,</span>
<span id="cb55-52"><a href="#cb55-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">.y =</span> params,</span>
<span id="cb55-53"><a href="#cb55-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">.f =</span> <span class="sc">~</span><span class="fu">recalibrate</span>(</span>
<span id="cb55-54"><a href="#cb55-54" aria-hidden="true" tabindex="-1"></a>      <span class="at">obs_calib =</span> data_all_calib<span class="sc">$</span>d, </span>
<span id="cb55-55"><a href="#cb55-55" aria-hidden="true" tabindex="-1"></a>      <span class="at">scores_calib =</span> data_all_calib<span class="sc">$</span>p_u, </span>
<span id="cb55-56"><a href="#cb55-56" aria-hidden="true" tabindex="-1"></a>      <span class="at">obs_test =</span> data_all_test<span class="sc">$</span>d, </span>
<span id="cb55-57"><a href="#cb55-57" aria-hidden="true" tabindex="-1"></a>      <span class="at">scores_test =</span> data_all_test<span class="sc">$</span>p_u,</span>
<span id="cb55-58"><a href="#cb55-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> .x,</span>
<span id="cb55-59"><a href="#cb55-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">iso_params =</span> .y,</span>
<span id="cb55-60"><a href="#cb55-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">linspace =</span> linspace</span>
<span id="cb55-61"><a href="#cb55-61" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb55-62"><a href="#cb55-62" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb55-63"><a href="#cb55-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(res_recalibration) <span class="ot">&lt;-</span> method_names</span>
<span id="cb55-64"><a href="#cb55-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-65"><a href="#cb55-65" aria-hidden="true" tabindex="-1"></a>  <span class="do">## 4. Calibration metrics----</span></span>
<span id="cb55-66"><a href="#cb55-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-67"><a href="#cb55-67" aria-hidden="true" tabindex="-1"></a>  <span class="do">### Using True Probabilities</span></span>
<span id="cb55-68"><a href="#cb55-68" aria-hidden="true" tabindex="-1"></a>  <span class="do">#### Calibration Set</span></span>
<span id="cb55-69"><a href="#cb55-69" aria-hidden="true" tabindex="-1"></a>  calib_metrics_true_calib <span class="ot">&lt;-</span> <span class="fu">compute_metrics</span>(</span>
<span id="cb55-70"><a href="#cb55-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">obs =</span> data_all_calib<span class="sc">$</span>d, </span>
<span id="cb55-71"><a href="#cb55-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">scores =</span> data_all_calib<span class="sc">$</span>p, </span>
<span id="cb55-72"><a href="#cb55-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">true_probas =</span> data_all_calib<span class="sc">$</span>p,</span>
<span id="cb55-73"><a href="#cb55-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">linspace =</span> linspace) <span class="sc">|&gt;</span> </span>
<span id="cb55-74"><a href="#cb55-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">method =</span> <span class="st">"True Prob."</span>, <span class="at">sample =</span> <span class="st">"Calibration"</span>)</span>
<span id="cb55-75"><a href="#cb55-75" aria-hidden="true" tabindex="-1"></a>  <span class="do">#### Test Set</span></span>
<span id="cb55-76"><a href="#cb55-76" aria-hidden="true" tabindex="-1"></a>  calib_metrics_true_test <span class="ot">&lt;-</span> <span class="fu">compute_metrics</span>(</span>
<span id="cb55-77"><a href="#cb55-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">obs =</span> data_all_test<span class="sc">$</span>d, </span>
<span id="cb55-78"><a href="#cb55-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">scores =</span> data_all_test<span class="sc">$</span>p, </span>
<span id="cb55-79"><a href="#cb55-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">true_probas =</span> data_all_test<span class="sc">$</span>p,</span>
<span id="cb55-80"><a href="#cb55-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">linspace =</span> linspace) <span class="sc">|&gt;</span> </span>
<span id="cb55-81"><a href="#cb55-81" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">method =</span> <span class="st">"True Prob."</span>, <span class="at">sample =</span> <span class="st">"Test"</span>)</span>
<span id="cb55-82"><a href="#cb55-82" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-83"><a href="#cb55-83" aria-hidden="true" tabindex="-1"></a>  <span class="do">### Without Recalibration</span></span>
<span id="cb55-84"><a href="#cb55-84" aria-hidden="true" tabindex="-1"></a>  <span class="do">#### Calibration Set</span></span>
<span id="cb55-85"><a href="#cb55-85" aria-hidden="true" tabindex="-1"></a>  calib_metrics_without_calib <span class="ot">&lt;-</span> <span class="fu">compute_metrics</span>(</span>
<span id="cb55-86"><a href="#cb55-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">obs =</span> data_all_calib<span class="sc">$</span>d, </span>
<span id="cb55-87"><a href="#cb55-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">scores =</span> data_all_calib<span class="sc">$</span>p_u, </span>
<span id="cb55-88"><a href="#cb55-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">true_probas =</span> data_all_calib<span class="sc">$</span>p,</span>
<span id="cb55-89"><a href="#cb55-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">linspace =</span> linspace) <span class="sc">|&gt;</span> </span>
<span id="cb55-90"><a href="#cb55-90" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">method =</span> <span class="st">"No Calibration"</span>, <span class="at">sample =</span> <span class="st">"Calibration"</span>)</span>
<span id="cb55-91"><a href="#cb55-91" aria-hidden="true" tabindex="-1"></a>  <span class="do">#### Test Set</span></span>
<span id="cb55-92"><a href="#cb55-92" aria-hidden="true" tabindex="-1"></a>  calib_metrics_without_test <span class="ot">&lt;-</span> <span class="fu">compute_metrics</span>(</span>
<span id="cb55-93"><a href="#cb55-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">obs =</span> data_all_test<span class="sc">$</span>d, </span>
<span id="cb55-94"><a href="#cb55-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">scores =</span> data_all_test<span class="sc">$</span>p_u, </span>
<span id="cb55-95"><a href="#cb55-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">true_probas =</span> data_all_test<span class="sc">$</span>p,</span>
<span id="cb55-96"><a href="#cb55-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">linspace =</span> linspace) <span class="sc">|&gt;</span> </span>
<span id="cb55-97"><a href="#cb55-97" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">method =</span> <span class="st">"No Calibration"</span>, <span class="at">sample =</span> <span class="st">"Test"</span>)</span>
<span id="cb55-98"><a href="#cb55-98" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-99"><a href="#cb55-99" aria-hidden="true" tabindex="-1"></a>  calib_metrics <span class="ot">&lt;-</span> </span>
<span id="cb55-100"><a href="#cb55-100" aria-hidden="true" tabindex="-1"></a>    calib_metrics_true_calib <span class="sc">|&gt;</span> </span>
<span id="cb55-101"><a href="#cb55-101" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(calib_metrics_true_test) <span class="sc">|&gt;</span> </span>
<span id="cb55-102"><a href="#cb55-102" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(calib_metrics_without_calib) <span class="sc">|&gt;</span> </span>
<span id="cb55-103"><a href="#cb55-103" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(calib_metrics_without_test)</span>
<span id="cb55-104"><a href="#cb55-104" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-105"><a href="#cb55-105" aria-hidden="true" tabindex="-1"></a>  <span class="do">### With Recalibration: loop on methods</span></span>
<span id="cb55-106"><a href="#cb55-106" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (method <span class="cf">in</span> method_names) {</span>
<span id="cb55-107"><a href="#cb55-107" aria-hidden="true" tabindex="-1"></a>    res_recalibration_current <span class="ot">&lt;-</span> res_recalibration[[method]]</span>
<span id="cb55-108"><a href="#cb55-108" aria-hidden="true" tabindex="-1"></a>    <span class="do">#### Calibration Set</span></span>
<span id="cb55-109"><a href="#cb55-109" aria-hidden="true" tabindex="-1"></a>    calib_metrics_without_calib <span class="ot">&lt;-</span> <span class="fu">compute_metrics</span>(</span>
<span id="cb55-110"><a href="#cb55-110" aria-hidden="true" tabindex="-1"></a>      <span class="at">obs =</span> data_all_calib<span class="sc">$</span>d, </span>
<span id="cb55-111"><a href="#cb55-111" aria-hidden="true" tabindex="-1"></a>      <span class="at">scores =</span> res_recalibration_current<span class="sc">$</span>tb_score_c_calib<span class="sc">$</span>p_c, </span>
<span id="cb55-112"><a href="#cb55-112" aria-hidden="true" tabindex="-1"></a>      <span class="at">true_probas =</span> data_all_calib<span class="sc">$</span>p,</span>
<span id="cb55-113"><a href="#cb55-113" aria-hidden="true" tabindex="-1"></a>      <span class="at">linspace =</span> linspace) <span class="sc">|&gt;</span> </span>
<span id="cb55-114"><a href="#cb55-114" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">method =</span> method, <span class="at">sample =</span> <span class="st">"Calibration"</span>)</span>
<span id="cb55-115"><a href="#cb55-115" aria-hidden="true" tabindex="-1"></a>    <span class="do">#### Test Set</span></span>
<span id="cb55-116"><a href="#cb55-116" aria-hidden="true" tabindex="-1"></a>    calib_metrics_without_test <span class="ot">&lt;-</span> <span class="fu">compute_metrics</span>(</span>
<span id="cb55-117"><a href="#cb55-117" aria-hidden="true" tabindex="-1"></a>      <span class="at">obs =</span> data_all_test<span class="sc">$</span>d, </span>
<span id="cb55-118"><a href="#cb55-118" aria-hidden="true" tabindex="-1"></a>      <span class="at">scores =</span> res_recalibration_current<span class="sc">$</span>tb_score_c_test<span class="sc">$</span>p_c, </span>
<span id="cb55-119"><a href="#cb55-119" aria-hidden="true" tabindex="-1"></a>      <span class="at">true_probas =</span> data_all_test<span class="sc">$</span>p,</span>
<span id="cb55-120"><a href="#cb55-120" aria-hidden="true" tabindex="-1"></a>      <span class="at">linspace =</span> linspace) <span class="sc">|&gt;</span> </span>
<span id="cb55-121"><a href="#cb55-121" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">method =</span> method, <span class="at">sample =</span> <span class="st">"Test"</span>)</span>
<span id="cb55-122"><a href="#cb55-122" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb55-123"><a href="#cb55-123" aria-hidden="true" tabindex="-1"></a>    calib_metrics <span class="ot">&lt;-</span> </span>
<span id="cb55-124"><a href="#cb55-124" aria-hidden="true" tabindex="-1"></a>      calib_metrics <span class="sc">|&gt;</span> </span>
<span id="cb55-125"><a href="#cb55-125" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bind_rows</span>(calib_metrics_without_calib) <span class="sc">|&gt;</span> </span>
<span id="cb55-126"><a href="#cb55-126" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bind_rows</span>(calib_metrics_without_test)</span>
<span id="cb55-127"><a href="#cb55-127" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb55-128"><a href="#cb55-128" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-129"><a href="#cb55-129" aria-hidden="true" tabindex="-1"></a>  calib_metrics <span class="ot">&lt;-</span> </span>
<span id="cb55-130"><a href="#cb55-130" aria-hidden="true" tabindex="-1"></a>    calib_metrics <span class="sc">|&gt;</span> </span>
<span id="cb55-131"><a href="#cb55-131" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb55-132"><a href="#cb55-132" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> current_seed,</span>
<span id="cb55-133"><a href="#cb55-133" aria-hidden="true" tabindex="-1"></a>      <span class="at">transform_scale =</span> transform_scale,</span>
<span id="cb55-134"><a href="#cb55-134" aria-hidden="true" tabindex="-1"></a>      <span class="at">type =</span> type</span>
<span id="cb55-135"><a href="#cb55-135" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb55-136"><a href="#cb55-136" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-137"><a href="#cb55-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb55-138"><a href="#cb55-138" aria-hidden="true" tabindex="-1"></a>    <span class="at">res_recalibration =</span> res_recalibration,</span>
<span id="cb55-139"><a href="#cb55-139" aria-hidden="true" tabindex="-1"></a>    <span class="at">linspace =</span> linspace,</span>
<span id="cb55-140"><a href="#cb55-140" aria-hidden="true" tabindex="-1"></a>    <span class="at">calib_metrics =</span> calib_metrics,</span>
<span id="cb55-141"><a href="#cb55-141" aria-hidden="true" tabindex="-1"></a>    <span class="at">data_all_calib =</span> data_all_calib,</span>
<span id="cb55-142"><a href="#cb55-142" aria-hidden="true" tabindex="-1"></a>    <span class="at">data_all_test =</span> data_all_test,</span>
<span id="cb55-143"><a href="#cb55-143" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> current_seed</span>
<span id="cb55-144"><a href="#cb55-144" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb55-145"><a href="#cb55-145" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="running-the-simulations" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="running-the-simulations"><span class="header-section-number">2.4</span> Running the Simulations</h2>
<p>Let us now run the simulations. We consider the following values for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\gamma\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>alphas <span class="ot">&lt;-</span> gammas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For each value of <span class="math inline">\(\alpha\)</span>, and then for each value of <span class="math inline">\(\gamma\)</span>, let us make 200 replication samples from the same DGP.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>n_repl <span class="ot">&lt;-</span> <span class="dv">200</span> <span class="co"># number of replications</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>n_obs <span class="ot">&lt;-</span> <span class="dv">2000</span> <span class="co"># number of observations to draw</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>grid_alpha <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">alpha =</span> alphas, <span class="at">seed =</span> <span class="dv">1</span><span class="sc">:</span>n_repl)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>grid_gamma <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">gamma =</span> gammas, <span class="at">seed =</span> <span class="dv">1</span><span class="sc">:</span>n_repl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We perform the simulations for the varying values of <span class="math inline">\(\alpha\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(future)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>nb_cores <span class="ot">&lt;-</span> future<span class="sc">::</span><span class="fu">availableCores</span>()<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> nb_cores)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>progressr<span class="sc">::</span><span class="fu">with_progress</span>({</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> progressr<span class="sc">::</span><span class="fu">progressor</span>(<span class="at">steps =</span> <span class="fu">nrow</span>(grid_alpha))</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  simul_recalib_alpha <span class="ot">&lt;-</span> furrr<span class="sc">::</span><span class="fu">future_map</span>(</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(grid_alpha),</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.f =</span> <span class="sc">~</span>{</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">p</span>()</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">f_simul</span>(</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">i =</span> .x, </span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">grid =</span> grid_alpha, </span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_obs =</span> n_obs, </span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">"alpha"</span>, </span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">linspace =</span> <span class="cn">NULL</span>)</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">.options =</span> furrr<span class="sc">::</span><span class="fu">furrr_options</span>(<span class="at">seed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And we do the same for varying values of <span class="math inline">\(\gamma\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(future)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>nb_cores <span class="ot">&lt;-</span> future<span class="sc">::</span><span class="fu">availableCores</span>()<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> nb_cores)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>progressr<span class="sc">::</span><span class="fu">with_progress</span>({</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> progressr<span class="sc">::</span><span class="fu">progressor</span>(<span class="at">steps =</span> <span class="fu">nrow</span>(grid_gamma))</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  simul_recalib_gamma <span class="ot">&lt;-</span> furrr<span class="sc">::</span><span class="fu">future_map</span>(</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(grid_gamma),</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.f =</span> <span class="sc">~</span>{</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">p</span>()</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">f_simul</span>(</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">i =</span> .x, </span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">grid =</span> grid_gamma, </span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_obs =</span> n_obs, </span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">"gamma"</span>, </span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">linspace =</span> <span class="cn">NULL</span>)</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">.options =</span> furrr<span class="sc">::</span><span class="fu">furrr_options</span>(<span class="at">seed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="standard-metrics-on-simulations" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="standard-metrics-on-simulations"><span class="header-section-number">2.5</span> Standard Metrics on Simulations</h2>
<p>We (re)define the function <code class="sourceCode r"><span class="fu">compute_gof_simul</span>()</code> to apply <code class="sourceCode r"><span class="fu">compute_gof</span>()</code>, defined above, to compute the different standard performance metrics on recalibrated probabilities (see <a href="calibration.html#sec-calib-standard-metrics-simul"><span>Section&nbsp;1.4</span></a> in <a href="calibration.html">Chapter&nbsp;<span>1</span></a>), to which, initially, we have applied transformations:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Computes goodness of fit metrics for a replication</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param i row number of the grid to use for the simulation</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param grid grid tibble with the seed number (column `seed`) and the deformations value (either `alpha` or `gamma`)</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param n_obs desired number of observation</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param type deformation probability type (either `alpha` or `gamma`); the </span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="co">#' name should match with the `grid` tibble</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>compute_gof_simul <span class="ot">&lt;-</span> <span class="cf">function</span>(i,</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>                              grid,</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>                              n_obs,</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>                              <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"alpha"</span>, <span class="st">"gamma"</span>)) {</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>  current_seed <span class="ot">&lt;-</span> grid<span class="sc">$</span>seed[i]</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">"alpha"</span>) {</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>    transform_scale <span class="ot">&lt;-</span> grid<span class="sc">$</span>alpha[i]</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>    current_data <span class="ot">&lt;-</span> <span class="fu">get_samples</span>(</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> current_seed, <span class="at">n_obs =</span> n_obs, <span class="at">alpha =</span> transform_scale, <span class="at">gamma =</span> <span class="dv">1</span></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">"gamma"</span>) {</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>    transform_scale <span class="ot">&lt;-</span> grid<span class="sc">$</span>gamma[i]</span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>    current_data <span class="ot">&lt;-</span> <span class="fu">get_samples</span>(</span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> current_seed, <span class="at">n_obs =</span> n_obs, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">gamma =</span> transform_scale</span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Transform type should be either alpha or gamma."</span>)</span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get the calib/test datasets with true probabilities</span></span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a>  data_all_calib <span class="ot">&lt;-</span> current_data<span class="sc">$</span>data_all <span class="sc">|&gt;</span></span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(current_data<span class="sc">$</span>calib_index)</span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a>  data_all_test <span class="ot">&lt;-</span> current_data<span class="sc">$</span>data_all <span class="sc">|&gt;</span></span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(<span class="sc">-</span>current_data<span class="sc">$</span>calib_index)</span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calibration set</span></span>
<span id="cb60-36"><a href="#cb60-36" aria-hidden="true" tabindex="-1"></a>  true_prob_calib <span class="ot">&lt;-</span> data_all_calib<span class="sc">$</span>p_u</span>
<span id="cb60-37"><a href="#cb60-37" aria-hidden="true" tabindex="-1"></a>  obs_calib <span class="ot">&lt;-</span> data_all_calib<span class="sc">$</span>d</span>
<span id="cb60-38"><a href="#cb60-38" aria-hidden="true" tabindex="-1"></a>  pred_calib <span class="ot">&lt;-</span> data_all_calib<span class="sc">$</span>p</span>
<span id="cb60-39"><a href="#cb60-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-40"><a href="#cb60-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Test set</span></span>
<span id="cb60-41"><a href="#cb60-41" aria-hidden="true" tabindex="-1"></a>  true_prob_test <span class="ot">&lt;-</span> data_all_test<span class="sc">$</span>p_u</span>
<span id="cb60-42"><a href="#cb60-42" aria-hidden="true" tabindex="-1"></a>  obs_test <span class="ot">&lt;-</span> data_all_test<span class="sc">$</span>d</span>
<span id="cb60-43"><a href="#cb60-43" aria-hidden="true" tabindex="-1"></a>  pred_test <span class="ot">&lt;-</span> data_all_test<span class="sc">$</span>p</span>
<span id="cb60-44"><a href="#cb60-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-45"><a href="#cb60-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Recalibration</span></span>
<span id="cb60-46"><a href="#cb60-46" aria-hidden="true" tabindex="-1"></a>  methods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"platt"</span>, <span class="st">"isotonic"</span>, <span class="st">"beta"</span>, <span class="st">"locfit"</span>, <span class="st">"locfit"</span>, <span class="st">"locfit"</span>)</span>
<span id="cb60-47"><a href="#cb60-47" aria-hidden="true" tabindex="-1"></a>  params <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb60-48"><a href="#cb60-48" aria-hidden="true" tabindex="-1"></a>    <span class="cn">NULL</span>, <span class="cn">NULL</span>, <span class="cn">NULL</span>, </span>
<span id="cb60-49"><a href="#cb60-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">nn =</span> .<span class="dv">15</span>, <span class="at">deg =</span> <span class="dv">0</span>), <span class="fu">list</span>(<span class="at">nn =</span> .<span class="dv">15</span>, <span class="at">deg =</span> <span class="dv">1</span>), <span class="fu">list</span>(<span class="at">nn =</span> .<span class="dv">15</span>, <span class="at">deg =</span> <span class="dv">2</span>)</span>
<span id="cb60-50"><a href="#cb60-50" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb60-51"><a href="#cb60-51" aria-hidden="true" tabindex="-1"></a>  method_names <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb60-52"><a href="#cb60-52" aria-hidden="true" tabindex="-1"></a>    <span class="st">"platt"</span>, <span class="st">"isotonic"</span>, <span class="st">"beta"</span>, <span class="st">"locfit_0"</span>, <span class="st">"locfit_1"</span>, <span class="st">"locfit_2"</span></span>
<span id="cb60-53"><a href="#cb60-53" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb60-54"><a href="#cb60-54" aria-hidden="true" tabindex="-1"></a>  res_recalibration <span class="ot">&lt;-</span> <span class="fu">map2</span>(</span>
<span id="cb60-55"><a href="#cb60-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">.x =</span> methods,</span>
<span id="cb60-56"><a href="#cb60-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">.y =</span> params,</span>
<span id="cb60-57"><a href="#cb60-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">.f =</span> <span class="sc">~</span><span class="fu">recalibrate</span>(</span>
<span id="cb60-58"><a href="#cb60-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">obs_calib =</span> data_all_calib<span class="sc">$</span>d, </span>
<span id="cb60-59"><a href="#cb60-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">scores_calib =</span> data_all_calib<span class="sc">$</span>p_u, </span>
<span id="cb60-60"><a href="#cb60-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">obs_test =</span> data_all_test<span class="sc">$</span>d, </span>
<span id="cb60-61"><a href="#cb60-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">scores_test =</span> data_all_test<span class="sc">$</span>p_u,</span>
<span id="cb60-62"><a href="#cb60-62" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> .x,</span>
<span id="cb60-63"><a href="#cb60-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">iso_params =</span> .y,</span>
<span id="cb60-64"><a href="#cb60-64" aria-hidden="true" tabindex="-1"></a>      <span class="at">linspace =</span> <span class="cn">NULL</span></span>
<span id="cb60-65"><a href="#cb60-65" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb60-66"><a href="#cb60-66" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb60-67"><a href="#cb60-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(res_recalibration) <span class="ot">&lt;-</span> method_names</span>
<span id="cb60-68"><a href="#cb60-68" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-69"><a href="#cb60-69" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialisation</span></span>
<span id="cb60-70"><a href="#cb60-70" aria-hidden="true" tabindex="-1"></a>  gof_metrics_simul_calib <span class="ot">&lt;-</span> <span class="fu">tibble</span>()</span>
<span id="cb60-71"><a href="#cb60-71" aria-hidden="true" tabindex="-1"></a>  gof_metrics_simul_test <span class="ot">&lt;-</span> <span class="fu">tibble</span>()</span>
<span id="cb60-72"><a href="#cb60-72" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-73"><a href="#cb60-73" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate standard metrics</span></span>
<span id="cb60-74"><a href="#cb60-74" aria-hidden="true" tabindex="-1"></a>  <span class="do">## With Recalibration: loop on methods</span></span>
<span id="cb60-75"><a href="#cb60-75" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (method <span class="cf">in</span> method_names) {</span>
<span id="cb60-76"><a href="#cb60-76" aria-hidden="true" tabindex="-1"></a>    res_recalibration_current <span class="ot">&lt;-</span> res_recalibration[[method]]</span>
<span id="cb60-77"><a href="#cb60-77" aria-hidden="true" tabindex="-1"></a>    <span class="do">### Computation of metrics on the calibration set</span></span>
<span id="cb60-78"><a href="#cb60-78" aria-hidden="true" tabindex="-1"></a>    metrics_simul_calib <span class="ot">&lt;-</span> <span class="fu">map</span>(</span>
<span id="cb60-79"><a href="#cb60-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">.x =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">01</span>), <span class="co"># we vary the probability threshold</span></span>
<span id="cb60-80"><a href="#cb60-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">.f =</span> <span class="sc">~</span><span class="fu">compute_gof</span>(</span>
<span id="cb60-81"><a href="#cb60-81" aria-hidden="true" tabindex="-1"></a>      <span class="at">true_prob =</span> true_prob_calib,</span>
<span id="cb60-82"><a href="#cb60-82" aria-hidden="true" tabindex="-1"></a>      <span class="at">obs =</span> obs_calib,</span>
<span id="cb60-83"><a href="#cb60-83" aria-hidden="true" tabindex="-1"></a>      <span class="do">#### the predictions are now recalibrated:</span></span>
<span id="cb60-84"><a href="#cb60-84" aria-hidden="true" tabindex="-1"></a>      <span class="at">pred =</span> res_recalibration_current<span class="sc">$</span>tb_score_c_calib<span class="sc">$</span>p_c,</span>
<span id="cb60-85"><a href="#cb60-85" aria-hidden="true" tabindex="-1"></a>      <span class="at">threshold =</span> .x</span>
<span id="cb60-86"><a href="#cb60-86" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb60-87"><a href="#cb60-87" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb60-88"><a href="#cb60-88" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list_rbind</span>()</span>
<span id="cb60-89"><a href="#cb60-89" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb60-90"><a href="#cb60-90" aria-hidden="true" tabindex="-1"></a>    <span class="do">### Computation of metricson the test set</span></span>
<span id="cb60-91"><a href="#cb60-91" aria-hidden="true" tabindex="-1"></a>    metrics_simul_test <span class="ot">&lt;-</span> <span class="fu">map</span>(</span>
<span id="cb60-92"><a href="#cb60-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">.x =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">01</span>), <span class="co"># we vary the probability threshold</span></span>
<span id="cb60-93"><a href="#cb60-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">.f =</span> <span class="sc">~</span><span class="fu">compute_gof</span>(</span>
<span id="cb60-94"><a href="#cb60-94" aria-hidden="true" tabindex="-1"></a>      <span class="at">true_prob =</span> true_prob_test,</span>
<span id="cb60-95"><a href="#cb60-95" aria-hidden="true" tabindex="-1"></a>      <span class="at">obs =</span> obs_test,</span>
<span id="cb60-96"><a href="#cb60-96" aria-hidden="true" tabindex="-1"></a>      <span class="do">#### the predictions are now recalibrated:</span></span>
<span id="cb60-97"><a href="#cb60-97" aria-hidden="true" tabindex="-1"></a>      <span class="at">pred =</span> res_recalibration_current<span class="sc">$</span>tb_score_c_test<span class="sc">$</span>p_c,</span>
<span id="cb60-98"><a href="#cb60-98" aria-hidden="true" tabindex="-1"></a>      <span class="at">threshold =</span> .x</span>
<span id="cb60-99"><a href="#cb60-99" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb60-100"><a href="#cb60-100" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb60-101"><a href="#cb60-101" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list_rbind</span>()</span>
<span id="cb60-102"><a href="#cb60-102" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb60-103"><a href="#cb60-103" aria-hidden="true" tabindex="-1"></a>    roc_calib <span class="ot">&lt;-</span> pROC<span class="sc">::</span><span class="fu">roc</span>(</span>
<span id="cb60-104"><a href="#cb60-104" aria-hidden="true" tabindex="-1"></a>      obs_calib, </span>
<span id="cb60-105"><a href="#cb60-105" aria-hidden="true" tabindex="-1"></a>      res_recalibration_current<span class="sc">$</span>tb_score_c_calib<span class="sc">$</span>p_c</span>
<span id="cb60-106"><a href="#cb60-106" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb60-107"><a href="#cb60-107" aria-hidden="true" tabindex="-1"></a>    auc_calib <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(pROC<span class="sc">::</span><span class="fu">auc</span>(roc_calib))</span>
<span id="cb60-108"><a href="#cb60-108" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb60-109"><a href="#cb60-109" aria-hidden="true" tabindex="-1"></a>    roc_test <span class="ot">&lt;-</span> pROC<span class="sc">::</span><span class="fu">roc</span>(</span>
<span id="cb60-110"><a href="#cb60-110" aria-hidden="true" tabindex="-1"></a>      obs_test, </span>
<span id="cb60-111"><a href="#cb60-111" aria-hidden="true" tabindex="-1"></a>      res_recalibration_current<span class="sc">$</span>tb_score_c_test<span class="sc">$</span>p_c</span>
<span id="cb60-112"><a href="#cb60-112" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb60-113"><a href="#cb60-113" aria-hidden="true" tabindex="-1"></a>    auc_test <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(pROC<span class="sc">::</span><span class="fu">auc</span>(roc_test))</span>
<span id="cb60-114"><a href="#cb60-114" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb60-115"><a href="#cb60-115" aria-hidden="true" tabindex="-1"></a>    metrics_simul_calib <span class="ot">&lt;-</span> metrics_simul_calib <span class="sc">|&gt;</span></span>
<span id="cb60-116"><a href="#cb60-116" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb60-117"><a href="#cb60-117" aria-hidden="true" tabindex="-1"></a>        <span class="at">auc =</span> auc_calib,</span>
<span id="cb60-118"><a href="#cb60-118" aria-hidden="true" tabindex="-1"></a>        <span class="at">seed =</span> current_seed,</span>
<span id="cb60-119"><a href="#cb60-119" aria-hidden="true" tabindex="-1"></a>        <span class="at">scale_parameter =</span> transform_scale,</span>
<span id="cb60-120"><a href="#cb60-120" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> type,</span>
<span id="cb60-121"><a href="#cb60-121" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> method,</span>
<span id="cb60-122"><a href="#cb60-122" aria-hidden="true" tabindex="-1"></a>        <span class="at">sample =</span> <span class="st">"calibration"</span></span>
<span id="cb60-123"><a href="#cb60-123" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb60-124"><a href="#cb60-124" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb60-125"><a href="#cb60-125" aria-hidden="true" tabindex="-1"></a>    metrics_simul_test <span class="ot">&lt;-</span> metrics_simul_test <span class="sc">|&gt;</span></span>
<span id="cb60-126"><a href="#cb60-126" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb60-127"><a href="#cb60-127" aria-hidden="true" tabindex="-1"></a>        <span class="at">auc =</span> auc_test,</span>
<span id="cb60-128"><a href="#cb60-128" aria-hidden="true" tabindex="-1"></a>        <span class="at">seed =</span> current_seed,</span>
<span id="cb60-129"><a href="#cb60-129" aria-hidden="true" tabindex="-1"></a>        <span class="at">scale_parameter =</span> transform_scale,</span>
<span id="cb60-130"><a href="#cb60-130" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> type,</span>
<span id="cb60-131"><a href="#cb60-131" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> method,</span>
<span id="cb60-132"><a href="#cb60-132" aria-hidden="true" tabindex="-1"></a>        <span class="at">sample =</span> <span class="st">"test"</span></span>
<span id="cb60-133"><a href="#cb60-133" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb60-134"><a href="#cb60-134" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb60-135"><a href="#cb60-135" aria-hidden="true" tabindex="-1"></a>    gof_metrics_simul_calib <span class="ot">&lt;-</span> gof_metrics_simul_calib <span class="sc">|&gt;</span></span>
<span id="cb60-136"><a href="#cb60-136" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bind_rows</span>(metrics_simul_calib)</span>
<span id="cb60-137"><a href="#cb60-137" aria-hidden="true" tabindex="-1"></a>    gof_metrics_simul_test <span class="ot">&lt;-</span> gof_metrics_simul_test <span class="sc">|&gt;</span></span>
<span id="cb60-138"><a href="#cb60-138" aria-hidden="true" tabindex="-1"></a>      <span class="fu">bind_rows</span>(metrics_simul_test)</span>
<span id="cb60-139"><a href="#cb60-139" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb60-140"><a href="#cb60-140" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-141"><a href="#cb60-141" aria-hidden="true" tabindex="-1"></a>  gof_metrics_simul_calib <span class="sc">|&gt;</span> </span>
<span id="cb60-142"><a href="#cb60-142" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(gof_metrics_simul_test)</span>
<span id="cb60-143"><a href="#cb60-143" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us apply the function <code class="sourceCode r">compute_gof_simul</code> to the different simulations. We begin with the recalibrated probabilities initially transformed according to the variation of the parameter <span class="math inline">\(\alpha\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(future)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>nb_cores <span class="ot">&lt;-</span> future<span class="sc">::</span><span class="fu">availableCores</span>()<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> nb_cores)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>progressr<span class="sc">::</span><span class="fu">with_progress</span>({</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> progressr<span class="sc">::</span><span class="fu">progressor</span>(<span class="at">steps =</span> <span class="fu">nrow</span>(grid_alpha))</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  recalib_metrics_alpha <span class="ot">&lt;-</span> furrr<span class="sc">::</span><span class="fu">future_map</span>(</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(grid_alpha),</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.f =</span> <span class="sc">~</span>{</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">p</span>()</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">compute_gof_simul</span>(</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">i =</span> .x, </span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">grid =</span> grid_alpha, </span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_obs =</span> n_obs, </span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">"alpha"</span></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">.options =</span> furrr<span class="sc">::</span><span class="fu">furrr_options</span>(<span class="at">seed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>recalib_metrics_alpha <span class="ot">&lt;-</span> <span class="fu">list_rbind</span>(recalib_metrics_alpha)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We do the same for <span class="math inline">\(\gamma\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(future)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>nb_cores <span class="ot">&lt;-</span> future<span class="sc">::</span><span class="fu">availableCores</span>()<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> nb_cores)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>progressr<span class="sc">::</span><span class="fu">with_progress</span>({</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> progressr<span class="sc">::</span><span class="fu">progressor</span>(<span class="at">steps =</span> <span class="fu">nrow</span>(grid_gamma))</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  recalib_metrics_gamma <span class="ot">&lt;-</span> furrr<span class="sc">::</span><span class="fu">future_map</span>(</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(grid_gamma),</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.f =</span> <span class="sc">~</span>{</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">p</span>()</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">compute_gof_simul</span>(</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">i =</span> .x, </span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">grid =</span> grid_gamma, </span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">n_obs =</span> n_obs, </span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">"gamma"</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">.options =</span> furrr<span class="sc">::</span><span class="fu">furrr_options</span>(<span class="at">seed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>recalib_metrics_gamma <span class="ot">&lt;-</span> <span class="fu">list_rbind</span>(recalib_metrics_gamma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We (re)define function <code class="sourceCode r"><span class="fu">boxplot_simuls_metrics</span>()</code> from <a href="calibration.html#sec-calib-standard-metrics-simul"><span>Section&nbsp;1.4</span></a> (<a href="calibration.html">Chapter&nbsp;<span>1</span></a>) to plot the standard metrics results on the recalibrated simulations. This function will produce a panel of boxplots. Each row of the panel will correspond to a metric whereas each column will correspond to a value for either <span class="math inline">\(\alpha\)</span> or <span class="math inline">\(\gamma\)</span>. We also have one column for each recalibration method used. On each figure, the x-axis will correspond to the value used for the probability threshold <span class="math inline">\(\tau\)</span>, and the y-axis will correspond to the values of the metric.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Boxplots for the simulations to visualize the distribution of some </span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' traditional metrics as a function of the probability threshold.</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' And, ROC curves</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co">#' The resulting figure is a panel of graphs, with vayring values for the </span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="co">#' transformation applied to the probabilities (in columns) and different </span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="co">#' metrics (in rows).</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param tb_metrics tibble with computed metrics for the simulations</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param type type of transformation: `"alpha"` or `"gamma"`</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param metrics names of the metrics computed</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>boxplot_simuls_metrics <span class="ot">&lt;-</span> <span class="cf">function</span>(tb_metrics,</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"alpha"</span>, <span class="st">"gamma"</span>),</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>                                   metrics) {</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>  scale_parameters <span class="ot">&lt;-</span> <span class="fu">unique</span>(tb_metrics<span class="sc">$</span>scale_parameter)</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="fu">length</span>(metrics), <span class="fu">length</span>(scale_parameters)))</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i_metric <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(metrics)) {</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>    metric <span class="ot">&lt;-</span> metrics[i_metric]</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i_scale_parameter <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(scale_parameters)) {</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>      scale_parameter <span class="ot">&lt;-</span> scale_parameters[i_scale_parameter]</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>      tb_metrics_current <span class="ot">&lt;-</span> tb_metrics <span class="sc">|&gt;</span> </span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(scale_parameter <span class="sc">==</span> <span class="sc">!!</span>scale_parameter)</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (metric <span class="sc">==</span> <span class="st">"roc"</span>) {</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>        seeds <span class="ot">&lt;-</span> <span class="fu">unique</span>(tb_metrics_current<span class="sc">$</span>seed)</span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (i_metric <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>          <span class="co"># first row</span></span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>          title <span class="ot">&lt;-</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>            <span class="fu">str_c</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">"</span>, type, <span class="st">" = "</span>, <span class="fu">round</span>(scale_parameter, <span class="dv">2</span>), <span class="st">"$"</span>)</span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>          size_top <span class="ot">&lt;-</span> <span class="fl">2.1</span></span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> <span class="cf">if</span> (i_metric <span class="sc">==</span> <span class="fu">length</span>(metrics)) {</span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a>          <span class="co"># Last row</span></span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a>          title <span class="ot">&lt;-</span> <span class="st">""</span></span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a>          size_top <span class="ot">&lt;-</span> <span class="fl">1.1</span></span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a>          title <span class="ot">&lt;-</span> <span class="st">""</span></span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a>          size_top <span class="ot">&lt;-</span> <span class="fl">1.1</span></span>
<span id="cb63-40"><a href="#cb63-40" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb63-41"><a href="#cb63-41" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb63-42"><a href="#cb63-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (i_scale_parameter <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb63-43"><a href="#cb63-43" aria-hidden="true" tabindex="-1"></a>          <span class="co"># first column</span></span>
<span id="cb63-44"><a href="#cb63-44" aria-hidden="true" tabindex="-1"></a>          y_lab <span class="ot">&lt;-</span> <span class="fu">str_c</span>(metric, <span class="st">"</span><span class="sc">\n</span><span class="st"> True Positive Rate"</span>) </span>
<span id="cb63-45"><a href="#cb63-45" aria-hidden="true" tabindex="-1"></a>          size_left <span class="ot">&lt;-</span> <span class="fl">5.1</span></span>
<span id="cb63-46"><a href="#cb63-46" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb63-47"><a href="#cb63-47" aria-hidden="true" tabindex="-1"></a>          y_lab <span class="ot">&lt;-</span> <span class="st">""</span></span>
<span id="cb63-48"><a href="#cb63-48" aria-hidden="true" tabindex="-1"></a>          size_left <span class="ot">&lt;-</span> <span class="fl">4.1</span></span>
<span id="cb63-49"><a href="#cb63-49" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb63-50"><a href="#cb63-50" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb63-51"><a href="#cb63-51" aria-hidden="true" tabindex="-1"></a>        <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">4.5</span>, size_left, size_top, <span class="fl">2.1</span>))</span>
<span id="cb63-52"><a href="#cb63-52" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plot</span>(</span>
<span id="cb63-53"><a href="#cb63-53" aria-hidden="true" tabindex="-1"></a>          <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,</span>
<span id="cb63-54"><a href="#cb63-54" aria-hidden="true" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="cn">NULL</span>,</span>
<span id="cb63-55"><a href="#cb63-55" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlim =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">ylim =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,</span>
<span id="cb63-56"><a href="#cb63-56" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, </span>
<span id="cb63-57"><a href="#cb63-57" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> y_lab,</span>
<span id="cb63-58"><a href="#cb63-58" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">""</span></span>
<span id="cb63-59"><a href="#cb63-59" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb63-60"><a href="#cb63-60" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (i_seed <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(seeds)) {</span>
<span id="cb63-61"><a href="#cb63-61" aria-hidden="true" tabindex="-1"></a>          tb_metrics_current_seed <span class="ot">&lt;-</span> </span>
<span id="cb63-62"><a href="#cb63-62" aria-hidden="true" tabindex="-1"></a>            tb_metrics_current <span class="sc">|&gt;</span> </span>
<span id="cb63-63"><a href="#cb63-63" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(seed <span class="sc">==</span> seeds[i_seed])</span>
<span id="cb63-64"><a href="#cb63-64" aria-hidden="true" tabindex="-1"></a>          <span class="fu">lines</span>(</span>
<span id="cb63-65"><a href="#cb63-65" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> tb_metrics_current_seed<span class="sc">$</span>FPR, </span>
<span id="cb63-66"><a href="#cb63-66" aria-hidden="true" tabindex="-1"></a>            <span class="at">y =</span> tb_metrics_current_seed<span class="sc">$</span>sensitivity,</span>
<span id="cb63-67"><a href="#cb63-67" aria-hidden="true" tabindex="-1"></a>            <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">"black"</span>, <span class="at">alpha.f =</span> .<span class="dv">04</span>)</span>
<span id="cb63-68"><a href="#cb63-68" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb63-69"><a href="#cb63-69" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb63-70"><a href="#cb63-70" aria-hidden="true" tabindex="-1"></a>        <span class="fu">segments</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb63-71"><a href="#cb63-71" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb63-72"><a href="#cb63-72" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb63-73"><a href="#cb63-73" aria-hidden="true" tabindex="-1"></a>        <span class="co"># not ROC</span></span>
<span id="cb63-74"><a href="#cb63-74" aria-hidden="true" tabindex="-1"></a>        tb_metrics_current <span class="ot">&lt;-</span> </span>
<span id="cb63-75"><a href="#cb63-75" aria-hidden="true" tabindex="-1"></a>          tb_metrics_current <span class="sc">|&gt;</span> </span>
<span id="cb63-76"><a href="#cb63-76" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(threshold <span class="sc">%in%</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">1</span>))</span>
<span id="cb63-77"><a href="#cb63-77" aria-hidden="true" tabindex="-1"></a>        form <span class="ot">&lt;-</span> <span class="fu">str_c</span>(metric, <span class="st">"~threshold"</span>)</span>
<span id="cb63-78"><a href="#cb63-78" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (i_metric <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb63-79"><a href="#cb63-79" aria-hidden="true" tabindex="-1"></a>          <span class="co"># first row</span></span>
<span id="cb63-80"><a href="#cb63-80" aria-hidden="true" tabindex="-1"></a>          title <span class="ot">&lt;-</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(</span>
<span id="cb63-81"><a href="#cb63-81" aria-hidden="true" tabindex="-1"></a>            <span class="fu">str_c</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">"</span>, type, <span class="st">" = "</span>, <span class="fu">round</span>(scale_parameter, <span class="dv">2</span>), <span class="st">"$"</span>)</span>
<span id="cb63-82"><a href="#cb63-82" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb63-83"><a href="#cb63-83" aria-hidden="true" tabindex="-1"></a>          size_top <span class="ot">&lt;-</span> <span class="fl">2.1</span></span>
<span id="cb63-84"><a href="#cb63-84" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> <span class="cf">if</span> (i_metric <span class="sc">==</span> <span class="fu">length</span>(metrics)) {</span>
<span id="cb63-85"><a href="#cb63-85" aria-hidden="true" tabindex="-1"></a>          <span class="co"># Last row</span></span>
<span id="cb63-86"><a href="#cb63-86" aria-hidden="true" tabindex="-1"></a>          title <span class="ot">&lt;-</span> <span class="st">""</span></span>
<span id="cb63-87"><a href="#cb63-87" aria-hidden="true" tabindex="-1"></a>          size_top <span class="ot">&lt;-</span> <span class="fl">1.1</span></span>
<span id="cb63-88"><a href="#cb63-88" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb63-89"><a href="#cb63-89" aria-hidden="true" tabindex="-1"></a>          title <span class="ot">&lt;-</span> <span class="st">""</span></span>
<span id="cb63-90"><a href="#cb63-90" aria-hidden="true" tabindex="-1"></a>          size_top <span class="ot">&lt;-</span> <span class="fl">1.1</span></span>
<span id="cb63-91"><a href="#cb63-91" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb63-92"><a href="#cb63-92" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb63-93"><a href="#cb63-93" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (i_scale_parameter <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb63-94"><a href="#cb63-94" aria-hidden="true" tabindex="-1"></a>          <span class="co"># first column</span></span>
<span id="cb63-95"><a href="#cb63-95" aria-hidden="true" tabindex="-1"></a>          y_lab <span class="ot">&lt;-</span> metric</span>
<span id="cb63-96"><a href="#cb63-96" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb63-97"><a href="#cb63-97" aria-hidden="true" tabindex="-1"></a>          y_lab <span class="ot">&lt;-</span> <span class="st">""</span></span>
<span id="cb63-98"><a href="#cb63-98" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb63-99"><a href="#cb63-99" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb63-100"><a href="#cb63-100" aria-hidden="true" tabindex="-1"></a>        <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">4.5</span>, <span class="fl">4.1</span>, size_top, <span class="fl">2.1</span>))</span>
<span id="cb63-101"><a href="#cb63-101" aria-hidden="true" tabindex="-1"></a>        <span class="fu">boxplot</span>(</span>
<span id="cb63-102"><a href="#cb63-102" aria-hidden="true" tabindex="-1"></a>          <span class="fu">formula</span>(form), <span class="at">data =</span> tb_metrics_current,</span>
<span id="cb63-103"><a href="#cb63-103" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">"Threshold"</span>, <span class="at">ylab =</span> y_lab,</span>
<span id="cb63-104"><a href="#cb63-104" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> title</span>
<span id="cb63-105"><a href="#cb63-105" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb63-106"><a href="#cb63-106" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb63-107"><a href="#cb63-107" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb63-108"><a href="#cb63-108" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb63-109"><a href="#cb63-109" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We aim to create a set of boxplots to visually assess the influence of probability transformations using <span class="math inline">\(\alpha\)</span> or <span class="math inline">\(\gamma\)</span> on standard metrics. Whenever <span class="math inline">\(\alpha \neq 1\)</span> or <span class="math inline">\(\gamma \neq 1\)</span>, the resulting scores <span class="math inline">\(p^c\)</span> represent values akin to those obtained from an initially uncalibrated model, with recalibration method applied. We want to verify that the recalibration methods applied to the uncalibrated probabilities do not degrade performance, as assessed by standard metrics. The results are shown in <a href="calibration.html#fig-standard-metrics-calib-boxplot-alpha">Figure&nbsp;<span>1.6</span></a> for vayring values of <span class="math inline">\(\alpha\)</span>, and in <a href="calibration.html#fig-standard-metrics-calib-boxplot-gamma">Figure&nbsp;<span>1.7</span></a> for vayring values of <span class="math inline">\(\gamma\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>When using monotone transformation methods such as isotonic regression, the AUC cannot be degraded as it is insensitive to the application of an increasing function to the predicted scores by a model. Isotonic regression assumes that the initial model, without recalibration, has an AUC of 1. Therefore, if the initial model requires decreasing transformations in the recalibration step, isotonic regression will not be effective.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>metrics <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"mse"</span>, <span class="st">"accuracy"</span>, <span class="st">"sensitivity"</span>, <span class="st">"specificity"</span>, <span class="st">"roc"</span>, <span class="st">"auc"</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"platt"</span>, <span class="st">"isotonic"</span>, <span class="st">"beta"</span>, <span class="st">"locfit"</span>, <span class="st">"locfit"</span>, <span class="st">"locfit"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Varying <span class="math inline">\(\alpha\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Varying <span class="math inline">\(\gamma\)</span></a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Platt</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Isotonic</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Beta</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">Locfit (deg = 0)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-5" role="tab" aria-controls="tabset-3-5" aria-selected="false">Locfit (deg = 1)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-6" role="tab" aria-controls="tabset-3-6" aria-selected="false">Locfit (deg = 2)</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details>
<summary>Display the R codes to produce the Figure.</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>current_recalib_metrics <span class="ot">&lt;-</span> recalib_metrics_alpha <span class="sc">|&gt;</span> <span class="fu">filter</span>(method <span class="sc">==</span> <span class="st">"platt"</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot_simuls_metrics</span>(</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">tb_metrics =</span> current_recalib_metrics, </span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"alpha"</span>, <span class="at">metrics =</span> metrics</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-standard-metrics-calib-boxplot-alpha-platt" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.7: Calibration transformations made by varying <span class="math inline">\(\alpha\)</span> and impact on standard metrics. The model is calibrated when <span class="math inline">\(\alpha=1\)</span>. The scores have been recalibrated using Platt-scaling.</figcaption>
<p><img src="recalibration_files/figure-html/fig-standard-metrics-calib-boxplot-alpha-platt-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<details>
<summary>Display the R codes to produce the Figure.</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>current_recalib_metrics <span class="ot">&lt;-</span> recalib_metrics_alpha <span class="sc">|&gt;</span> <span class="fu">filter</span>(method <span class="sc">==</span> <span class="st">"isotonic"</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot_simuls_metrics</span>(</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">tb_metrics =</span> current_recalib_metrics, </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"alpha"</span>, <span class="at">metrics =</span> metrics</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-standard-metrics-calib-boxplot-alpha-isotonic" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.8: Calibration transformations made by varying <span class="math inline">\(\alpha\)</span> and impact on standard metrics. The model is calibrated when <span class="math inline">\(\alpha=1\)</span>. The scores have been recalibrated using Isotonic regression.</figcaption>
<p><img src="recalibration_files/figure-html/fig-standard-metrics-calib-boxplot-alpha-isotonic-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<details>
<summary>Display the R codes to produce the Figure.</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>current_recalib_metrics <span class="ot">&lt;-</span> recalib_metrics_alpha <span class="sc">|&gt;</span> <span class="fu">filter</span>(method <span class="sc">==</span> <span class="st">"beta"</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot_simuls_metrics</span>(</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">tb_metrics =</span> current_recalib_metrics, </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"alpha"</span>, <span class="at">metrics =</span> metrics</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-standard-metrics-calib-boxplot-alpha-beta" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.9: Calibration transformations made by varying <span class="math inline">\(\alpha\)</span> and impact on standard metrics. The model is calibrated when <span class="math inline">\(\alpha=1\)</span>. The scores have been recalibrated using Beta calibration.</figcaption>
<p><img src="recalibration_files/figure-html/fig-standard-metrics-calib-boxplot-alpha-beta-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<div class="cell">
<details>
<summary>Display the R codes to produce the Figure.</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>current_recalib_metrics <span class="ot">&lt;-</span> recalib_metrics_alpha <span class="sc">|&gt;</span> <span class="fu">filter</span>(method <span class="sc">==</span> <span class="st">"locfit_0"</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot_simuls_metrics</span>(</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">tb_metrics =</span> current_recalib_metrics, </span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"alpha"</span>, <span class="at">metrics =</span> metrics</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-standard-metrics-calib-boxplot-alpha-locfit0" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.10: Calibration transformations made by varying <span class="math inline">\(\alpha\)</span> and impact on standard metrics. The model is calibrated when <span class="math inline">\(\alpha=1\)</span>. The scores have been recalibrated using local regression (with <code class="sourceCode r">deg<span class="ot">=</span><span class="dv">0</span></code>).</figcaption>
<p><img src="recalibration_files/figure-html/fig-standard-metrics-calib-boxplot-alpha-locfit0-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-5-tab">
<div class="cell">
<details>
<summary>Display the R codes to produce the Figure.</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>current_recalib_metrics <span class="ot">&lt;-</span> recalib_metrics_alpha <span class="sc">|&gt;</span> <span class="fu">filter</span>(method <span class="sc">==</span> <span class="st">"locfit_1"</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot_simuls_metrics</span>(</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">tb_metrics =</span> current_recalib_metrics, </span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"alpha"</span>, <span class="at">metrics =</span> metrics</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-standard-metrics-calib-boxplot-alpha-locfit1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.11: Calibration transformations made by varying <span class="math inline">\(\alpha\)</span> and impact on standard metrics. The model is calibrated when <span class="math inline">\(\alpha=1\)</span>. The scores have been recalibrated using local regression (with <code class="sourceCode r">deg<span class="ot">=</span><span class="dv">1</span></code>).</figcaption>
<p><img src="recalibration_files/figure-html/fig-standard-metrics-calib-boxplot-alpha-locfit1-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-6-tab">
<div class="cell">
<details>
<summary>Display the R codes to produce the Figure.</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>current_recalib_metrics <span class="ot">&lt;-</span> recalib_metrics_alpha <span class="sc">|&gt;</span> <span class="fu">filter</span>(method <span class="sc">==</span> <span class="st">"locfit_2"</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot_simuls_metrics</span>(</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">tb_metrics =</span> current_recalib_metrics, </span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"alpha"</span>, <span class="at">metrics =</span> metrics</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-standard-metrics-calib-boxplot-alpha-locfit2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.12: Calibration transformations made by varying <span class="math inline">\(\alpha\)</span> and impact on standard metrics. The model is calibrated when <span class="math inline">\(\alpha=1\)</span>. The scores have been recalibrated using local regression (with <code class="sourceCode r">deg<span class="ot">=</span><span class="dv">2</span></code>).</figcaption>
<p><img src="recalibration_files/figure-html/fig-standard-metrics-calib-boxplot-alpha-locfit2-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Platt</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Isotonic</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Beta</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false">Locfit (deg = 0)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-5" role="tab" aria-controls="tabset-4-5" aria-selected="false">Locfit (deg = 1)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-6" role="tab" aria-controls="tabset-4-6" aria-selected="false">Locfit (deg = 2)</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<details>
<summary>Display the R codes to produce the Figure.</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>current_recalib_metrics <span class="ot">&lt;-</span> recalib_metrics_gamma <span class="sc">|&gt;</span> <span class="fu">filter</span>(method <span class="sc">==</span> <span class="st">"platt"</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot_simuls_metrics</span>(</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">tb_metrics =</span> current_recalib_metrics, </span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"gamma"</span>, <span class="at">metrics =</span> metrics</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-standard-metrics-calib-boxplot-gamma-platt" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.13: Calibration transformations made by varying <span class="math inline">\(\gamma\)</span> and impact on standard metrics. The model is calibrated when <span class="math inline">\(\beta=1\)</span>. The scores have been recalibrated using Platt-scaling.</figcaption>
<p><img src="recalibration_files/figure-html/fig-standard-metrics-calib-boxplot-gamma-platt-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<details>
<summary>Display the R codes to produce the Figure.</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>current_recalib_metrics <span class="ot">&lt;-</span> recalib_metrics_gamma <span class="sc">|&gt;</span> <span class="fu">filter</span>(method <span class="sc">==</span> <span class="st">"isotonic"</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot_simuls_metrics</span>(</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">tb_metrics =</span> current_recalib_metrics, </span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"gamma"</span>, <span class="at">metrics =</span> metrics</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-standard-metrics-calib-boxplot-gamma-isotonic" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.14: Calibration transformations made by varying <span class="math inline">\(\gamma\)</span> and impact on standard metrics. The model is calibrated when <span class="math inline">\(\beta=1\)</span>. The scores have been recalibrated using Isotonic regression.</figcaption>
<p><img src="recalibration_files/figure-html/fig-standard-metrics-calib-boxplot-gamma-isotonic-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<details>
<summary>Display the R codes to produce the Figure.</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>current_recalib_metrics <span class="ot">&lt;-</span> recalib_metrics_gamma <span class="sc">|&gt;</span> <span class="fu">filter</span>(method <span class="sc">==</span> <span class="st">"beta"</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot_simuls_metrics</span>(</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">tb_metrics =</span> current_recalib_metrics, </span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"gamma"</span>, <span class="at">metrics =</span> metrics</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-standard-metrics-calib-boxplot-gamma-beta" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.15: Calibration transformations made by varying <span class="math inline">\(\gamma\)</span> and impact on standard metrics. The model is calibrated when <span class="math inline">\(\beta=1\)</span>. The scores have been recalibrated using Beta calibration.</figcaption>
<p><img src="recalibration_files/figure-html/fig-standard-metrics-calib-boxplot-gamma-beta-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<div class="cell">
<details>
<summary>Display the R codes to produce the Figure.</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>current_recalib_metrics <span class="ot">&lt;-</span> recalib_metrics_gamma <span class="sc">|&gt;</span> <span class="fu">filter</span>(method <span class="sc">==</span> <span class="st">"locfit_0"</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot_simuls_metrics</span>(</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">tb_metrics =</span> current_recalib_metrics, </span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"gamma"</span>, <span class="at">metrics =</span> metrics</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-standard-metrics-calib-boxplot-gamma-locfit0" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.16: Calibration transformations made by varying <span class="math inline">\(\gamma\)</span> and impact on standard metrics. The model is calibrated when <span class="math inline">\(\beta=1\)</span>. he scores have been recalibrated using local regression (with <code class="sourceCode r">deg<span class="ot">=</span><span class="dv">0</span></code>).</figcaption>
<p><img src="recalibration_files/figure-html/fig-standard-metrics-calib-boxplot-gamma-locfit0-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-5-tab">
<div class="cell">
<details>
<summary>Display the R codes to produce the Figure.</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>current_recalib_metrics <span class="ot">&lt;-</span> recalib_metrics_gamma <span class="sc">|&gt;</span> <span class="fu">filter</span>(method <span class="sc">==</span> <span class="st">"locfit_1"</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot_simuls_metrics</span>(</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">tb_metrics =</span> current_recalib_metrics, </span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"gamma"</span>, <span class="at">metrics =</span> metrics</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-standard-metrics-calib-boxplot-gamma-locfit1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.17: Calibration transformations made by varying <span class="math inline">\(\gamma\)</span> and impact on standard metrics. The model is calibrated when <span class="math inline">\(\beta=1\)</span>. he scores have been recalibrated using local regression (with <code class="sourceCode r">deg<span class="ot">=</span><span class="dv">1</span></code>).</figcaption>
<p><img src="recalibration_files/figure-html/fig-standard-metrics-calib-boxplot-gamma-locfit1-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-6-tab">
<div class="cell">
<details>
<summary>Display the R codes to produce the Figure.</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>current_recalib_metrics <span class="ot">&lt;-</span> recalib_metrics_gamma <span class="sc">|&gt;</span> <span class="fu">filter</span>(method <span class="sc">==</span> <span class="st">"locfit_2"</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot_simuls_metrics</span>(</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">tb_metrics =</span> current_recalib_metrics, </span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"gamma"</span>, <span class="at">metrics =</span> metrics</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-standard-metrics-calib-boxplot-gamma-locfit2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.18: Calibration transformations made by varying <span class="math inline">\(\gamma\)</span> and impact on standard metrics. The model is calibrated when <span class="math inline">\(\beta=1\)</span>. he scores have been recalibrated using local regression (with <code class="sourceCode r">deg<span class="ot">=</span><span class="dv">0</span></code>).</figcaption>
<p><img src="recalibration_files/figure-html/fig-standard-metrics-calib-boxplot-gamma-locfit2-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p>We can focus on the transformations that have degraded performance. For that purpose, we load the standard metrics computed on the uncalibrated probabilities:</p>
</section>
<section id="calibration-maps-single-replication" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="calibration-maps-single-replication"><span class="header-section-number">2.6</span> Calibration Maps (single replication)</h2>
<p>We can visualize the calibration curve as in <a href="calibration.html#sec-calib-visualization"><span>Section&nbsp;1.6</span></a> (<a href="calibration.html">Chapter&nbsp;<span>1</span></a>).</p>
<section id="quantile-based-bins" class="level3" data-number="2.6.1">
<h3 data-number="2.6.1" class="anchored" data-anchor-id="quantile-based-bins"><span class="header-section-number">2.6.1</span> Quantile-Based Bins</h3>
<p>We first visualize calibration in a fashion similar to what is done with the <a href="https://scikit-learn.org/stable/modules/generated/sklearn.calibration.calibration_curve.html"><code class="sourceCode python">calibration_curve()</code> method from sci-kit learn</a>.</p>
<p>The x-axis of the calibration plot reports the mean predicted probabilities computed on different bins, where the bins are defined using the deciles of the predicted scores. On the y-axis, the corresponding fraction of positive events (<span class="math inline">\(d=1\)</span>) are reported.</p>
<p>We can visualize the calibration curve as in <a href="calibration.html#sec-calib-visualization"><span>Section&nbsp;1.6</span></a> (<a href="calibration.html">Chapter&nbsp;<span>1</span></a>).</p>
<p>We can accompany the predictions made for each bin with a confidence interval, using the <code class="sourceCode r"><span class="fu">binom.confint</span>()</code> function from {binom}.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(binom)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Confidence interval for binomial data, using quantile-defined bins</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param obs vector of observed events</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param scores vector of predicted probabilities</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param k number of bins to create (quantiles, default to `10`)</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param prob confidence interval level</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param method Which method to use to construct the interval. Any combination </span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a><span class="co">#'  of c("exact", "ac", "asymptotic", "wilson", "prop.test", "bayes", "logit", </span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a><span class="co">#'  "cloglog", "probit") is allowed. Default is "all".</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a><span class="co">#' @return a tibble with the following columns, where each row corresponds to</span></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a><span class="co">#'   a bin:</span></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a><span class="co">#' - `mean`: estimation of $E(d | s(x) = p)$ where $p$ is the average score in bin b</span></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a><span class="co">#' - `lower`: lower bound of the confidence interval</span></span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a><span class="co">#' - `upper`: upper bound of the confidence interval</span></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a><span class="co">#' - `prediction`: average of `s(x)` in bin b</span></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a><span class="co">#' - `score_class`: decile level of bin b</span></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a><span class="co">#' - `nb`: number of observation in bin b</span></span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>ci_scores_bins <span class="ot">&lt;-</span> <span class="cf">function</span>(obs,</span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>                           scores,</span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>                           k,</span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a>                           <span class="at">prob =</span> .<span class="dv">95</span>, </span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a>                           <span class="at">method =</span> <span class="st">"probit"</span> ) {</span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a>  summary_bins_calib <span class="ot">&lt;-</span> <span class="fu">get_summary_bins</span>(<span class="at">obs =</span> obs, <span class="at">scores =</span> scores, <span class="at">k =</span> k)</span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a>  new_k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(summary_bins_calib)</span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true" tabindex="-1"></a>  prob_ic <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb78-28"><a href="#cb78-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, new_k),</span>
<span id="cb78-29"><a href="#cb78-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, new_k),</span>
<span id="cb78-30"><a href="#cb78-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, new_k),</span>
<span id="cb78-31"><a href="#cb78-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">prediction =</span> summary_bins_calib <span class="sc">|&gt;</span> <span class="fu">pull</span>(<span class="st">"mean_score"</span>),</span>
<span id="cb78-32"><a href="#cb78-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">score_class =</span> summary_bins_calib<span class="sc">$</span>score_class,</span>
<span id="cb78-33"><a href="#cb78-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">nb =</span> summary_bins_calib<span class="sc">$</span>nb</span>
<span id="cb78-34"><a href="#cb78-34" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb78-35"><a href="#cb78-35" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>new_k) {</span>
<span id="cb78-36"><a href="#cb78-36" aria-hidden="true" tabindex="-1"></a>    prob_ic[i, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">binom.confint</span>(</span>
<span id="cb78-37"><a href="#cb78-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> summary_bins_calib<span class="sc">$</span>sum_obs[i],</span>
<span id="cb78-38"><a href="#cb78-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">n =</span> summary_bins_calib<span class="sc">$</span>nb[i], </span>
<span id="cb78-39"><a href="#cb78-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">conf.level =</span> prob,</span>
<span id="cb78-40"><a href="#cb78-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">methods =</span> method</span>
<span id="cb78-41"><a href="#cb78-41" aria-hidden="true" tabindex="-1"></a>    )[, <span class="fu">c</span>(<span class="st">"mean"</span>, <span class="st">"lower"</span>, <span class="st">"upper"</span>)]</span>
<span id="cb78-42"><a href="#cb78-42" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb78-43"><a href="#cb78-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-44"><a href="#cb78-44" aria-hidden="true" tabindex="-1"></a>  prob_ic</span>
<span id="cb78-45"><a href="#cb78-45" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us define here a function to compute the confidence intervals for a single replication of our simulations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Compute confidence intervals for the calibration values of a single </span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' replication, for a given method</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param simul single simulation obtained with `f_simul()`</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param method recalibration method</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>conf_int_qbins_simul <span class="ot">&lt;-</span> <span class="cf">function</span>(simul, method) {</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>  obs_calib <span class="ot">&lt;-</span> simul<span class="sc">$</span>data_all_calib<span class="sc">$</span>d</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>  obs_test <span class="ot">&lt;-</span> simul<span class="sc">$</span>data_all_test<span class="sc">$</span>d</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (method <span class="sc">==</span> <span class="st">"True Prob."</span>) {</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>    scores_calib <span class="ot">&lt;-</span> simul<span class="sc">$</span>data_all_calib<span class="sc">$</span>p</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>    scores_test <span class="ot">&lt;-</span> simul<span class="sc">$</span>data_all_test<span class="sc">$</span>p</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (method <span class="sc">==</span> <span class="st">"No Calibration"</span>) {</span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>    scores_calib <span class="ot">&lt;-</span> simul<span class="sc">$</span>data_all_calib<span class="sc">$</span>p_u</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>    scores_test <span class="ot">&lt;-</span> simul<span class="sc">$</span>data_all_test<span class="sc">$</span>p_u</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>    tb_score_c_calib <span class="ot">&lt;-</span> simul<span class="sc">$</span>res_recalibration[[method]]<span class="sc">$</span>tb_score_c_calib</span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>    tb_score_c_test <span class="ot">&lt;-</span> simul<span class="sc">$</span>res_recalibration[[method]]<span class="sc">$</span>tb_score_c_test</span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>    scores_calib <span class="ot">&lt;-</span> tb_score_c_calib<span class="sc">$</span>p_c</span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>    scores_test <span class="ot">&lt;-</span> tb_score_c_test<span class="sc">$</span>p_c</span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a>  e_scores_bins_calib <span class="ot">&lt;-</span> <span class="fu">ci_scores_bins</span>(</span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">obs =</span> obs_calib, </span>
<span id="cb79-26"><a href="#cb79-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">scores =</span> scores_calib,</span>
<span id="cb79-27"><a href="#cb79-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">k =</span> <span class="dv">10</span>, <span class="at">prob =</span> .<span class="dv">95</span>, <span class="at">method =</span> <span class="st">"probit"</span></span>
<span id="cb79-28"><a href="#cb79-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb79-29"><a href="#cb79-29" aria-hidden="true" tabindex="-1"></a>  e_scores_bins_test <span class="ot">&lt;-</span> <span class="fu">ci_scores_bins</span>(</span>
<span id="cb79-30"><a href="#cb79-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">obs =</span> obs_test, </span>
<span id="cb79-31"><a href="#cb79-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">scores =</span> scores_test,</span>
<span id="cb79-32"><a href="#cb79-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">k =</span> <span class="dv">10</span>, <span class="at">prob =</span> .<span class="dv">95</span>, <span class="at">method =</span> <span class="st">"probit"</span></span>
<span id="cb79-33"><a href="#cb79-33" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb79-34"><a href="#cb79-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb79-35"><a href="#cb79-35" aria-hidden="true" tabindex="-1"></a>  e_scores_bins <span class="ot">&lt;-</span> e_scores_bins_calib <span class="sc">|&gt;</span> </span>
<span id="cb79-36"><a href="#cb79-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample =</span> <span class="st">"Calibration"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb79-37"><a href="#cb79-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(</span>
<span id="cb79-38"><a href="#cb79-38" aria-hidden="true" tabindex="-1"></a>      e_scores_bins_test <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">sample =</span> <span class="st">"Test"</span>)</span>
<span id="cb79-39"><a href="#cb79-39" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb79-40"><a href="#cb79-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb79-41"><a href="#cb79-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> simul<span class="sc">$</span>seed, </span>
<span id="cb79-42"><a href="#cb79-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> method</span>
<span id="cb79-43"><a href="#cb79-43" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb79-44"><a href="#cb79-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb79-45"><a href="#cb79-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb79-46"><a href="#cb79-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">e_scores_bins =</span> e_scores_bins,</span>
<span id="cb79-47"><a href="#cb79-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">obs_calib =</span> obs_calib,</span>
<span id="cb79-48"><a href="#cb79-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">obs_test =</span> obs_test,</span>
<span id="cb79-49"><a href="#cb79-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">scores_calib =</span> scores_calib,</span>
<span id="cb79-50"><a href="#cb79-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">scores_test =</span> scores_test,</span>
<span id="cb79-51"><a href="#cb79-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> simul<span class="sc">$</span>seed,</span>
<span id="cb79-52"><a href="#cb79-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> method</span>
<span id="cb79-53"><a href="#cb79-53" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb79-54"><a href="#cb79-54" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We define a function, <code class="sourceCode r"><span class="fu">get_data_plot_quant_simul</span>()</code> to extract a desired simulation from our results (either from <code>simul_recalib_alpha</code> or from <code>simul_recalib_gamma</code>). The function <code class="sourceCode r"><span class="fu">get_data_plot_quant_simul</span>()</code> returns a list with two elements:</p>
<ol type="1">
<li><code>ci_res</code>: the confidence interval for the calibration curve for the simulation</li>
<li><code>n_bins_scores</code>: the counts of observation in each bin defined over [0,1] for the scores (uncalibrated or calibrated, for both the calibration set and the test set).</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param i index of the simulation to use (in `simul_recalib_alpha` or </span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="co">#'   `simul_recalib_gamma`)</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param type type of transformed probabilities (made on `alpha` or `gamma`)</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param method name of the recalibration method to focus on</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>get_data_plot_quant_simul <span class="ot">&lt;-</span> <span class="cf">function</span>(i, type, method) {</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">"alpha"</span>) {</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>    simul <span class="ot">&lt;-</span> simul_recalib_alpha[[i]]</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>    transform_scale <span class="ot">&lt;-</span> grid_alpha<span class="sc">$</span>alpha[i]</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">"gamma"</span>) {</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>    simul <span class="ot">&lt;-</span> simul_recalib_gamma[[i]]</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>    transform_scale <span class="ot">&lt;-</span> grid_gamma<span class="sc">$</span>gamma[i]</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Wrong value for argument `type`."</span>)</span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Counting number of obs in bins defined over [0,1]</span></span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>  breaks <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">05</span>)</span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (method <span class="sc">==</span> <span class="st">"True Prob."</span>) {</span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>    scores_calib <span class="ot">&lt;-</span> simul<span class="sc">$</span>data_all_calib<span class="sc">$</span>p</span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>    scores_test <span class="ot">&lt;-</span> simul<span class="sc">$</span>data_all_test<span class="sc">$</span>p</span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a>    scores_c_calib <span class="ot">&lt;-</span> scores_c_test <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (method <span class="sc">==</span> <span class="st">"No Calibration"</span>) {</span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a>    scores_calib <span class="ot">&lt;-</span> simul<span class="sc">$</span>data_all_calib<span class="sc">$</span>p_u</span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a>    scores_test <span class="ot">&lt;-</span> simul<span class="sc">$</span>data_all_test<span class="sc">$</span>p_u</span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true" tabindex="-1"></a>    scores_c_calib <span class="ot">&lt;-</span> scores_c_test <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb80-26"><a href="#cb80-26" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb80-27"><a href="#cb80-27" aria-hidden="true" tabindex="-1"></a>    tb_score_c_calib <span class="ot">&lt;-</span> simul<span class="sc">$</span>res_recalibration[[method]]<span class="sc">$</span>tb_score_c_calib</span>
<span id="cb80-28"><a href="#cb80-28" aria-hidden="true" tabindex="-1"></a>    tb_score_c_test <span class="ot">&lt;-</span> simul<span class="sc">$</span>res_recalibration[[method]]<span class="sc">$</span>tb_score_c_test</span>
<span id="cb80-29"><a href="#cb80-29" aria-hidden="true" tabindex="-1"></a>    scores_calib <span class="ot">&lt;-</span> tb_score_c_calib<span class="sc">$</span>p_u</span>
<span id="cb80-30"><a href="#cb80-30" aria-hidden="true" tabindex="-1"></a>    scores_test <span class="ot">&lt;-</span> tb_score_c_test<span class="sc">$</span>p_u</span>
<span id="cb80-31"><a href="#cb80-31" aria-hidden="true" tabindex="-1"></a>    scores_c_calib <span class="ot">&lt;-</span> tb_score_c_calib<span class="sc">$</span>p_c</span>
<span id="cb80-32"><a href="#cb80-32" aria-hidden="true" tabindex="-1"></a>    scores_c_test <span class="ot">&lt;-</span> tb_score_c_test<span class="sc">$</span>p_c</span>
<span id="cb80-33"><a href="#cb80-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb80-34"><a href="#cb80-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-35"><a href="#cb80-35" aria-hidden="true" tabindex="-1"></a>  n_bins_calib <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">cut</span>(scores_calib, <span class="at">breaks =</span> breaks))</span>
<span id="cb80-36"><a href="#cb80-36" aria-hidden="true" tabindex="-1"></a>  n_bins_test <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">cut</span>(scores_test, <span class="at">breaks =</span> breaks))</span>
<span id="cb80-37"><a href="#cb80-37" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(scores_c_calib)) {</span>
<span id="cb80-38"><a href="#cb80-38" aria-hidden="true" tabindex="-1"></a>    n_bins_c_calib <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">cut</span>(scores_c_calib, <span class="at">breaks =</span> breaks))</span>
<span id="cb80-39"><a href="#cb80-39" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb80-40"><a href="#cb80-40" aria-hidden="true" tabindex="-1"></a>    n_bins_c_calib <span class="ot">&lt;-</span> <span class="cn">NA_integer_</span></span>
<span id="cb80-41"><a href="#cb80-41" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb80-42"><a href="#cb80-42" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(scores_c_test)) {</span>
<span id="cb80-43"><a href="#cb80-43" aria-hidden="true" tabindex="-1"></a>    n_bins_c_test <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">cut</span>(scores_c_test, <span class="at">breaks =</span> breaks))</span>
<span id="cb80-44"><a href="#cb80-44" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb80-45"><a href="#cb80-45" aria-hidden="true" tabindex="-1"></a>    n_bins_c_test <span class="ot">&lt;-</span> <span class="cn">NA_integer_</span></span>
<span id="cb80-46"><a href="#cb80-46" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb80-47"><a href="#cb80-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-48"><a href="#cb80-48" aria-hidden="true" tabindex="-1"></a>  n_bins_scores <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb80-49"><a href="#cb80-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">bins =</span> <span class="fu">names</span>(<span class="fu">table</span>(<span class="fu">cut</span>(breaks, <span class="at">breaks =</span> breaks))),</span>
<span id="cb80-50"><a href="#cb80-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_bins_calib =</span> <span class="fu">as.vector</span>(n_bins_calib),</span>
<span id="cb80-51"><a href="#cb80-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_bins_test =</span> <span class="fu">as.vector</span>(n_bins_test),</span>
<span id="cb80-52"><a href="#cb80-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_bins_c_calib =</span> <span class="fu">as.vector</span>(n_bins_c_calib),</span>
<span id="cb80-53"><a href="#cb80-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_bins_c_test =</span> <span class="fu">as.vector</span>(n_bins_c_test),</span>
<span id="cb80-54"><a href="#cb80-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> method,</span>
<span id="cb80-55"><a href="#cb80-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> simul<span class="sc">$</span>seed,</span>
<span id="cb80-56"><a href="#cb80-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> type</span>
<span id="cb80-57"><a href="#cb80-57" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb80-58"><a href="#cb80-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-59"><a href="#cb80-59" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Confidence intervals</span></span>
<span id="cb80-60"><a href="#cb80-60" aria-hidden="true" tabindex="-1"></a>  ci_res <span class="ot">&lt;-</span> <span class="fu">conf_int_qbins_simul</span>(<span class="at">simul =</span> simul, <span class="at">method =</span> method)</span>
<span id="cb80-61"><a href="#cb80-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">ci_res =</span> ci_res, <span class="at">n_bins_scores =</span> n_bins_scores)</span>
<span id="cb80-62"><a href="#cb80-62" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we can define a function that will plot the calibration maps computed on the calibration set and those computed on the test set. This function will plot a panel of calibration maps, each row corresponding to a specific value of the scale used to transform the probabilities (<span class="math inline">\(\alpha\)</span> or <span class="math inline">\(\gamma\)</span>). On top of each graph, we plot the histogram of <span style="\&quot;color:#0000004D\&quot;">uncalibrated scores</span> and of <span style="\&quot;color:#0072B24D\&quot;">calibrated scores</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>plot_conf_int_qbins_simul <span class="ot">&lt;-</span> <span class="cf">function</span>(method, type) {</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  current_grid <span class="ot">&lt;-</span> grid <span class="sc">|&gt;</span> </span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(method <span class="sc">==</span> <span class="sc">!!</span>method, type <span class="sc">==</span> <span class="sc">!!</span>type)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">"alpha"</span>) {</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>    transform_scale <span class="ot">&lt;-</span> grid_alpha <span class="sc">|&gt;</span> <span class="fu">slice</span>(current_grid<span class="sc">$</span>i) <span class="sc">|&gt;</span> <span class="fu">pull</span>(alpha)</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">"gamma"</span>) {</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>    transform_scale <span class="ot">&lt;-</span> grid_gamma <span class="sc">|&gt;</span> <span class="fu">slice</span>(current_grid<span class="sc">$</span>i) <span class="sc">|&gt;</span> <span class="fu">pull</span>(gamma)</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Error argument `type`. Wrong value: either </span><span class="sc">\"</span><span class="st">alpha</span><span class="sc">\"</span><span class="st"> or </span><span class="sc">\"</span><span class="st">gamma</span><span class="sc">\"</span><span class="st">"</span>)</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>  data_plots <span class="ot">&lt;-</span>  <span class="fu">map</span>(</span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">.x =</span> current_grid<span class="sc">$</span>i,</span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">.f =</span> <span class="sc">~</span><span class="fu">get_data_plot_quant_simul</span>(<span class="at">i =</span> .x, <span class="at">type =</span> type, <span class="at">method =</span> method)</span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>  data_plots_ci <span class="ot">&lt;-</span> <span class="fu">map</span>(data_plots, <span class="fu">pluck</span>(<span class="st">"ci_res"</span>))</span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a>  data_plots_n_bins_scores <span class="ot">&lt;-</span> <span class="fu">map</span>(data_plots, <span class="fu">pluck</span>(<span class="st">"n_bins_scores"</span>))</span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a>  nb <span class="ot">&lt;-</span> <span class="fu">length</span>(data_plots)</span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a>  mat <span class="ot">&lt;-</span> mat_init <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(nb<span class="dv">-1</span>)) {</span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a>    mat <span class="ot">&lt;-</span> <span class="fu">rbind</span>(mat, mat_init <span class="sc">+</span> j <span class="sc">*</span> <span class="dv">4</span>)</span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb81-26"><a href="#cb81-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(mat, <span class="at">heights =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), nb))</span>
<span id="cb81-27"><a href="#cb81-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb81-28"><a href="#cb81-28" aria-hidden="true" tabindex="-1"></a>  y_lim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb81-29"><a href="#cb81-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb81-30"><a href="#cb81-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb81-31"><a href="#cb81-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># i_recalib &lt;- 1</span></span>
<span id="cb81-32"><a href="#cb81-32" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i_recalib <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nb) {</span>
<span id="cb81-33"><a href="#cb81-33" aria-hidden="true" tabindex="-1"></a>    data_plot_ci <span class="ot">&lt;-</span> data_plots_ci[[i_recalib]]</span>
<span id="cb81-34"><a href="#cb81-34" aria-hidden="true" tabindex="-1"></a>    data_plot_n_bins_scores <span class="ot">&lt;-</span> data_plots_n_bins_scores[[i_recalib]]</span>
<span id="cb81-35"><a href="#cb81-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb81-36"><a href="#cb81-36" aria-hidden="true" tabindex="-1"></a>    obs_calib <span class="ot">&lt;-</span> data_plot_ci<span class="sc">$</span>obs_calib</span>
<span id="cb81-37"><a href="#cb81-37" aria-hidden="true" tabindex="-1"></a>    scores_calib <span class="ot">&lt;-</span> data_plot_ci<span class="sc">$</span>scores_calib</span>
<span id="cb81-38"><a href="#cb81-38" aria-hidden="true" tabindex="-1"></a>    obs_test <span class="ot">&lt;-</span> data_plot_ci<span class="sc">$</span>obs_test</span>
<span id="cb81-39"><a href="#cb81-39" aria-hidden="true" tabindex="-1"></a>    scores_test <span class="ot">&lt;-</span> data_plot_ci<span class="sc">$</span>scores_test</span>
<span id="cb81-40"><a href="#cb81-40" aria-hidden="true" tabindex="-1"></a>    ci <span class="ot">&lt;-</span> data_plot_ci<span class="sc">$</span>e_scores_bins</span>
<span id="cb81-41"><a href="#cb81-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb81-42"><a href="#cb81-42" aria-hidden="true" tabindex="-1"></a>    title <span class="ot">&lt;-</span> <span class="fu">str_c</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">"</span>, type, <span class="st">"="</span>, <span class="fu">round</span>(transform_scale[i_recalib], <span class="dv">2</span>), <span class="st">"$"</span>)</span>
<span id="cb81-43"><a href="#cb81-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb81-44"><a href="#cb81-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (sample <span class="cf">in</span> <span class="fu">c</span>(<span class="st">"Calibration"</span>, <span class="st">"Test"</span>)) {</span>
<span id="cb81-45"><a href="#cb81-45" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Histogram with values</span></span>
<span id="cb81-46"><a href="#cb81-46" aria-hidden="true" tabindex="-1"></a>      df_plot <span class="ot">&lt;-</span> ci <span class="sc">|&gt;</span> <span class="fu">filter</span>(sample <span class="sc">==</span> <span class="sc">!!</span>sample)</span>
<span id="cb81-47"><a href="#cb81-47" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb81-48"><a href="#cb81-48" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (sample <span class="sc">==</span> <span class="st">"Calibration"</span>){</span>
<span id="cb81-49"><a href="#cb81-49" aria-hidden="true" tabindex="-1"></a>        obs_current <span class="ot">&lt;-</span> obs_calib</span>
<span id="cb81-50"><a href="#cb81-50" aria-hidden="true" tabindex="-1"></a>        scores_current <span class="ot">&lt;-</span> scores_calib</span>
<span id="cb81-51"><a href="#cb81-51" aria-hidden="true" tabindex="-1"></a>        colour <span class="ot">&lt;-</span> <span class="st">"#D55E00"</span></span>
<span id="cb81-52"><a href="#cb81-52" aria-hidden="true" tabindex="-1"></a>        n_bins_current <span class="ot">&lt;-</span> data_plot_n_bins_scores<span class="sc">$</span>n_bins_calib</span>
<span id="cb81-53"><a href="#cb81-53" aria-hidden="true" tabindex="-1"></a>        n_bins_c_current <span class="ot">&lt;-</span> data_plot_n_bins_scores<span class="sc">$</span>n_bins_c_calib</span>
<span id="cb81-54"><a href="#cb81-54" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb81-55"><a href="#cb81-55" aria-hidden="true" tabindex="-1"></a>        obs_current <span class="ot">&lt;-</span> obs_test</span>
<span id="cb81-56"><a href="#cb81-56" aria-hidden="true" tabindex="-1"></a>        scores_current <span class="ot">&lt;-</span> scores_test</span>
<span id="cb81-57"><a href="#cb81-57" aria-hidden="true" tabindex="-1"></a>        colour <span class="ot">&lt;-</span> <span class="st">"#009E73"</span></span>
<span id="cb81-58"><a href="#cb81-58" aria-hidden="true" tabindex="-1"></a>        n_bins_current <span class="ot">&lt;-</span> data_plot_n_bins_scores<span class="sc">$</span>n_bins_test</span>
<span id="cb81-59"><a href="#cb81-59" aria-hidden="true" tabindex="-1"></a>        n_bins_c_current <span class="ot">&lt;-</span> data_plot_n_bins_scores<span class="sc">$</span>n_bins_c_test</span>
<span id="cb81-60"><a href="#cb81-60" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb81-61"><a href="#cb81-61" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb81-62"><a href="#cb81-62" aria-hidden="true" tabindex="-1"></a>      <span class="co"># heights &lt;- rbind(n_bins_current, n_bins_c_current)</span></span>
<span id="cb81-63"><a href="#cb81-63" aria-hidden="true" tabindex="-1"></a>      <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">4.3</span>, <span class="fl">1.0</span>, <span class="fl">0.5</span>))</span>
<span id="cb81-64"><a href="#cb81-64" aria-hidden="true" tabindex="-1"></a>      y_lim_bp <span class="ot">&lt;-</span> <span class="fu">range</span>(<span class="fu">c</span>(n_bins_current, n_bins_c_current), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb81-65"><a href="#cb81-65" aria-hidden="true" tabindex="-1"></a>      <span class="fu">barplot</span>(</span>
<span id="cb81-66"><a href="#cb81-66" aria-hidden="true" tabindex="-1"></a>        n_bins_current,</span>
<span id="cb81-67"><a href="#cb81-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">"#000000"</span>, <span class="at">alpha.f =</span> .<span class="dv">3</span>),</span>
<span id="cb81-68"><a href="#cb81-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylim =</span> y_lim_bp,</span>
<span id="cb81-69"><a href="#cb81-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="st">"white"</span>,</span>
<span id="cb81-70"><a href="#cb81-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">axes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb81-71"><a href="#cb81-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>, </span>
<span id="cb81-72"><a href="#cb81-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(title)</span>
<span id="cb81-73"><a href="#cb81-73" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb81-74"><a href="#cb81-74" aria-hidden="true" tabindex="-1"></a>      <span class="fu">barplot</span>(</span>
<span id="cb81-75"><a href="#cb81-75" aria-hidden="true" tabindex="-1"></a>        n_bins_c_current,</span>
<span id="cb81-76"><a href="#cb81-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">"#0072B2"</span>, <span class="at">alpha.f =</span> .<span class="dv">3</span>),</span>
<span id="cb81-77"><a href="#cb81-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylim =</span> y_lim_bp,</span>
<span id="cb81-78"><a href="#cb81-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="st">"white"</span>,</span>
<span id="cb81-79"><a href="#cb81-79" aria-hidden="true" tabindex="-1"></a>        <span class="at">axes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb81-80"><a href="#cb81-80" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">main =</span> <span class="st">""</span>,</span>
<span id="cb81-81"><a href="#cb81-81" aria-hidden="true" tabindex="-1"></a>        <span class="at">add =</span> <span class="cn">TRUE</span></span>
<span id="cb81-82"><a href="#cb81-82" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb81-83"><a href="#cb81-83" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb81-84"><a href="#cb81-84" aria-hidden="true" tabindex="-1"></a>      <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">4.1</span>, <span class="fl">4.3</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb81-85"><a href="#cb81-85" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot</span>(</span>
<span id="cb81-86"><a href="#cb81-86" aria-hidden="true" tabindex="-1"></a>        df_plot<span class="sc">$</span>prediction, df_plot<span class="sc">$</span>mean,</span>
<span id="cb81-87"><a href="#cb81-87" aria-hidden="true" tabindex="-1"></a>        <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">ylim =</span> y_lim, <span class="at">xlim =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,</span>
<span id="cb81-88"><a href="#cb81-88" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"Predicted score $p$"</span>), </span>
<span id="cb81-89"><a href="#cb81-89" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$E(d | s(x) = p)$"</span>),</span>
<span id="cb81-90"><a href="#cb81-90" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> colour</span>
<span id="cb81-91"><a href="#cb81-91" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb81-92"><a href="#cb81-92" aria-hidden="true" tabindex="-1"></a>      <span class="fu">arrows</span>(</span>
<span id="cb81-93"><a href="#cb81-93" aria-hidden="true" tabindex="-1"></a>        <span class="at">x0 =</span> df_plot<span class="sc">$</span>prediction, <span class="at">y0 =</span> df_plot<span class="sc">$</span>lower, </span>
<span id="cb81-94"><a href="#cb81-94" aria-hidden="true" tabindex="-1"></a>        <span class="at">x1 =</span> df_plot<span class="sc">$</span>prediction, <span class="at">y1 =</span> df_plot<span class="sc">$</span>upper,</span>
<span id="cb81-95"><a href="#cb81-95" aria-hidden="true" tabindex="-1"></a>        <span class="at">angle =</span> <span class="dv">90</span>,<span class="at">length =</span> .<span class="dv">05</span>, <span class="at">code =</span> <span class="dv">3</span>,</span>
<span id="cb81-96"><a href="#cb81-96" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> colour</span>
<span id="cb81-97"><a href="#cb81-97" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb81-98"><a href="#cb81-98" aria-hidden="true" tabindex="-1"></a>      <span class="fu">segments</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb81-99"><a href="#cb81-99" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb81-100"><a href="#cb81-100" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb81-101"><a href="#cb81-101" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb81-102"><a href="#cb81-102" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Display the code used to plot the calibration curves.</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"True Prob."</span>, <span class="st">"No Calibration"</span>, <span class="st">"platt"</span>, <span class="st">"isotonic"</span>, <span class="st">"beta"</span>, </span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"locfit_0"</span>, <span class="st">"locfit_1"</span>, <span class="st">"locfit_2"</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>i_alpha <span class="ot">&lt;-</span> grid_alpha <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">i =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span> <span class="fu">group_by</span>(alpha) <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(i)</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>i_gamma <span class="ot">&lt;-</span> grid_gamma <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">i =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span> <span class="fu">group_by</span>(gamma) <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(i)</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">i =</span> i_alpha, <span class="at">type =</span> <span class="st">"alpha"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(</span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(<span class="at">i =</span> i_gamma, <span class="at">type =</span> <span class="st">"gamma"</span>)</span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">str_c</span>(i, <span class="st">"_"</span>, type))</span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">id =</span> tab<span class="sc">$</span>id, <span class="at">method =</span> methods) <span class="sc">|&gt;</span> </span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(id, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"i"</span>, <span class="st">"type"</span>), <span class="at">sep =</span> <span class="st">"_"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">i =</span> <span class="fu">as.numeric</span>(i))</span>
<span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-21"><a href="#cb82-21" aria-hidden="true" tabindex="-1"></a>method_names <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb82-22"><a href="#cb82-22" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>method, <span class="sc">~</span>method_lab,</span>
<span id="cb82-23"><a href="#cb82-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">"True Prob."</span>, <span class="st">"True Prob."</span>,</span>
<span id="cb82-24"><a href="#cb82-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">"No Calibration"</span>, <span class="st">"No Calibration"</span>, </span>
<span id="cb82-25"><a href="#cb82-25" aria-hidden="true" tabindex="-1"></a>  <span class="st">"platt"</span>, <span class="st">"Platt Scaling"</span>,</span>
<span id="cb82-26"><a href="#cb82-26" aria-hidden="true" tabindex="-1"></a>  <span class="st">"isotonic"</span>, <span class="st">"Isotonic Reg."</span>,</span>
<span id="cb82-27"><a href="#cb82-27" aria-hidden="true" tabindex="-1"></a>  <span class="st">"beta"</span>, <span class="st">"Beta Calib."</span>,</span>
<span id="cb82-28"><a href="#cb82-28" aria-hidden="true" tabindex="-1"></a>  <span class="st">"locfit_0"</span>, <span class="st">"Local Reg. (deg = 0)"</span>, </span>
<span id="cb82-29"><a href="#cb82-29" aria-hidden="true" tabindex="-1"></a>  <span class="st">"locfit_1"</span>, <span class="st">"Local Reg. (deg = 1)"</span>,</span>
<span id="cb82-30"><a href="#cb82-30" aria-hidden="true" tabindex="-1"></a>  <span class="st">"locfit_2"</span>, <span class="st">"Local Reg (deg = 2)"</span></span>
<span id="cb82-31"><a href="#cb82-31" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In the Figures below, for the tabs <code>True Pob.</code> and <code>No Calibration</code>, the plots show the calibration curves obtained using the true probabilities and the uncalibrated scores instead of recalibrated scores. We do this for comparison purposes.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">For <span class="math inline">\(\alpha\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">For <span class="math inline">\(\gamma\)</span></a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">True Prob.</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">No Calibration</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">Platt Scaling</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-4" role="tab" aria-controls="tabset-6-4" aria-selected="false">Isotonic Reg.</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-5" role="tab" aria-controls="tabset-6-5" aria-selected="false">Beta Calib.</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-6" role="tab" aria-controls="tabset-6-6" aria-selected="false">Local Reg. (deg = 0)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-7" role="tab" aria-controls="tabset-6-7" aria-selected="false">Local Reg. (deg = 1)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-8" role="tab" aria-controls="tabset-6-8" aria-selected="false">Local Reg (deg = 2)</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained using quantile-defined bins on the recalibrated scores for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for a single replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-94-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained using quantile-defined bins on the recalibrated scores for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for a single replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-95-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained using quantile-defined bins on the recalibrated scores for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for a single replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-96-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-4-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained using quantile-defined bins on the recalibrated scores for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for a single replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-97-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-5-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained using quantile-defined bins on the recalibrated scores for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for a single replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-98-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-6-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained using quantile-defined bins on the recalibrated scores for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for a single replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-99-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-7-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained using quantile-defined bins on the recalibrated scores for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for a single replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-100-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-8-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained using quantile-defined bins on the recalibrated scores for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for a single replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-101-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">True Prob.</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">No Calibration</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">Platt Scaling</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-4" role="tab" aria-controls="tabset-7-4" aria-selected="false">Isotonic Reg.</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-5" role="tab" aria-controls="tabset-7-5" aria-selected="false">Beta Calib.</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-6" role="tab" aria-controls="tabset-7-6" aria-selected="false">Local Reg. (deg = 0)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-7" role="tab" aria-controls="tabset-7-7" aria-selected="false">Local Reg. (deg = 1)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-8" role="tab" aria-controls="tabset-7-8" aria-selected="false">Local Reg (deg = 2)</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained using quantile-defined bins on the recalibrated scores for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for a single replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-102-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained using quantile-defined bins on the recalibrated scores for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for a single replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-103-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained using quantile-defined bins on the recalibrated scores for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for a single replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-104-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-4-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained using quantile-defined bins on the recalibrated scores for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for a single replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-105-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-5-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained using quantile-defined bins on the recalibrated scores for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for a single replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-106-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-6-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained using quantile-defined bins on the recalibrated scores for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for a single replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-107-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-7-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained using quantile-defined bins on the recalibrated scores for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for a single replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-108-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-8-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained using quantile-defined bins on the recalibrated scores for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for a single replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-109-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="calibration-curve-with-moving-average" class="level3" data-number="2.6.2">
<h3 data-number="2.6.2" class="anchored" data-anchor-id="calibration-curve-with-moving-average"><span class="header-section-number">2.6.2</span> Calibration Curve with Moving Average</h3>
<p>The calibration curves will computed using the <code class="sourceCode r"><span class="fu">local_ci_scores</span>()</code> (defined in <a href="#sec-recalib-helper-functions"><span>Section&nbsp;2.3.1</span></a>) and accompanied by a confidence interval obtained using the <code class="sourceCode r"><span class="fu">binom.confint</span>()</code> function from {binom}.</p>
<p>Let us first focus on a single replication for which we can plot the calibration curve with its confidence interval.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>calibration_curve_ma_simul <span class="ot">&lt;-</span> <span class="cf">function</span>(simul, </span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>                                       method, </span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">nn =</span> .<span class="dv">15</span>,</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">prob =</span> .<span class="dv">95</span>, </span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">ci_method =</span> <span class="st">"probit"</span>) {</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>  obs_calib <span class="ot">&lt;-</span> simul<span class="sc">$</span>data_all_calib<span class="sc">$</span>d</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>  obs_test <span class="ot">&lt;-</span> simul<span class="sc">$</span>data_all_test<span class="sc">$</span>d</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (method <span class="sc">==</span> <span class="st">"True Prob."</span>) {</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>    scores_calib <span class="ot">&lt;-</span> simul<span class="sc">$</span>data_all_calib<span class="sc">$</span>p</span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>    scores_test <span class="ot">&lt;-</span> simul<span class="sc">$</span>data_all_test<span class="sc">$</span>p</span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (method <span class="sc">==</span> <span class="st">"No Calibration"</span>) {</span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>    scores_calib <span class="ot">&lt;-</span> simul<span class="sc">$</span>data_all_calib<span class="sc">$</span>p_u</span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a>    scores_test <span class="ot">&lt;-</span> simul<span class="sc">$</span>data_all_test<span class="sc">$</span>p_u</span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a>    tb_score_c_calib <span class="ot">&lt;-</span> simul<span class="sc">$</span>res_recalibration[[method]]<span class="sc">$</span>tb_score_c_calib</span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a>    tb_score_c_test <span class="ot">&lt;-</span> simul<span class="sc">$</span>res_recalibration[[method]]<span class="sc">$</span>tb_score_c_test</span>
<span id="cb83-21"><a href="#cb83-21" aria-hidden="true" tabindex="-1"></a>    scores_calib <span class="ot">&lt;-</span> tb_score_c_calib<span class="sc">$</span>p_c</span>
<span id="cb83-22"><a href="#cb83-22" aria-hidden="true" tabindex="-1"></a>    scores_test <span class="ot">&lt;-</span> tb_score_c_test<span class="sc">$</span>p_c</span>
<span id="cb83-23"><a href="#cb83-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb83-24"><a href="#cb83-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-25"><a href="#cb83-25" aria-hidden="true" tabindex="-1"></a>  linspace_raw <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb83-26"><a href="#cb83-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-27"><a href="#cb83-27" aria-hidden="true" tabindex="-1"></a>  keep_linspace_calib <span class="ot">&lt;-</span> <span class="fu">which</span>(</span>
<span id="cb83-28"><a href="#cb83-28" aria-hidden="true" tabindex="-1"></a>    linspace_raw <span class="sc">&gt;=</span> <span class="fu">min</span>(scores_calib) <span class="sc">&amp;</span> linspace_raw <span class="sc">&lt;=</span> <span class="fu">max</span>(scores_calib)</span>
<span id="cb83-29"><a href="#cb83-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb83-30"><a href="#cb83-30" aria-hidden="true" tabindex="-1"></a>  linspace_calib <span class="ot">&lt;-</span> linspace_raw[keep_linspace_calib]</span>
<span id="cb83-31"><a href="#cb83-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-32"><a href="#cb83-32" aria-hidden="true" tabindex="-1"></a>  calib_curve_calib <span class="ot">&lt;-</span> <span class="fu">map</span>(</span>
<span id="cb83-33"><a href="#cb83-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">.x =</span> linspace_calib,</span>
<span id="cb83-34"><a href="#cb83-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">.f =</span> <span class="sc">~</span><span class="fu">local_ci_scores</span>(</span>
<span id="cb83-35"><a href="#cb83-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">obs =</span> obs_calib,</span>
<span id="cb83-36"><a href="#cb83-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">scores =</span> scores_calib,</span>
<span id="cb83-37"><a href="#cb83-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">tau =</span> .x, </span>
<span id="cb83-38"><a href="#cb83-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">nn =</span> nn, <span class="at">prob =</span> prob, <span class="at">method =</span> ci_method)</span>
<span id="cb83-39"><a href="#cb83-39" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb83-40"><a href="#cb83-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list_rbind</span>() <span class="sc">|&gt;</span> </span>
<span id="cb83-41"><a href="#cb83-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample =</span> <span class="st">"Calibration"</span>)</span>
<span id="cb83-42"><a href="#cb83-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-43"><a href="#cb83-43" aria-hidden="true" tabindex="-1"></a>  keep_linspace_test <span class="ot">&lt;-</span> <span class="fu">which</span>(</span>
<span id="cb83-44"><a href="#cb83-44" aria-hidden="true" tabindex="-1"></a>    linspace_raw <span class="sc">&gt;=</span> <span class="fu">min</span>(scores_test) <span class="sc">&amp;</span> linspace_raw <span class="sc">&lt;=</span> <span class="fu">max</span>(scores_test)</span>
<span id="cb83-45"><a href="#cb83-45" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb83-46"><a href="#cb83-46" aria-hidden="true" tabindex="-1"></a>  linspace_test <span class="ot">&lt;-</span> linspace_raw[keep_linspace_test]</span>
<span id="cb83-47"><a href="#cb83-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-48"><a href="#cb83-48" aria-hidden="true" tabindex="-1"></a>  calib_curve_test <span class="ot">&lt;-</span> <span class="fu">map</span>(</span>
<span id="cb83-49"><a href="#cb83-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">.x =</span> linspace_test,</span>
<span id="cb83-50"><a href="#cb83-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">.f =</span> <span class="sc">~</span><span class="fu">local_ci_scores</span>(</span>
<span id="cb83-51"><a href="#cb83-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">obs =</span> obs_test,</span>
<span id="cb83-52"><a href="#cb83-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">scores =</span> scores_test,</span>
<span id="cb83-53"><a href="#cb83-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">tau =</span> .x, </span>
<span id="cb83-54"><a href="#cb83-54" aria-hidden="true" tabindex="-1"></a>      <span class="at">nn =</span> nn, <span class="at">prob =</span> prob, <span class="at">method =</span> ci_method)</span>
<span id="cb83-55"><a href="#cb83-55" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb83-56"><a href="#cb83-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list_rbind</span>() <span class="sc">|&gt;</span> </span>
<span id="cb83-57"><a href="#cb83-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample =</span> <span class="st">"Test"</span>)</span>
<span id="cb83-58"><a href="#cb83-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-59"><a href="#cb83-59" aria-hidden="true" tabindex="-1"></a>  tb_calibration_curve_ma <span class="ot">&lt;-</span> </span>
<span id="cb83-60"><a href="#cb83-60" aria-hidden="true" tabindex="-1"></a>    calib_curve_calib <span class="sc">|&gt;</span> </span>
<span id="cb83-61"><a href="#cb83-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(calib_curve_test) <span class="sc">|&gt;</span> </span>
<span id="cb83-62"><a href="#cb83-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb83-63"><a href="#cb83-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> method,</span>
<span id="cb83-64"><a href="#cb83-64" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> simul<span class="sc">$</span>seed</span>
<span id="cb83-65"><a href="#cb83-65" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb83-66"><a href="#cb83-66" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb83-67"><a href="#cb83-67" aria-hidden="true" tabindex="-1"></a>  tb_calibration_curve_ma</span>
<span id="cb83-68"><a href="#cb83-68" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For convenience, we create a function, <code class="sourceCode r"><span class="fu">get_data_plot_calib_ma_simul</span>()</code> that returns two elements::</p>
<ol type="1">
<li><code>tb_ci</code>: confidence intervals associated with the calibration curve for a single replication</li>
<li><code>n_bins_scores</code>: the count of observation in each bins defined over the [0,1] segment for the scores (uncalibrated and calibrated, for both the train set and the test set).</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param i index of the simulation to use (in `simul_recalib_alpha` or </span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="co">#'   `simul_recalib_gamma`)</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param type type of transformed probabilities (made on `alpha` or `gamma`)</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param method name of the recalibration method to focus on</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>get_data_plot_calib_ma_simul <span class="ot">&lt;-</span> <span class="cf">function</span>(i, type, method) {</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">"alpha"</span>) {</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>    simul <span class="ot">&lt;-</span> simul_recalib_alpha[[i]]</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>    transform_scale <span class="ot">&lt;-</span> grid_alpha<span class="sc">$</span>alpha[i]</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">"gamma"</span>) {</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>    simul <span class="ot">&lt;-</span> simul_recalib_gamma[[i]]</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>    transform_scale <span class="ot">&lt;-</span> grid_gamma<span class="sc">$</span>gamma[i]</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Wrong value for argument `type`."</span>)</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Counting number of obs in bins defined over [0,1]</span></span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>  breaks <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">05</span>)</span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (method <span class="sc">==</span> <span class="st">"True Prob."</span>) {</span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>    scores_calib <span class="ot">&lt;-</span> simul<span class="sc">$</span>data_all_calib<span class="sc">$</span>p</span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>    scores_test <span class="ot">&lt;-</span> simul<span class="sc">$</span>data_all_test<span class="sc">$</span>p</span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>    scores_c_calib <span class="ot">&lt;-</span> scores_c_test <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (method <span class="sc">==</span> <span class="st">"No Calibration"</span>) {</span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a>    scores_calib <span class="ot">&lt;-</span> simul<span class="sc">$</span>data_all_calib<span class="sc">$</span>p_u</span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>    scores_test <span class="ot">&lt;-</span> simul<span class="sc">$</span>data_all_test<span class="sc">$</span>p_u</span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a>    scores_c_calib <span class="ot">&lt;-</span> scores_c_test <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a>    tb_score_c_calib <span class="ot">&lt;-</span> simul<span class="sc">$</span>res_recalibration[[method]]<span class="sc">$</span>tb_score_c_calib</span>
<span id="cb84-28"><a href="#cb84-28" aria-hidden="true" tabindex="-1"></a>    tb_score_c_test <span class="ot">&lt;-</span> simul<span class="sc">$</span>res_recalibration[[method]]<span class="sc">$</span>tb_score_c_test</span>
<span id="cb84-29"><a href="#cb84-29" aria-hidden="true" tabindex="-1"></a>    scores_calib <span class="ot">&lt;-</span> tb_score_c_calib<span class="sc">$</span>p_u</span>
<span id="cb84-30"><a href="#cb84-30" aria-hidden="true" tabindex="-1"></a>    scores_test <span class="ot">&lt;-</span> tb_score_c_test<span class="sc">$</span>p_u</span>
<span id="cb84-31"><a href="#cb84-31" aria-hidden="true" tabindex="-1"></a>    scores_c_calib <span class="ot">&lt;-</span> tb_score_c_calib<span class="sc">$</span>p_c</span>
<span id="cb84-32"><a href="#cb84-32" aria-hidden="true" tabindex="-1"></a>    scores_c_test <span class="ot">&lt;-</span> tb_score_c_test<span class="sc">$</span>p_c</span>
<span id="cb84-33"><a href="#cb84-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb84-34"><a href="#cb84-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-35"><a href="#cb84-35" aria-hidden="true" tabindex="-1"></a>  n_bins_calib <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">cut</span>(scores_calib, <span class="at">breaks =</span> breaks))</span>
<span id="cb84-36"><a href="#cb84-36" aria-hidden="true" tabindex="-1"></a>  n_bins_test <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">cut</span>(scores_test, <span class="at">breaks =</span> breaks))</span>
<span id="cb84-37"><a href="#cb84-37" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(scores_c_calib)) {</span>
<span id="cb84-38"><a href="#cb84-38" aria-hidden="true" tabindex="-1"></a>    n_bins_c_calib <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">cut</span>(scores_c_calib, <span class="at">breaks =</span> breaks))</span>
<span id="cb84-39"><a href="#cb84-39" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb84-40"><a href="#cb84-40" aria-hidden="true" tabindex="-1"></a>    n_bins_c_calib <span class="ot">&lt;-</span> <span class="cn">NA_integer_</span></span>
<span id="cb84-41"><a href="#cb84-41" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb84-42"><a href="#cb84-42" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(scores_c_test)) {</span>
<span id="cb84-43"><a href="#cb84-43" aria-hidden="true" tabindex="-1"></a>    n_bins_c_test <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">cut</span>(scores_c_test, <span class="at">breaks =</span> breaks))</span>
<span id="cb84-44"><a href="#cb84-44" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb84-45"><a href="#cb84-45" aria-hidden="true" tabindex="-1"></a>    n_bins_c_test <span class="ot">&lt;-</span> <span class="cn">NA_integer_</span></span>
<span id="cb84-46"><a href="#cb84-46" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb84-47"><a href="#cb84-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-48"><a href="#cb84-48" aria-hidden="true" tabindex="-1"></a>  n_bins_scores <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb84-49"><a href="#cb84-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">bins =</span> <span class="fu">names</span>(<span class="fu">table</span>(<span class="fu">cut</span>(breaks, <span class="at">breaks =</span> breaks))),</span>
<span id="cb84-50"><a href="#cb84-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_bins_calib =</span> <span class="fu">as.vector</span>(n_bins_calib),</span>
<span id="cb84-51"><a href="#cb84-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_bins_test =</span> <span class="fu">as.vector</span>(n_bins_test),</span>
<span id="cb84-52"><a href="#cb84-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_bins_c_calib =</span> <span class="fu">as.vector</span>(n_bins_c_calib),</span>
<span id="cb84-53"><a href="#cb84-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_bins_c_test =</span> <span class="fu">as.vector</span>(n_bins_c_test),</span>
<span id="cb84-54"><a href="#cb84-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> method,</span>
<span id="cb84-55"><a href="#cb84-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> simul<span class="sc">$</span>seed,</span>
<span id="cb84-56"><a href="#cb84-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> type</span>
<span id="cb84-57"><a href="#cb84-57" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb84-58"><a href="#cb84-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-59"><a href="#cb84-59" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Confidence intervals</span></span>
<span id="cb84-60"><a href="#cb84-60" aria-hidden="true" tabindex="-1"></a>  tb_ci <span class="ot">&lt;-</span> <span class="fu">calibration_curve_ma_simul</span>(</span>
<span id="cb84-61"><a href="#cb84-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">simul =</span> simul, </span>
<span id="cb84-62"><a href="#cb84-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> method, </span>
<span id="cb84-63"><a href="#cb84-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">nn =</span> .<span class="dv">15</span>, <span class="at">prob =</span> .<span class="dv">95</span>,  <span class="at">ci_method =</span> <span class="st">"probit"</span></span>
<span id="cb84-64"><a href="#cb84-64" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb84-65"><a href="#cb84-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb84-66"><a href="#cb84-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">tb_ci =</span> tb_ci,</span>
<span id="cb84-67"><a href="#cb84-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_bins_scores =</span> n_bins_scores</span>
<span id="cb84-68"><a href="#cb84-68" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb84-69"><a href="#cb84-69" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We define a function that will plot the calibration maps computed on the calibration set and those computed on the test set. This function will plot a panel of calibration maps, each row corresponding to a specific value of the scale used to transform the probabilities (<span class="math inline">\(\alpha\)</span> or <span class="math inline">\(\gamma\)</span>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"True Prob."</span>, <span class="st">"No Calibration"</span>, <span class="st">"platt"</span>, <span class="st">"isotonic"</span>, <span class="st">"beta"</span>, </span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"locfit_0"</span>, <span class="st">"locfit_1"</span>, <span class="st">"locfit_2"</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>i_alpha <span class="ot">&lt;-</span> grid_alpha <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">i =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span> <span class="fu">group_by</span>(alpha) <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(i)</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>i_gamma <span class="ot">&lt;-</span> grid_gamma <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">i =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span> <span class="fu">group_by</span>(gamma) <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(i)</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">i =</span> i_alpha, <span class="at">type =</span> <span class="st">"alpha"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(</span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(<span class="at">i =</span> i_gamma, <span class="at">type =</span> <span class="st">"gamma"</span>)</span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">str_c</span>(i, <span class="st">"_"</span>, type))</span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">id =</span> tab<span class="sc">$</span>id, <span class="at">method =</span> methods) <span class="sc">|&gt;</span> </span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(id, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"i"</span>, <span class="st">"type"</span>), <span class="at">sep =</span> <span class="st">"_"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">i =</span> <span class="fu">as.numeric</span>(i))</span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-21"><a href="#cb85-21" aria-hidden="true" tabindex="-1"></a>method_names <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb85-22"><a href="#cb85-22" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>method, <span class="sc">~</span>method_lab,</span>
<span id="cb85-23"><a href="#cb85-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">"True Prob."</span>, <span class="st">"True Prob."</span>,</span>
<span id="cb85-24"><a href="#cb85-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">"No Calibration"</span>, <span class="st">"No Calibration"</span>, </span>
<span id="cb85-25"><a href="#cb85-25" aria-hidden="true" tabindex="-1"></a>  <span class="st">"platt"</span>, <span class="st">"Platt Scaling"</span>,</span>
<span id="cb85-26"><a href="#cb85-26" aria-hidden="true" tabindex="-1"></a>  <span class="st">"isotonic"</span>, <span class="st">"Isotonic Reg."</span>,</span>
<span id="cb85-27"><a href="#cb85-27" aria-hidden="true" tabindex="-1"></a>  <span class="st">"beta"</span>, <span class="st">"Beta Calib."</span>,</span>
<span id="cb85-28"><a href="#cb85-28" aria-hidden="true" tabindex="-1"></a>  <span class="st">"locfit_0"</span>, <span class="st">"Local Reg. (deg = 0)"</span>, </span>
<span id="cb85-29"><a href="#cb85-29" aria-hidden="true" tabindex="-1"></a>  <span class="st">"locfit_1"</span>, <span class="st">"Local Reg. (deg = 1)"</span>,</span>
<span id="cb85-30"><a href="#cb85-30" aria-hidden="true" tabindex="-1"></a>  <span class="st">"locfit_2"</span>, <span class="st">"Local Reg (deg = 2)"</span></span>
<span id="cb85-31"><a href="#cb85-31" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>plot_conf_int_ma_simul <span class="ot">&lt;-</span> <span class="cf">function</span>(method, type) {</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  current_grid <span class="ot">&lt;-</span> grid <span class="sc">|&gt;</span> </span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(method <span class="sc">==</span> <span class="sc">!!</span>method, type <span class="sc">==</span> <span class="sc">!!</span>type)</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">"alpha"</span>) {</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>    transform_scale <span class="ot">&lt;-</span> grid_alpha <span class="sc">|&gt;</span> <span class="fu">slice</span>(current_grid<span class="sc">$</span>i) <span class="sc">|&gt;</span> <span class="fu">pull</span>(alpha)</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">"gamma"</span>) {</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>    transform_scale <span class="ot">&lt;-</span> grid_gamma <span class="sc">|&gt;</span> <span class="fu">slice</span>(current_grid<span class="sc">$</span>i) <span class="sc">|&gt;</span> <span class="fu">pull</span>(gamma)</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Error argument `type`. Wrong value: either </span><span class="sc">\"</span><span class="st">alpha</span><span class="sc">\"</span><span class="st"> or </span><span class="sc">\"</span><span class="st">gamma</span><span class="sc">\"</span><span class="st">"</span>)</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>  data_plots <span class="ot">&lt;-</span>  <span class="fu">map</span>(</span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">.x =</span> current_grid<span class="sc">$</span>i,</span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">.f =</span> <span class="sc">~</span><span class="fu">get_data_plot_calib_ma_simul</span>(<span class="at">i =</span> .x, <span class="at">type =</span> type, <span class="at">method =</span> method)</span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a>  tb_cis <span class="ot">&lt;-</span> <span class="fu">map</span>(data_plots, <span class="fu">pluck</span>(<span class="st">"tb_ci"</span>))</span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a>  n_bins_scores <span class="ot">&lt;-</span> <span class="fu">map</span>(data_plots, <span class="fu">pluck</span>(<span class="st">"n_bins_scores"</span>))</span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a>  nb <span class="ot">&lt;-</span> <span class="fu">length</span>(data_plots)</span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a>  mat <span class="ot">&lt;-</span> mat_init <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(nb<span class="dv">-1</span>)) {</span>
<span id="cb86-24"><a href="#cb86-24" aria-hidden="true" tabindex="-1"></a>    mat <span class="ot">&lt;-</span> <span class="fu">rbind</span>(mat, mat_init <span class="sc">+</span> j <span class="sc">*</span> <span class="dv">4</span>)</span>
<span id="cb86-25"><a href="#cb86-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb86-26"><a href="#cb86-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(mat, <span class="at">heights =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), nb))</span>
<span id="cb86-27"><a href="#cb86-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-28"><a href="#cb86-28" aria-hidden="true" tabindex="-1"></a>  y_lim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb86-29"><a href="#cb86-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-30"><a href="#cb86-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># i_recalib &lt;- 1</span></span>
<span id="cb86-31"><a href="#cb86-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i_recalib <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nb) {</span>
<span id="cb86-32"><a href="#cb86-32" aria-hidden="true" tabindex="-1"></a>    tb_ci_current <span class="ot">&lt;-</span> tb_cis[[i_recalib]]</span>
<span id="cb86-33"><a href="#cb86-33" aria-hidden="true" tabindex="-1"></a>    n_bins_scores_current <span class="ot">&lt;-</span> n_bins_scores[[i_recalib]]</span>
<span id="cb86-34"><a href="#cb86-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb86-35"><a href="#cb86-35" aria-hidden="true" tabindex="-1"></a>    title <span class="ot">&lt;-</span> <span class="fu">str_c</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">"</span>, type, <span class="st">"="</span>, <span class="fu">round</span>(transform_scale[i_recalib], <span class="dv">2</span>), <span class="st">"$"</span>)</span>
<span id="cb86-36"><a href="#cb86-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb86-37"><a href="#cb86-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (sample <span class="cf">in</span> <span class="fu">c</span>(<span class="st">"Calibration"</span>, <span class="st">"Test"</span>)) {</span>
<span id="cb86-38"><a href="#cb86-38" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Histogram with values</span></span>
<span id="cb86-39"><a href="#cb86-39" aria-hidden="true" tabindex="-1"></a>      tb_plot <span class="ot">&lt;-</span> tb_ci_current <span class="sc">|&gt;</span> <span class="fu">filter</span>(sample <span class="sc">==</span> <span class="sc">!!</span>sample)</span>
<span id="cb86-40"><a href="#cb86-40" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb86-41"><a href="#cb86-41" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (sample <span class="sc">==</span> <span class="st">"Calibration"</span>){</span>
<span id="cb86-42"><a href="#cb86-42" aria-hidden="true" tabindex="-1"></a>        colour <span class="ot">&lt;-</span> <span class="st">"#D55E00"</span></span>
<span id="cb86-43"><a href="#cb86-43" aria-hidden="true" tabindex="-1"></a>        n_bins_current <span class="ot">&lt;-</span> n_bins_scores_current<span class="sc">$</span>n_bins_calib</span>
<span id="cb86-44"><a href="#cb86-44" aria-hidden="true" tabindex="-1"></a>        n_bins_c_current <span class="ot">&lt;-</span> n_bins_scores_current<span class="sc">$</span>n_bins_c_calib</span>
<span id="cb86-45"><a href="#cb86-45" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb86-46"><a href="#cb86-46" aria-hidden="true" tabindex="-1"></a>        colour <span class="ot">&lt;-</span> <span class="st">"#009E73"</span></span>
<span id="cb86-47"><a href="#cb86-47" aria-hidden="true" tabindex="-1"></a>        n_bins_current <span class="ot">&lt;-</span> n_bins_scores_current<span class="sc">$</span>n_bins_test</span>
<span id="cb86-48"><a href="#cb86-48" aria-hidden="true" tabindex="-1"></a>        n_bins_c_current <span class="ot">&lt;-</span> n_bins_scores_current<span class="sc">$</span>n_bins_c_test</span>
<span id="cb86-49"><a href="#cb86-49" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb86-50"><a href="#cb86-50" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb86-51"><a href="#cb86-51" aria-hidden="true" tabindex="-1"></a>      <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">4.3</span>, <span class="fl">1.0</span>, <span class="fl">0.5</span>))</span>
<span id="cb86-52"><a href="#cb86-52" aria-hidden="true" tabindex="-1"></a>      y_lim_bp <span class="ot">&lt;-</span> <span class="fu">range</span>(<span class="fu">c</span>(n_bins_current, n_bins_c_current), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-53"><a href="#cb86-53" aria-hidden="true" tabindex="-1"></a>      <span class="fu">barplot</span>(</span>
<span id="cb86-54"><a href="#cb86-54" aria-hidden="true" tabindex="-1"></a>        n_bins_current,</span>
<span id="cb86-55"><a href="#cb86-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">"#000000"</span>, <span class="at">alpha.f =</span> .<span class="dv">3</span>),</span>
<span id="cb86-56"><a href="#cb86-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylim =</span> y_lim_bp,</span>
<span id="cb86-57"><a href="#cb86-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="st">"white"</span>,</span>
<span id="cb86-58"><a href="#cb86-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">axes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb86-59"><a href="#cb86-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>, </span>
<span id="cb86-60"><a href="#cb86-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(title)</span>
<span id="cb86-61"><a href="#cb86-61" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb86-62"><a href="#cb86-62" aria-hidden="true" tabindex="-1"></a>      <span class="fu">barplot</span>(</span>
<span id="cb86-63"><a href="#cb86-63" aria-hidden="true" tabindex="-1"></a>        n_bins_c_current,</span>
<span id="cb86-64"><a href="#cb86-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">"#0072B2"</span>, <span class="at">alpha.f =</span> .<span class="dv">3</span>),</span>
<span id="cb86-65"><a href="#cb86-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylim =</span> y_lim_bp,</span>
<span id="cb86-66"><a href="#cb86-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="st">"white"</span>,</span>
<span id="cb86-67"><a href="#cb86-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">axes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb86-68"><a href="#cb86-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">main =</span> <span class="st">""</span>,</span>
<span id="cb86-69"><a href="#cb86-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">add =</span> <span class="cn">TRUE</span></span>
<span id="cb86-70"><a href="#cb86-70" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb86-71"><a href="#cb86-71" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb86-72"><a href="#cb86-72" aria-hidden="true" tabindex="-1"></a>      <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">4.1</span>, <span class="fl">4.3</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb86-73"><a href="#cb86-73" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot</span>(</span>
<span id="cb86-74"><a href="#cb86-74" aria-hidden="true" tabindex="-1"></a>        tb_plot<span class="sc">$</span>xlim, tb_plot<span class="sc">$</span>mean,</span>
<span id="cb86-75"><a href="#cb86-75" aria-hidden="true" tabindex="-1"></a>        <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">ylim =</span> y_lim, <span class="at">xlim =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">type =</span> <span class="st">"l"</span>,</span>
<span id="cb86-76"><a href="#cb86-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"Predicted score $p$"</span>), </span>
<span id="cb86-77"><a href="#cb86-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$E(d | s(x) = p)$"</span>),</span>
<span id="cb86-78"><a href="#cb86-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> colour</span>
<span id="cb86-79"><a href="#cb86-79" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb86-80"><a href="#cb86-80" aria-hidden="true" tabindex="-1"></a>      <span class="fu">polygon</span>(</span>
<span id="cb86-81"><a href="#cb86-81" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(tb_plot<span class="sc">$</span>xlim, <span class="fu">rev</span>(tb_plot<span class="sc">$</span>xlim)),</span>
<span id="cb86-82"><a href="#cb86-82" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(tb_plot<span class="sc">$</span>lower, <span class="fu">rev</span>(tb_plot<span class="sc">$</span>upper)),</span>
<span id="cb86-83"><a href="#cb86-83" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="at">col =</span> colour, <span class="at">alpha.f =</span> .<span class="dv">4</span>),</span>
<span id="cb86-84"><a href="#cb86-84" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span></span>
<span id="cb86-85"><a href="#cb86-85" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb86-86"><a href="#cb86-86" aria-hidden="true" tabindex="-1"></a>      <span class="fu">segments</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb86-87"><a href="#cb86-87" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb86-88"><a href="#cb86-88" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb86-89"><a href="#cb86-89" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For the first two tabs, <code>True Prob.</code> and <code>No Calibration</code>, the calibration curves are those computed using the true probabilities and the uncalibrated scores instead of some recalibrated scores. This is done for comparison purposes.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">For <span class="math inline">\(\alpha\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">For <span class="math inline">\(\gamma\)</span></a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">True Prob.</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">No Calibration</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false">Platt Scaling</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-4" role="tab" aria-controls="tabset-9-4" aria-selected="false">Isotonic Reg.</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-5" role="tab" aria-controls="tabset-9-5" aria-selected="false">Beta Calib.</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-6" role="tab" aria-controls="tabset-9-6" aria-selected="false">Local Reg. (deg = 0)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-7" role="tab" aria-controls="tabset-9-7" aria-selected="false">Local Reg. (deg = 1)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-8" role="tab" aria-controls="tabset-9-8" aria-selected="false">Local Reg (deg = 2)</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with a moving average for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for a single replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-110-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with a moving average for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for a single replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-111-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with a moving average for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for a single replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-112-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-9-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-4-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with a moving average for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for a single replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-113-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-9-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-5-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with a moving average for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for a single replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-114-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-9-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-6-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with a moving average for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for a single replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-115-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-9-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-7-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with a moving average for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for a single replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-116-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-9-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-8-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with a moving average for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for a single replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-117-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">True Prob.</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">No Calibration</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-3" role="tab" aria-controls="tabset-10-3" aria-selected="false">Platt Scaling</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-4" role="tab" aria-controls="tabset-10-4" aria-selected="false">Isotonic Reg.</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-5" role="tab" aria-controls="tabset-10-5" aria-selected="false">Beta Calib.</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-6" role="tab" aria-controls="tabset-10-6" aria-selected="false">Local Reg. (deg = 0)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-7" role="tab" aria-controls="tabset-10-7" aria-selected="false">Local Reg. (deg = 1)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-8" role="tab" aria-controls="tabset-10-8" aria-selected="false">Local Reg (deg = 2)</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with a moving average for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for a single replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-118-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with a moving average for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for a single replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-119-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-10-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-3-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with a moving average for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for a single replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-120-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-10-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-4-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with a moving average for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for a single replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-121-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-10-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-5-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with a moving average for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for a single replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-122-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-10-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-6-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with a moving average for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for a single replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-123-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-10-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-7-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with a moving average for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for a single replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-124-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-10-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-8-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with a moving average for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for a single replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-125-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="calibration-maps-200-replications" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="calibration-maps-200-replications"><span class="header-section-number">2.7</span> Calibration Maps (200 replications)</h2>
<p>We now turn to the same type of visualization, but adapted to the 200 replications instead of a single one.</p>
<p>First, let us create a function, <code class="sourceCode r"><span class="fu">get_count_simul</span>()</code> to get the number of observation in each bin separating the [0,1] segment with uncalibrated and recalibrated scores (both on the calibration and the recalibration sets), for all the simulations. Then, we can compute an average count per bin over the simulations. This will be useful to have an idea of the distributions of scores in the different scenarios (varying values for <span class="math inline">\(\alpha\)</span> or <span class="math inline">\(\gamma\)</span>) and each recalibration method (Platt Scaling, Isotonic regression, etc.).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param i index of the simulation to use (in `simul_recalib_alpha` or </span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="co">#'   `simul_recalib_gamma`)</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param type type of transformed probabilities (made on `alpha` or `gamma`)</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param method name of the recalibration method to focus on</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>get_count_simul <span class="ot">&lt;-</span> <span class="cf">function</span>(i, type, method) {</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">"alpha"</span>) {</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>    simul <span class="ot">&lt;-</span> simul_recalib_alpha[[i]]</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>    transform_scale <span class="ot">&lt;-</span> grid_alpha<span class="sc">$</span>alpha[i]</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">"gamma"</span>) {</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>    simul <span class="ot">&lt;-</span> simul_recalib_gamma[[i]]</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>    transform_scale <span class="ot">&lt;-</span> grid_gamma<span class="sc">$</span>gamma[i]</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Wrong value for argument `type`."</span>)</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Counting number of obs in bins defined over [0,1]</span></span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>  breaks <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">05</span>)</span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (method <span class="sc">==</span> <span class="st">"True Prob."</span>) {</span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>    scores_calib <span class="ot">&lt;-</span> simul<span class="sc">$</span>data_all_calib<span class="sc">$</span>p</span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>    scores_test <span class="ot">&lt;-</span> simul<span class="sc">$</span>data_all_test<span class="sc">$</span>p</span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a>    scores_c_calib <span class="ot">&lt;-</span> scores_c_test <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (method <span class="sc">==</span> <span class="st">"No Calibration"</span>) {</span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a>    scores_calib <span class="ot">&lt;-</span> simul<span class="sc">$</span>data_all_calib<span class="sc">$</span>p_u</span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a>    scores_test <span class="ot">&lt;-</span> simul<span class="sc">$</span>data_all_test<span class="sc">$</span>p_u</span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a>    scores_c_calib <span class="ot">&lt;-</span> scores_c_test <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb87-27"><a href="#cb87-27" aria-hidden="true" tabindex="-1"></a>    tb_score_c_calib <span class="ot">&lt;-</span> simul<span class="sc">$</span>res_recalibration[[method]]<span class="sc">$</span>tb_score_c_calib</span>
<span id="cb87-28"><a href="#cb87-28" aria-hidden="true" tabindex="-1"></a>    tb_score_c_test <span class="ot">&lt;-</span> simul<span class="sc">$</span>res_recalibration[[method]]<span class="sc">$</span>tb_score_c_test</span>
<span id="cb87-29"><a href="#cb87-29" aria-hidden="true" tabindex="-1"></a>    scores_calib <span class="ot">&lt;-</span> tb_score_c_calib<span class="sc">$</span>p_u</span>
<span id="cb87-30"><a href="#cb87-30" aria-hidden="true" tabindex="-1"></a>    scores_test <span class="ot">&lt;-</span> tb_score_c_test<span class="sc">$</span>p_u</span>
<span id="cb87-31"><a href="#cb87-31" aria-hidden="true" tabindex="-1"></a>    scores_c_calib <span class="ot">&lt;-</span> tb_score_c_calib<span class="sc">$</span>p_c</span>
<span id="cb87-32"><a href="#cb87-32" aria-hidden="true" tabindex="-1"></a>    scores_c_test <span class="ot">&lt;-</span> tb_score_c_test<span class="sc">$</span>p_c</span>
<span id="cb87-33"><a href="#cb87-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb87-34"><a href="#cb87-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb87-35"><a href="#cb87-35" aria-hidden="true" tabindex="-1"></a>  n_bins_calib <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">cut</span>(scores_calib, <span class="at">breaks =</span> breaks))</span>
<span id="cb87-36"><a href="#cb87-36" aria-hidden="true" tabindex="-1"></a>  n_bins_test <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">cut</span>(scores_test, <span class="at">breaks =</span> breaks))</span>
<span id="cb87-37"><a href="#cb87-37" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(scores_c_calib)) {</span>
<span id="cb87-38"><a href="#cb87-38" aria-hidden="true" tabindex="-1"></a>    n_bins_c_calib <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">cut</span>(scores_c_calib, <span class="at">breaks =</span> breaks))</span>
<span id="cb87-39"><a href="#cb87-39" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb87-40"><a href="#cb87-40" aria-hidden="true" tabindex="-1"></a>    n_bins_c_calib <span class="ot">&lt;-</span> <span class="cn">NA_integer_</span></span>
<span id="cb87-41"><a href="#cb87-41" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb87-42"><a href="#cb87-42" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(scores_c_test)) {</span>
<span id="cb87-43"><a href="#cb87-43" aria-hidden="true" tabindex="-1"></a>    n_bins_c_test <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">cut</span>(scores_c_test, <span class="at">breaks =</span> breaks))</span>
<span id="cb87-44"><a href="#cb87-44" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb87-45"><a href="#cb87-45" aria-hidden="true" tabindex="-1"></a>    n_bins_c_test <span class="ot">&lt;-</span> <span class="cn">NA_integer_</span></span>
<span id="cb87-46"><a href="#cb87-46" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb87-47"><a href="#cb87-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb87-48"><a href="#cb87-48" aria-hidden="true" tabindex="-1"></a>  n_bins_scores <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb87-49"><a href="#cb87-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">bins =</span> <span class="fu">names</span>(<span class="fu">table</span>(<span class="fu">cut</span>(breaks, <span class="at">breaks =</span> breaks))),</span>
<span id="cb87-50"><a href="#cb87-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_bins_calib =</span> <span class="fu">as.vector</span>(n_bins_calib),</span>
<span id="cb87-51"><a href="#cb87-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_bins_test =</span> <span class="fu">as.vector</span>(n_bins_test),</span>
<span id="cb87-52"><a href="#cb87-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_bins_c_calib =</span> <span class="fu">as.vector</span>(n_bins_c_calib),</span>
<span id="cb87-53"><a href="#cb87-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_bins_c_test =</span> <span class="fu">as.vector</span>(n_bins_c_test),</span>
<span id="cb87-54"><a href="#cb87-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> method,</span>
<span id="cb87-55"><a href="#cb87-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> simul<span class="sc">$</span>seed,</span>
<span id="cb87-56"><a href="#cb87-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> type,</span>
<span id="cb87-57"><a href="#cb87-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">transform_scale =</span> transform_scale</span>
<span id="cb87-58"><a href="#cb87-58" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb87-59"><a href="#cb87-59" aria-hidden="true" tabindex="-1"></a>  n_bins_scores</span>
<span id="cb87-60"><a href="#cb87-60" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us apply this function to all simulations, both for varying values of <span class="math inline">\(\alpha\)</span> and for <span class="math inline">\(\gamma\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>grid_count_alpha <span class="ot">&lt;-</span> </span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_grid</span>(</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(grid_alpha), </span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="fu">c</span>(</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">"True Prob."</span>, <span class="st">"No Calibration"</span>,</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>      <span class="st">"platt"</span>, <span class="st">"isotonic"</span>, <span class="st">"beta"</span>, <span class="st">"locfit_0"</span>, <span class="st">"locfit_1"</span>, <span class="st">"locfit_2"</span>)</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>grid_count_gamma <span class="ot">&lt;-</span> </span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_grid</span>(</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(grid_gamma), </span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="fu">c</span>(</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>      <span class="st">"True Prob."</span>, <span class="st">"No Calibration"</span>,</span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">"platt"</span>, <span class="st">"isotonic"</span>, <span class="st">"beta"</span>, <span class="st">"locfit_0"</span>, <span class="st">"locfit_1"</span>, <span class="st">"locfit_2"</span>)</span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>count_scores_alpha <span class="ot">&lt;-</span> <span class="fu">map</span>(</span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">.x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(grid_count_alpha),</span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">.f =</span> <span class="sc">~</span><span class="fu">get_count_simul</span>(</span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">i =</span> grid_count_alpha<span class="sc">$</span>i[.x], </span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"alpha"</span>, </span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> grid_count_alpha<span class="sc">$</span>method[.x]</span>
<span id="cb88-22"><a href="#cb88-22" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb88-23"><a href="#cb88-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">.progress =</span> <span class="cn">TRUE</span></span>
<span id="cb88-24"><a href="#cb88-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb88-25"><a href="#cb88-25" aria-hidden="true" tabindex="-1"></a>count_scores_gamma <span class="ot">&lt;-</span> <span class="fu">map</span>(</span>
<span id="cb88-26"><a href="#cb88-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">.x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(grid_count_gamma),</span>
<span id="cb88-27"><a href="#cb88-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">.f =</span> <span class="sc">~</span><span class="fu">get_count_simul</span>(</span>
<span id="cb88-28"><a href="#cb88-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">i =</span> grid_count_gamma<span class="sc">$</span>i[.x], </span>
<span id="cb88-29"><a href="#cb88-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"gamma"</span>, </span>
<span id="cb88-30"><a href="#cb88-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> grid_count_gamma<span class="sc">$</span>method[.x]</span>
<span id="cb88-31"><a href="#cb88-31" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb88-32"><a href="#cb88-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">.progress =</span> <span class="cn">TRUE</span></span>
<span id="cb88-33"><a href="#cb88-33" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wen can then compute the average in each bin for each of the four scores (uncalibrated in the calibration set, uncalibrated in the test set, recalibrated in the calibration set, recalibrated in the test set), for each method, both for varying values of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\gamma\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>count_scores_alpha <span class="ot">&lt;-</span> </span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  count_scores_alpha <span class="sc">|&gt;</span> </span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list_rbind</span>() <span class="sc">|&gt;</span> </span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method, type, bins, transform_scale) <span class="sc">|&gt;</span> </span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_bins_calib =</span> <span class="fu">mean</span>(n_bins_calib, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_bins_test =</span> <span class="fu">mean</span>(n_bins_test, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_bins_c_calib =</span> <span class="fu">mean</span>(n_bins_c_calib, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_bins_c_test =</span> <span class="fu">mean</span>(n_bins_c_test, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>count_scores_gamma <span class="ot">&lt;-</span> </span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>  count_scores_gamma <span class="sc">|&gt;</span> </span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list_rbind</span>() <span class="sc">|&gt;</span> </span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method,type, bins, transform_scale) <span class="sc">|&gt;</span> </span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_bins_calib =</span> <span class="fu">mean</span>(n_bins_calib, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_bins_test =</span> <span class="fu">mean</span>(n_bins_test, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_bins_c_calib =</span> <span class="fu">mean</span>(n_bins_c_calib, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_bins_c_test =</span> <span class="fu">mean</span>(n_bins_c_test, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="quantile-based-bins-1" class="level3" data-number="2.7.1">
<h3 data-number="2.7.1" class="anchored" data-anchor-id="quantile-based-bins-1"><span class="header-section-number">2.7.1</span> Quantile-Based Bins</h3>
<p>Instead of looking at the confidence intervals for a single replication, we can plot the 200 replications on a single plot. The quantiles can slightly change from one replication to another. It is therefore not possible to compute credible intervals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param simul a single replication result</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param method name of the method used to recalibrate for which to compute the calibration curve</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param k number of bins to create (quantiles, default to `10`)</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>get_summary_bins_simul <span class="ot">&lt;-</span> <span class="cf">function</span>(simul, method, <span class="at">k =</span> <span class="dv">10</span>) {</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>  obs_calib <span class="ot">&lt;-</span> simul<span class="sc">$</span>data_all_calib<span class="sc">$</span>d</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>  obs_test <span class="ot">&lt;-</span> simul<span class="sc">$</span>data_all_test<span class="sc">$</span>d</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (method <span class="sc">==</span> <span class="st">"True Prob."</span>) {</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>    scores_calib <span class="ot">&lt;-</span> simul<span class="sc">$</span>data_all_calib<span class="sc">$</span>p</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>    scores_test <span class="ot">&lt;-</span> simul<span class="sc">$</span>data_all_test<span class="sc">$</span>p</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (method <span class="sc">==</span> <span class="st">"No Calibration"</span>) {</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>    scores_calib <span class="ot">&lt;-</span> simul<span class="sc">$</span>data_all_calib<span class="sc">$</span>p_u</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>    scores_test <span class="ot">&lt;-</span> simul<span class="sc">$</span>data_all_test<span class="sc">$</span>p_u</span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>    tb_score_c_calib <span class="ot">&lt;-</span> simul<span class="sc">$</span>res_recalibration[[method]]<span class="sc">$</span>tb_score_c_calib</span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>    tb_score_c_test <span class="ot">&lt;-</span> simul<span class="sc">$</span>res_recalibration[[method]]<span class="sc">$</span>tb_score_c_test</span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>    scores_calib <span class="ot">&lt;-</span> tb_score_c_calib<span class="sc">$</span>p_c</span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a>    scores_test <span class="ot">&lt;-</span> tb_score_c_test<span class="sc">$</span>p_c</span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb90-20"><a href="#cb90-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb90-21"><a href="#cb90-21" aria-hidden="true" tabindex="-1"></a>  summary_bins_calib <span class="ot">&lt;-</span> <span class="fu">get_summary_bins</span>(</span>
<span id="cb90-22"><a href="#cb90-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">obs =</span> obs_calib, <span class="at">scores =</span> scores_calib, <span class="at">k =</span> k)</span>
<span id="cb90-23"><a href="#cb90-23" aria-hidden="true" tabindex="-1"></a>  summary_bins_test <span class="ot">&lt;-</span> <span class="fu">get_summary_bins</span>(</span>
<span id="cb90-24"><a href="#cb90-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">obs =</span> obs_test, <span class="at">scores =</span> scores_test, <span class="at">k =</span> k)</span>
<span id="cb90-25"><a href="#cb90-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb90-26"><a href="#cb90-26" aria-hidden="true" tabindex="-1"></a>  summary_bins_calib <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">sample =</span> <span class="st">"Calibration"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb90-27"><a href="#cb90-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(summary_bins_test <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">sample =</span> <span class="st">"Test"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb90-28"><a href="#cb90-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">method =</span> method, <span class="at">seed =</span> simul<span class="sc">$</span>seed)</span>
<span id="cb90-29"><a href="#cb90-29" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us loop over all the methods and all the replications for each value of <span class="math inline">\(\alpha\)</span> to get the quantile-based calibration curves.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For alpha</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">names</span>(simul_recalib_alpha[[<span class="dv">1</span>]]<span class="sc">$</span>res_recalibration)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"True Prob."</span>, <span class="st">"No Calibration"</span>, methods)</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>summary_bins_simuls_alpha <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"list"</span>, <span class="at">length =</span> <span class="fu">length</span>(methods))</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(summary_bins_simuls_alpha) <span class="ot">&lt;-</span> methods</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(future)</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>nb_cores <span class="ot">&lt;-</span> future<span class="sc">::</span><span class="fu">availableCores</span>()<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> nb_cores)</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(methods)) {</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>  progressr<span class="sc">::</span><span class="fu">with_progress</span>({</span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> progressr<span class="sc">::</span><span class="fu">progressor</span>(<span class="at">steps =</span> <span class="fu">nrow</span>(grid_alpha))</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>    summary_bins_simuls_m <span class="ot">&lt;-</span> furrr<span class="sc">::</span><span class="fu">future_map</span>(</span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">.x =</span> simul_recalib_alpha,</span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">.f =</span> <span class="sc">~</span>{</span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">p</span>()</span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">get_summary_bins_simul</span>(<span class="at">simul =</span> .x, <span class="at">method =</span> methods[i_method], <span class="at">k =</span> <span class="dv">10</span>)</span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a>      },</span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">.options =</span> furrr<span class="sc">::</span><span class="fu">furrr_options</span>(<span class="at">seed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add value for alpha</span></span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(summary_bins_simuls_m)) {</span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true" tabindex="-1"></a>    summary_bins_simuls_m[[j]]<span class="sc">$</span>scale_parameter <span class="ot">&lt;-</span> grid_alpha<span class="sc">$</span>alpha[j]</span>
<span id="cb91-25"><a href="#cb91-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb91-26"><a href="#cb91-26" aria-hidden="true" tabindex="-1"></a>  summary_bins_simuls_alpha[[i_method]] <span class="ot">&lt;-</span> summary_bins_simuls_m <span class="sc">|&gt;</span> </span>
<span id="cb91-27"><a href="#cb91-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list_rbind</span>(<span class="at">names_to =</span> <span class="st">"i_row"</span>)</span>
<span id="cb91-28"><a href="#cb91-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb91-29"><a href="#cb91-29" aria-hidden="true" tabindex="-1"></a>summary_bins_simuls_alpha <span class="ot">&lt;-</span> <span class="fu">list_rbind</span>(</span>
<span id="cb91-30"><a href="#cb91-30" aria-hidden="true" tabindex="-1"></a>  summary_bins_simuls_alpha, <span class="at">names_to =</span> <span class="st">"method"</span></span>
<span id="cb91-31"><a href="#cb91-31" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb91-32"><a href="#cb91-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="st">"alpha"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We do the same for the values of <span class="math inline">\(\gamma\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For gamma</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">names</span>(simul_recalib_gamma[[<span class="dv">1</span>]]<span class="sc">$</span>res_recalibration)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"True Prob."</span>, <span class="st">"No Calibration"</span>, methods)</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>summary_bins_simuls_gamma <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"list"</span>, <span class="at">length =</span> <span class="fu">length</span>(methods))</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(summary_bins_simuls_gamma) <span class="ot">&lt;-</span> methods</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(future)</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>nb_cores <span class="ot">&lt;-</span> future<span class="sc">::</span><span class="fu">availableCores</span>()<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> nb_cores)</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(methods)) {</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>  progressr<span class="sc">::</span><span class="fu">with_progress</span>({</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> progressr<span class="sc">::</span><span class="fu">progressor</span>(<span class="at">steps =</span> <span class="fu">nrow</span>(grid_gamma))</span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>    summary_bins_simuls_m <span class="ot">&lt;-</span> furrr<span class="sc">::</span><span class="fu">future_map</span>(</span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">.x =</span> simul_recalib_gamma,</span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">.f =</span> <span class="sc">~</span>{</span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">p</span>()</span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">get_summary_bins_simul</span>(<span class="at">simul =</span> .x, <span class="at">method =</span> methods[i_method], <span class="at">k =</span> <span class="dv">10</span>)</span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a>      },</span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">.options =</span> furrr<span class="sc">::</span><span class="fu">furrr_options</span>(<span class="at">seed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb92-20"><a href="#cb92-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb92-21"><a href="#cb92-21" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb92-22"><a href="#cb92-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add value for alpha</span></span>
<span id="cb92-23"><a href="#cb92-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(summary_bins_simuls_m)) {</span>
<span id="cb92-24"><a href="#cb92-24" aria-hidden="true" tabindex="-1"></a>    summary_bins_simuls_m[[j]]<span class="sc">$</span>scale_parameter <span class="ot">&lt;-</span> grid_gamma<span class="sc">$</span>gamma[j]</span>
<span id="cb92-25"><a href="#cb92-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb92-26"><a href="#cb92-26" aria-hidden="true" tabindex="-1"></a>  summary_bins_simuls_gamma[[i_method]] <span class="ot">&lt;-</span> summary_bins_simuls_m <span class="sc">|&gt;</span> </span>
<span id="cb92-27"><a href="#cb92-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list_rbind</span>(<span class="at">names_to =</span> <span class="st">"i_row"</span>)</span>
<span id="cb92-28"><a href="#cb92-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb92-29"><a href="#cb92-29" aria-hidden="true" tabindex="-1"></a>summary_bins_simuls_gamma <span class="ot">&lt;-</span> <span class="fu">list_rbind</span>(</span>
<span id="cb92-30"><a href="#cb92-30" aria-hidden="true" tabindex="-1"></a>  summary_bins_simuls_gamma, <span class="at">names_to =</span> <span class="st">"method"</span></span>
<span id="cb92-31"><a href="#cb92-31" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb92-32"><a href="#cb92-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="st">"gamma"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The results are stored in a single tibble:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>summary_bins_simuls <span class="ot">&lt;-</span> summary_bins_simuls_alpha <span class="sc">|&gt;</span> </span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(summary_bins_simuls_gamma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us define a function to plot the calibration curves on the calibration and the test samples.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>plot_calib_qbins_simuls <span class="ot">&lt;-</span> <span class="cf">function</span>(method, type) {</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  tb_calibration_curve <span class="ot">&lt;-</span> summary_bins_simuls <span class="sc">|&gt;</span> </span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>      method <span class="sc">==</span> <span class="sc">!!</span>method,</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>      type <span class="sc">==</span> <span class="sc">!!</span>type</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">"alpha"</span>) {</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>    count_scores <span class="ot">&lt;-</span> count_scores_alpha <span class="sc">|&gt;</span> <span class="fu">filter</span>(method <span class="sc">==</span> <span class="sc">!!</span>method)</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">"gamma"</span>) {</span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>    count_scores <span class="ot">&lt;-</span> count_scores_gamma <span class="sc">|&gt;</span> <span class="fu">filter</span>(method <span class="sc">==</span> <span class="sc">!!</span>method)</span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Type should be either </span><span class="sc">\"</span><span class="st">alpha</span><span class="sc">\"</span><span class="st"> or </span><span class="sc">\"</span><span class="st">gamma</span><span class="sc">\"</span><span class="st">"</span>)</span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a>  scale_params <span class="ot">&lt;-</span> <span class="fu">unique</span>(tb_calibration_curve<span class="sc">$</span>scale_parameter)</span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a>  seeds <span class="ot">&lt;-</span> <span class="fu">unique</span>(tb_calibration_curve<span class="sc">$</span>seed)</span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a>  colours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Calibration"</span> <span class="ot">=</span> <span class="st">"#D55E00"</span>, <span class="st">"Test"</span> <span class="ot">=</span> <span class="st">"#009E73"</span>)</span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb94-20"><a href="#cb94-20" aria-hidden="true" tabindex="-1"></a>  nb <span class="ot">&lt;-</span> <span class="fu">length</span>(scale_params)</span>
<span id="cb94-21"><a href="#cb94-21" aria-hidden="true" tabindex="-1"></a>  mat <span class="ot">&lt;-</span> mat_init <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb94-22"><a href="#cb94-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(nb<span class="dv">-1</span>)) {</span>
<span id="cb94-23"><a href="#cb94-23" aria-hidden="true" tabindex="-1"></a>    mat <span class="ot">&lt;-</span> <span class="fu">rbind</span>(mat, mat_init <span class="sc">+</span> j <span class="sc">*</span> <span class="dv">4</span>)</span>
<span id="cb94-24"><a href="#cb94-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb94-25"><a href="#cb94-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(mat, <span class="at">heights =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), nb))</span>
<span id="cb94-26"><a href="#cb94-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb94-27"><a href="#cb94-27" aria-hidden="true" tabindex="-1"></a>  y_lim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb94-28"><a href="#cb94-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb94-29"><a href="#cb94-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (scale_param <span class="cf">in</span> scale_params) {</span>
<span id="cb94-30"><a href="#cb94-30" aria-hidden="true" tabindex="-1"></a>    title <span class="ot">&lt;-</span> <span class="fu">str_c</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">"</span>, type, <span class="st">" = $"</span>, <span class="fu">round</span>(scale_param, <span class="dv">2</span>))</span>
<span id="cb94-31"><a href="#cb94-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb94-32"><a href="#cb94-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (sample <span class="cf">in</span> <span class="fu">c</span>(<span class="st">"Calibration"</span>, <span class="st">"Test"</span>)) {</span>
<span id="cb94-33"><a href="#cb94-33" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (sample <span class="sc">==</span> <span class="st">"Calibration"</span>){</span>
<span id="cb94-34"><a href="#cb94-34" aria-hidden="true" tabindex="-1"></a>        n_bins_current <span class="ot">&lt;-</span> count_scores <span class="sc">|&gt;</span> </span>
<span id="cb94-35"><a href="#cb94-35" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(transform_scale <span class="sc">==</span> <span class="sc">!!</span>scale_param) <span class="sc">|&gt;</span> <span class="fu">pull</span>(<span class="st">"n_bins_calib"</span>)</span>
<span id="cb94-36"><a href="#cb94-36" aria-hidden="true" tabindex="-1"></a>        n_bins_c_current <span class="ot">&lt;-</span> count_scores <span class="sc">|&gt;</span> </span>
<span id="cb94-37"><a href="#cb94-37" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(transform_scale <span class="sc">==</span> <span class="sc">!!</span>scale_param) <span class="sc">|&gt;</span> <span class="fu">pull</span>(<span class="st">"n_bins_c_calib"</span>)</span>
<span id="cb94-38"><a href="#cb94-38" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb94-39"><a href="#cb94-39" aria-hidden="true" tabindex="-1"></a>        n_bins_current <span class="ot">&lt;-</span> count_scores <span class="sc">|&gt;</span> </span>
<span id="cb94-40"><a href="#cb94-40" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(transform_scale <span class="sc">==</span> <span class="sc">!!</span>scale_param) <span class="sc">|&gt;</span> <span class="fu">pull</span>(<span class="st">"n_bins_test"</span>)</span>
<span id="cb94-41"><a href="#cb94-41" aria-hidden="true" tabindex="-1"></a>        n_bins_c_current <span class="ot">&lt;-</span> count_scores <span class="sc">|&gt;</span> </span>
<span id="cb94-42"><a href="#cb94-42" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(transform_scale <span class="sc">==</span> <span class="sc">!!</span>scale_param) <span class="sc">|&gt;</span> <span class="fu">pull</span>(<span class="st">"n_bins_c_test"</span>)</span>
<span id="cb94-43"><a href="#cb94-43" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb94-44"><a href="#cb94-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">4.3</span>, <span class="fl">1.0</span>, <span class="fl">0.5</span>))</span>
<span id="cb94-45"><a href="#cb94-45" aria-hidden="true" tabindex="-1"></a>      y_lim_bp <span class="ot">&lt;-</span> <span class="fu">range</span>(<span class="fu">c</span>(n_bins_current, n_bins_c_current), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb94-46"><a href="#cb94-46" aria-hidden="true" tabindex="-1"></a>      <span class="fu">barplot</span>(</span>
<span id="cb94-47"><a href="#cb94-47" aria-hidden="true" tabindex="-1"></a>        n_bins_current,</span>
<span id="cb94-48"><a href="#cb94-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">"#000000"</span>, <span class="at">alpha.f =</span> .<span class="dv">3</span>),</span>
<span id="cb94-49"><a href="#cb94-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylim =</span> y_lim_bp,</span>
<span id="cb94-50"><a href="#cb94-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="st">"white"</span>,</span>
<span id="cb94-51"><a href="#cb94-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">axes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb94-52"><a href="#cb94-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>, </span>
<span id="cb94-53"><a href="#cb94-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(title)</span>
<span id="cb94-54"><a href="#cb94-54" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb94-55"><a href="#cb94-55" aria-hidden="true" tabindex="-1"></a>      <span class="fu">barplot</span>(</span>
<span id="cb94-56"><a href="#cb94-56" aria-hidden="true" tabindex="-1"></a>        n_bins_c_current,</span>
<span id="cb94-57"><a href="#cb94-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">"#0072B2"</span>, <span class="at">alpha.f =</span> .<span class="dv">3</span>),</span>
<span id="cb94-58"><a href="#cb94-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylim =</span> y_lim_bp,</span>
<span id="cb94-59"><a href="#cb94-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="st">"white"</span>,</span>
<span id="cb94-60"><a href="#cb94-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">axes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb94-61"><a href="#cb94-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">main =</span> <span class="st">""</span>,</span>
<span id="cb94-62"><a href="#cb94-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">add =</span> <span class="cn">TRUE</span></span>
<span id="cb94-63"><a href="#cb94-63" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb94-64"><a href="#cb94-64" aria-hidden="true" tabindex="-1"></a>      <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">4.1</span>, <span class="fl">4.3</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb94-65"><a href="#cb94-65" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot</span>(</span>
<span id="cb94-66"><a href="#cb94-66" aria-hidden="true" tabindex="-1"></a>        <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,</span>
<span id="cb94-67"><a href="#cb94-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="cn">NULL</span>,</span>
<span id="cb94-68"><a href="#cb94-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlim =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">ylim =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,</span>
<span id="cb94-69"><a href="#cb94-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">"Predicted probability"</span>, <span class="at">ylab =</span> <span class="st">"Mean predicted probability"</span>,</span>
<span id="cb94-70"><a href="#cb94-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">""</span></span>
<span id="cb94-71"><a href="#cb94-71" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb94-72"><a href="#cb94-72" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (i_simul <span class="cf">in</span> seeds) {</span>
<span id="cb94-73"><a href="#cb94-73" aria-hidden="true" tabindex="-1"></a>        tb_current <span class="ot">&lt;-</span> tb_calibration_curve <span class="sc">|&gt;</span> </span>
<span id="cb94-74"><a href="#cb94-74" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(</span>
<span id="cb94-75"><a href="#cb94-75" aria-hidden="true" tabindex="-1"></a>            scale_parameter <span class="sc">==</span> scale_param,</span>
<span id="cb94-76"><a href="#cb94-76" aria-hidden="true" tabindex="-1"></a>            seed <span class="sc">==</span> i_simul,</span>
<span id="cb94-77"><a href="#cb94-77" aria-hidden="true" tabindex="-1"></a>            sample <span class="sc">==</span> <span class="sc">!!</span>sample</span>
<span id="cb94-78"><a href="#cb94-78" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb94-79"><a href="#cb94-79" aria-hidden="true" tabindex="-1"></a>        <span class="fu">lines</span>(</span>
<span id="cb94-80"><a href="#cb94-80" aria-hidden="true" tabindex="-1"></a>          tb_current<span class="sc">$</span>mean_score, tb_current<span class="sc">$</span>mean_obs,</span>
<span id="cb94-81"><a href="#cb94-81" aria-hidden="true" tabindex="-1"></a>          <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="fu">adjustcolor</span>(colours[sample], <span class="at">alpha.f =</span> <span class="fl">0.1</span>), <span class="at">t =</span> <span class="st">"b"</span>,</span>
<span id="cb94-82"><a href="#cb94-82" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> .<span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">19</span></span>
<span id="cb94-83"><a href="#cb94-83" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb94-84"><a href="#cb94-84" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb94-85"><a href="#cb94-85" aria-hidden="true" tabindex="-1"></a>      <span class="fu">segments</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb94-86"><a href="#cb94-86" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb94-87"><a href="#cb94-87" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb94-88"><a href="#cb94-88" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The figures below show a panel of graphs with the superimposed calibration curves obtained with the quantile-based bins. Each tab shows the curves for a type of recalibration used. The first two tabs (<code>True Prob.</code> and <code>No Calibration</code>) show the curves obtained using the true probabilities <span class="math inline">\(p\)</span> and the uncalibrated probabilities <span class="math inline">\(p^u\)</span>, instead of the recalibrated probabilities <span class="math inline">\(p^c\)</span>. Each row of the panel in the Figures corresponds to a value for either <span class="math inline">\(\alpha\)</span> or <span class="math inline">\(\gamma\)</span> used to transform <span class="math inline">\(p\)</span> to get <span class="math inline">\(p^u\)</span>. The left column shows the calibration curve obtained on the calibration set whereas the right column shows the calibration curve obtained on the test set. The average distribution (computed over the 200 simulations) of the <span style="\&quot;color:#0000004D\&quot;">uncalibrated scores</span> and of the <span style="\&quot;color:#0072B24D\&quot;">calibrated scores</span> are shown in the histograms on top of each graph.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true">For <span class="math inline">\(\alpha\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false">For <span class="math inline">\(\gamma\)</span></a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">True Prob.</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">No Calibration</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-3" role="tab" aria-controls="tabset-12-3" aria-selected="false">Platt Scaling</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-4" role="tab" aria-controls="tabset-12-4" aria-selected="false">Isotonic Reg.</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-5" role="tab" aria-controls="tabset-12-5" aria-selected="false">Beta Calib.</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-6" role="tab" aria-controls="tabset-12-6" aria-selected="false">Local Reg. (deg = 0)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-7" role="tab" aria-controls="tabset-12-7" aria-selected="false">Local Reg. (deg = 1)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-8" role="tab" aria-controls="tabset-12-8" aria-selected="false">Local Reg (deg = 2)</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with quantile-defined bins for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-126-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with quantile-defined bins for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-127-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-12-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-3-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with quantile-defined bins for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-128-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-12-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-4-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with quantile-defined bins for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-129-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-12-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-5-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with quantile-defined bins for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-130-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-12-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-6-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with quantile-defined bins for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-131-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-12-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-7-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with quantile-defined bins for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-132-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-12-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-8-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with quantile-defined bins for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-133-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">True Prob.</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">No Calibration</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-3" role="tab" aria-controls="tabset-13-3" aria-selected="false">Platt Scaling</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-4" role="tab" aria-controls="tabset-13-4" aria-selected="false">Isotonic Reg.</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-5" role="tab" aria-controls="tabset-13-5" aria-selected="false">Beta Calib.</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-6" role="tab" aria-controls="tabset-13-6" aria-selected="false">Local Reg. (deg = 0)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-7" role="tab" aria-controls="tabset-13-7" aria-selected="false">Local Reg. (deg = 1)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-8" role="tab" aria-controls="tabset-13-8" aria-selected="false">Local Reg (deg = 2)</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with quantile-defined bins for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-134-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with quantile-defined bins for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-135-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-13-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-3-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with quantile-defined bins for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-136-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-13-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-4-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with quantile-defined bins for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-137-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-13-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-5-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with quantile-defined bins for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-138-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-13-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-6-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with quantile-defined bins for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-139-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-13-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-7-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with quantile-defined bins for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-140-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-13-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-8-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with quantile-defined bins for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span>.</figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-141-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Let us visualize the calibration curves in another way.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>plot_calib_quant_simuls <span class="ot">&lt;-</span> <span class="cf">function</span>(calib_curve, method) {</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  tb_calibration_curve_both <span class="ot">&lt;-</span> calib_curve <span class="sc">|&gt;</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>      method <span class="sc">==</span> <span class="sc">!!</span>method</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>  mat <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">13</span>, <span class="dv">15</span>,</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">14</span>, <span class="dv">16</span>,</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">17</span>, <span class="dv">19</span>,</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>    <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">18</span>, <span class="dv">20</span>,</span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>    <span class="dv">9</span>, <span class="dv">11</span>, <span class="dv">21</span>, <span class="dv">23</span>,</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>    <span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">22</span>, <span class="dv">24</span></span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(mat, <span class="at">height =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="dv">3</span>))</span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a>  y_lim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (type <span class="cf">in</span> <span class="fu">c</span>(<span class="st">"alpha"</span>, <span class="st">"gamma"</span>)) {</span>
<span id="cb95-22"><a href="#cb95-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb95-23"><a href="#cb95-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">"alpha"</span>) {</span>
<span id="cb95-24"><a href="#cb95-24" aria-hidden="true" tabindex="-1"></a>      count_scores <span class="ot">&lt;-</span> count_scores_alpha <span class="sc">|&gt;</span> <span class="fu">filter</span>(method <span class="sc">==</span> <span class="sc">!!</span>method)</span>
<span id="cb95-25"><a href="#cb95-25" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">"gamma"</span>) {</span>
<span id="cb95-26"><a href="#cb95-26" aria-hidden="true" tabindex="-1"></a>      count_scores <span class="ot">&lt;-</span> count_scores_gamma <span class="sc">|&gt;</span> <span class="fu">filter</span>(method <span class="sc">==</span> <span class="sc">!!</span>method)</span>
<span id="cb95-27"><a href="#cb95-27" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb95-28"><a href="#cb95-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stop</span>(<span class="st">"Type should be either </span><span class="sc">\"</span><span class="st">alpha</span><span class="sc">\"</span><span class="st"> or </span><span class="sc">\"</span><span class="st">gamma</span><span class="sc">\"</span><span class="st">"</span>)</span>
<span id="cb95-29"><a href="#cb95-29" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb95-30"><a href="#cb95-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb95-31"><a href="#cb95-31" aria-hidden="true" tabindex="-1"></a>    tb_calibration_curve <span class="ot">&lt;-</span></span>
<span id="cb95-32"><a href="#cb95-32" aria-hidden="true" tabindex="-1"></a>      tb_calibration_curve_both <span class="sc">|&gt;</span></span>
<span id="cb95-33"><a href="#cb95-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(type <span class="sc">==</span> <span class="sc">!!</span>type)</span>
<span id="cb95-34"><a href="#cb95-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb95-35"><a href="#cb95-35" aria-hidden="true" tabindex="-1"></a>    scale_params <span class="ot">&lt;-</span> <span class="fu">unique</span>(tb_calibration_curve<span class="sc">$</span>scale_parameter)</span>
<span id="cb95-36"><a href="#cb95-36" aria-hidden="true" tabindex="-1"></a>    seeds <span class="ot">&lt;-</span> <span class="fu">unique</span>(tb_calibration_curve<span class="sc">$</span>seed)</span>
<span id="cb95-37"><a href="#cb95-37" aria-hidden="true" tabindex="-1"></a>    colours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Calibration"</span> <span class="ot">=</span> <span class="st">"#D55E00"</span>, <span class="st">"Test"</span> <span class="ot">=</span> <span class="st">"#009E73"</span>)</span>
<span id="cb95-38"><a href="#cb95-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb95-39"><a href="#cb95-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (scale_param <span class="cf">in</span> scale_params) {</span>
<span id="cb95-40"><a href="#cb95-40" aria-hidden="true" tabindex="-1"></a>      title <span class="ot">&lt;-</span> <span class="fu">str_c</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">"</span>, type, <span class="st">" = $"</span>, <span class="fu">round</span>(scale_param, <span class="dv">2</span>))</span>
<span id="cb95-41"><a href="#cb95-41" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb95-42"><a href="#cb95-42" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (sample <span class="cf">in</span> <span class="fu">c</span>(<span class="st">"Calibration"</span>, <span class="st">"Test"</span>)) {</span>
<span id="cb95-43"><a href="#cb95-43" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb95-44"><a href="#cb95-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (sample <span class="sc">==</span> <span class="st">"Calibration"</span>){</span>
<span id="cb95-45"><a href="#cb95-45" aria-hidden="true" tabindex="-1"></a>          n_bins_current <span class="ot">&lt;-</span> count_scores <span class="sc">|&gt;</span></span>
<span id="cb95-46"><a href="#cb95-46" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(transform_scale <span class="sc">==</span> <span class="sc">!!</span>scale_param) <span class="sc">|&gt;</span> <span class="fu">pull</span>(<span class="st">"n_bins_calib"</span>)</span>
<span id="cb95-47"><a href="#cb95-47" aria-hidden="true" tabindex="-1"></a>          n_bins_c_current <span class="ot">&lt;-</span> count_scores <span class="sc">|&gt;</span></span>
<span id="cb95-48"><a href="#cb95-48" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(transform_scale <span class="sc">==</span> <span class="sc">!!</span>scale_param) <span class="sc">|&gt;</span> <span class="fu">pull</span>(<span class="st">"n_bins_c_calib"</span>)</span>
<span id="cb95-49"><a href="#cb95-49" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb95-50"><a href="#cb95-50" aria-hidden="true" tabindex="-1"></a>          n_bins_current <span class="ot">&lt;-</span> count_scores <span class="sc">|&gt;</span></span>
<span id="cb95-51"><a href="#cb95-51" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(transform_scale <span class="sc">==</span> <span class="sc">!!</span>scale_param) <span class="sc">|&gt;</span> <span class="fu">pull</span>(<span class="st">"n_bins_test"</span>)</span>
<span id="cb95-52"><a href="#cb95-52" aria-hidden="true" tabindex="-1"></a>          n_bins_c_current <span class="ot">&lt;-</span> count_scores <span class="sc">|&gt;</span></span>
<span id="cb95-53"><a href="#cb95-53" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(transform_scale <span class="sc">==</span> <span class="sc">!!</span>scale_param) <span class="sc">|&gt;</span> <span class="fu">pull</span>(<span class="st">"n_bins_c_test"</span>)</span>
<span id="cb95-54"><a href="#cb95-54" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb95-55"><a href="#cb95-55" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb95-56"><a href="#cb95-56" aria-hidden="true" tabindex="-1"></a>        <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">4.3</span>, <span class="fl">1.0</span>, <span class="fl">0.5</span>))</span>
<span id="cb95-57"><a href="#cb95-57" aria-hidden="true" tabindex="-1"></a>        y_lim_bp <span class="ot">&lt;-</span> <span class="fu">range</span>(<span class="fu">c</span>(n_bins_current, n_bins_c_current), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb95-58"><a href="#cb95-58" aria-hidden="true" tabindex="-1"></a>        <span class="fu">barplot</span>(</span>
<span id="cb95-59"><a href="#cb95-59" aria-hidden="true" tabindex="-1"></a>          n_bins_current,</span>
<span id="cb95-60"><a href="#cb95-60" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">"#000000"</span>, <span class="at">alpha.f =</span> .<span class="dv">3</span>),</span>
<span id="cb95-61"><a href="#cb95-61" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylim =</span> y_lim_bp,</span>
<span id="cb95-62"><a href="#cb95-62" aria-hidden="true" tabindex="-1"></a>          <span class="at">border =</span> <span class="st">"white"</span>,</span>
<span id="cb95-63"><a href="#cb95-63" aria-hidden="true" tabindex="-1"></a>          <span class="at">axes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb95-64"><a href="#cb95-64" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb95-65"><a href="#cb95-65" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(title)</span>
<span id="cb95-66"><a href="#cb95-66" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb95-67"><a href="#cb95-67" aria-hidden="true" tabindex="-1"></a>        <span class="fu">barplot</span>(</span>
<span id="cb95-68"><a href="#cb95-68" aria-hidden="true" tabindex="-1"></a>          n_bins_c_current,</span>
<span id="cb95-69"><a href="#cb95-69" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">"#0072B2"</span>, <span class="at">alpha.f =</span> .<span class="dv">3</span>),</span>
<span id="cb95-70"><a href="#cb95-70" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylim =</span> y_lim_bp,</span>
<span id="cb95-71"><a href="#cb95-71" aria-hidden="true" tabindex="-1"></a>          <span class="at">border =</span> <span class="st">"white"</span>,</span>
<span id="cb95-72"><a href="#cb95-72" aria-hidden="true" tabindex="-1"></a>          <span class="at">axes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb95-73"><a href="#cb95-73" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">main =</span> <span class="st">""</span>,</span>
<span id="cb95-74"><a href="#cb95-74" aria-hidden="true" tabindex="-1"></a>          <span class="at">add =</span> <span class="cn">TRUE</span></span>
<span id="cb95-75"><a href="#cb95-75" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb95-76"><a href="#cb95-76" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb95-77"><a href="#cb95-77" aria-hidden="true" tabindex="-1"></a>        tb_current <span class="ot">&lt;-</span></span>
<span id="cb95-78"><a href="#cb95-78" aria-hidden="true" tabindex="-1"></a>          tb_calibration_curve <span class="sc">|&gt;</span></span>
<span id="cb95-79"><a href="#cb95-79" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(</span>
<span id="cb95-80"><a href="#cb95-80" aria-hidden="true" tabindex="-1"></a>            scale_parameter <span class="sc">==</span> <span class="sc">!!</span>scale_param,</span>
<span id="cb95-81"><a href="#cb95-81" aria-hidden="true" tabindex="-1"></a>            sample <span class="sc">==</span> <span class="sc">!!</span>sample</span>
<span id="cb95-82"><a href="#cb95-82" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb95-83"><a href="#cb95-83" aria-hidden="true" tabindex="-1"></a>        <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">4.1</span>, <span class="fl">4.3</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb95-84"><a href="#cb95-84" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plot</span>(</span>
<span id="cb95-85"><a href="#cb95-85" aria-hidden="true" tabindex="-1"></a>          <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,</span>
<span id="cb95-86"><a href="#cb95-86" aria-hidden="true" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="cn">NULL</span>,</span>
<span id="cb95-87"><a href="#cb95-87" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlim =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">ylim =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,</span>
<span id="cb95-88"><a href="#cb95-88" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$p^u$"</span>), </span>
<span id="cb95-89"><a href="#cb95-89" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$E(D | p^u = p^c)$"</span>),</span>
<span id="cb95-90"><a href="#cb95-90" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">""</span></span>
<span id="cb95-91"><a href="#cb95-91" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb95-92"><a href="#cb95-92" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (i_simul <span class="cf">in</span> seeds) {</span>
<span id="cb95-93"><a href="#cb95-93" aria-hidden="true" tabindex="-1"></a>          tb_current <span class="ot">&lt;-</span> tb_calibration_curve <span class="sc">|&gt;</span> </span>
<span id="cb95-94"><a href="#cb95-94" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(</span>
<span id="cb95-95"><a href="#cb95-95" aria-hidden="true" tabindex="-1"></a>              scale_parameter <span class="sc">==</span> scale_param,</span>
<span id="cb95-96"><a href="#cb95-96" aria-hidden="true" tabindex="-1"></a>              seed <span class="sc">==</span> i_simul,</span>
<span id="cb95-97"><a href="#cb95-97" aria-hidden="true" tabindex="-1"></a>              sample <span class="sc">==</span> <span class="sc">!!</span>sample</span>
<span id="cb95-98"><a href="#cb95-98" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb95-99"><a href="#cb95-99" aria-hidden="true" tabindex="-1"></a>          <span class="fu">lines</span>(</span>
<span id="cb95-100"><a href="#cb95-100" aria-hidden="true" tabindex="-1"></a>            tb_current<span class="sc">$</span>mean_score, tb_current<span class="sc">$</span>mean_obs,</span>
<span id="cb95-101"><a href="#cb95-101" aria-hidden="true" tabindex="-1"></a>            <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="fu">adjustcolor</span>(colours[sample], <span class="at">alpha.f =</span> <span class="fl">0.1</span>), <span class="at">t =</span> <span class="st">"b"</span>,</span>
<span id="cb95-102"><a href="#cb95-102" aria-hidden="true" tabindex="-1"></a>            <span class="at">cex =</span> .<span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">19</span></span>
<span id="cb95-103"><a href="#cb95-103" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb95-104"><a href="#cb95-104" aria-hidden="true" tabindex="-1"></a>          <span class="fu">segments</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb95-105"><a href="#cb95-105" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb95-106"><a href="#cb95-106" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb95-107"><a href="#cb95-107" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb95-108"><a href="#cb95-108" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb95-109"><a href="#cb95-109" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"True Prob."</span>, </span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"No Calibration"</span>,</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"platt"</span>, <span class="st">"isotonic"</span>, <span class="st">"beta"</span>, </span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"locfit_0"</span>, <span class="st">"locfit_1"</span>, <span class="st">"locfit_2"</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>methods_labs <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"True Prob."</span>,</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"No Calibration"</span>, <span class="st">"Platt"</span>, <span class="st">"Isotonic"</span>, <span class="st">"Beta"</span>, </span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Locfit (deg=0)"</span>, <span class="st">"Locfit (deg=1)"</span>, <span class="st">"Locfit (deg=2)"</span></span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true">True Prob.</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false">No Calibration</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-3" role="tab" aria-controls="tabset-15-3" aria-selected="false">Platt</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-4" role="tab" aria-controls="tabset-15-4" aria-selected="false">Isotonic</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-5" role="tab" aria-controls="tabset-15-5" aria-selected="false">Beta</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-6" role="tab" aria-controls="tabset-15-6" aria-selected="false">Locfit (deg=0)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-7" role="tab" aria-controls="tabset-15-7" aria-selected="false">Locfit (deg=1)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-8" role="tab" aria-controls="tabset-15-8" aria-selected="false">Locfit (deg=2)</a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_calib_quant_simuls</span>(</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">calib_curve =</span> summary_bins_simuls <span class="sc">|&gt;</span> </span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(scale_parameter <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>)), </span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"True Prob."</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-recalib-simuls-calib-curve-quant-trueprob" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.19: Calibration Curves Calculated with True Probabilities as the Scores. The curves are obtained with quantile binning, for the calibration set (orange) and for the test set (green) for varying values of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\gamma\)</span>. The curves of the 200 replications of the simulations are superimposed. The histogram on top of each graph show the distribution of the true probabilities</figcaption>
<p><img src="recalibration_files/figure-html/fig-recalib-simuls-calib-curve-quant-trueprob-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_calib_quant_simuls</span>(</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">calib_curve =</span> summary_bins_simuls <span class="sc">|&gt;</span> </span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(scale_parameter <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>)), </span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"No Calibration"</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-recalib-simuls-calib-curve-quant-nocalib" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.20: Calibration Curves Calculated with Uncalibrated Scores. The curves are obtained with quantile binning, for the calibration set (orange) and for the test set (green) for varying values of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\gamma\)</span>. The curves of the 200 replications of the simulations are superimposed. The histogram on top of each graph show the distribution of the true probabilities.</figcaption>
<p><img src="recalibration_files/figure-html/fig-recalib-simuls-calib-curve-quant-nocalib-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-15-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_calib_quant_simuls</span>(</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">calib_curve =</span> summary_bins_simuls <span class="sc">|&gt;</span> </span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(scale_parameter <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>)), </span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"platt"</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-recalib-simuls-calib-curve-quant-platt" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.21: Calibration Curves Calculated with Scores Recalibrated Using Platt Scaling. The curves are obtained with quantile binning, for the calibration set (orange) and for the test set (green) for varying values of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\gamma\)</span>. The curves of the 200 replications of the simulations are superimposed. The histogram on top of each graph show the distribution of the uncalibrated scores (gray), and that of the calibrated scores (blue).</figcaption>
<p><img src="recalibration_files/figure-html/fig-recalib-simuls-calib-curve-quant-platt-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-15-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_calib_quant_simuls</span>(</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">calib_curve =</span> summary_bins_simuls <span class="sc">|&gt;</span> </span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(scale_parameter <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>)), </span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"isotonic"</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-recalib-simuls-calib-curve-quant-isotonic" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.22: Calibration Curves Calculated with Scores Recalibrated Using Isotonic Regression. The curves are obtained with quantile binning, for the calibration set (orange) and for the test set (green) for varying values of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\gamma\)</span>. The curves of the 200 replications of the simulations are superimposed. The histogram on top of each graph show the distribution of the uncalibrated scores (gray), and that of the calibrated scores (blue).</figcaption>
<p><img src="recalibration_files/figure-html/fig-recalib-simuls-calib-curve-quant-isotonic-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-15-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_calib_quant_simuls</span>(</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">calib_curve =</span> summary_bins_simuls <span class="sc">|&gt;</span> </span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(scale_parameter <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>)), </span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"beta"</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-recalib-simuls-calib-curve-quant-beta" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.23: Calibration Curves Calculated with Scores Recalibrated Using Beta Calibration. The curves are obtained with quantile binning, for the calibration set (orange) and for the test set (green) for varying values of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\gamma\)</span>. The curves of the 200 replications of the simulations are superimposed. The histogram on top of each graph show the distribution of the uncalibrated scores (gray), and that of the calibrated scores (blue).</figcaption>
<p><img src="recalibration_files/figure-html/fig-recalib-simuls-calib-curve-quant-beta-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-15-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-6-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_calib_quant_simuls</span>(</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">calib_curve =</span> summary_bins_simuls <span class="sc">|&gt;</span> </span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(scale_parameter <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>)), </span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"locfit_0"</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-recalib-simuls-calib-curve-quant-locfit0" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.24: Calibration Curves Calculated with Scores Recalibrated Using Local Regression (with degree 0). The curves are obtained with quantile binning, for the calibration set (orange) and for the test set (green) for varying values of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\gamma\)</span>. The curves of the 200 replications of the simulations are superimposed. The histogram on top of each graph show the distribution of the uncalibrated scores (gray), and that of the calibrated scores (blue).</figcaption>
<p><img src="recalibration_files/figure-html/fig-recalib-simuls-calib-curve-quant-locfit0-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-15-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-7-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_calib_quant_simuls</span>(</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">calib_curve =</span> summary_bins_simuls <span class="sc">|&gt;</span> </span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(scale_parameter <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>)), </span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"locfit_1"</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-recalib-simuls-calib-curve-quant-locfit1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.25: Calibration Curves Calculated with Scores Recalibrated Using Local Regression (with degree 1). The curves are obtained with quantile binning, for the calibration set (orange) and for the test set (green) for varying values of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\gamma\)</span>. The curves of the 200 replications of the simulations are superimposed. The histogram on top of each graph show the distribution of the uncalibrated scores (gray), and that of the calibrated scores (blue).</figcaption>
<p><img src="recalibration_files/figure-html/fig-recalib-simuls-calib-curve-quant-locfit1-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-15-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-8-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_calib_quant_simuls</span>(</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">calib_curve =</span> summary_bins_simuls <span class="sc">|&gt;</span> </span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(scale_parameter <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>)), </span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"locfit_2"</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-recalib-simuls-calib-curve-quant-locfit2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.26: Calibration Curves Calculated with Scores Recalibrated Using Local Regression (with degree 2). The curves are obtained with quantile binning, for the calibration set (orange) and for the test set (green) for varying values of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\gamma\)</span>. The curves of the 200 replications of the simulations are superimposed. The histogram on top of each graph show the distribution of the uncalibrated scores (gray), and that of the calibrated scores (blue).</figcaption>
<p><img src="recalibration_files/figure-html/fig-recalib-simuls-calib-curve-quant-locfit2-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="calibration-curve-with-local-regression" class="level3" data-number="2.7.2">
<h3 data-number="2.7.2" class="anchored" data-anchor-id="calibration-curve-with-local-regression"><span class="header-section-number">2.7.2</span> Calibration Curve with Local Regression</h3>
<p>We will plot the calibration curves estimated using the local regression method, for all type of transformation of the probabilities made (varying either <span class="math inline">\(\alpha\)</span> or <span class="math inline">\(\gamma\)</span>).</p>
<p>Contrary to the quantile-based calibration curve, we can make predictions on a segment from 0 to 1 using the fitted local regression.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>calibration_curve_locfit_simul <span class="ot">&lt;-</span> <span class="cf">function</span>(simul, </span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>                                           method, </span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">k =</span> <span class="dv">10</span>) {</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>  obs_calib <span class="ot">&lt;-</span> simul<span class="sc">$</span>data_all_calib<span class="sc">$</span>d</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>  obs_test <span class="ot">&lt;-</span> simul<span class="sc">$</span>data_all_test<span class="sc">$</span>d</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (method <span class="sc">==</span> <span class="st">"True Prob."</span>) {</span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>    scores_calib <span class="ot">&lt;-</span> simul<span class="sc">$</span>data_all_calib<span class="sc">$</span>p</span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>    scores_test <span class="ot">&lt;-</span> simul<span class="sc">$</span>data_all_test<span class="sc">$</span>p</span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (method <span class="sc">==</span> <span class="st">"No Calibration"</span>) {</span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>    scores_calib <span class="ot">&lt;-</span> simul<span class="sc">$</span>data_all_calib<span class="sc">$</span>p_u</span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a>    scores_test <span class="ot">&lt;-</span> simul<span class="sc">$</span>data_all_test<span class="sc">$</span>p_u</span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a>    tb_score_c_calib <span class="ot">&lt;-</span> simul<span class="sc">$</span>res_recalibration[[method]]<span class="sc">$</span>tb_score_c_calib</span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a>    tb_score_c_test <span class="ot">&lt;-</span> simul<span class="sc">$</span>res_recalibration[[method]]<span class="sc">$</span>tb_score_c_test</span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a>    scores_calib <span class="ot">&lt;-</span> tb_score_c_calib<span class="sc">$</span>p_c</span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a>    scores_test <span class="ot">&lt;-</span> tb_score_c_test<span class="sc">$</span>p_c</span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb105-21"><a href="#cb105-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-22"><a href="#cb105-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add a little noise (otherwise, R may crash...)</span></span>
<span id="cb105-23"><a href="#cb105-23" aria-hidden="true" tabindex="-1"></a>  scores_calib <span class="ot">&lt;-</span> scores_calib <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(scores_calib), <span class="dv">0</span>, .<span class="dv">001</span>)</span>
<span id="cb105-24"><a href="#cb105-24" aria-hidden="true" tabindex="-1"></a>  scores_test <span class="ot">&lt;-</span> scores_test <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(scores_test), <span class="dv">0</span>, .<span class="dv">001</span>)</span>
<span id="cb105-25"><a href="#cb105-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-26"><a href="#cb105-26" aria-hidden="true" tabindex="-1"></a>  tb_calib <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb105-27"><a href="#cb105-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">obs =</span> obs_calib,</span>
<span id="cb105-28"><a href="#cb105-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">scores =</span> scores_calib</span>
<span id="cb105-29"><a href="#cb105-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb105-30"><a href="#cb105-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-31"><a href="#cb105-31" aria-hidden="true" tabindex="-1"></a>  tb_test <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb105-32"><a href="#cb105-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">obs =</span> obs_test,</span>
<span id="cb105-33"><a href="#cb105-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">scores =</span> scores_test</span>
<span id="cb105-34"><a href="#cb105-34" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb105-35"><a href="#cb105-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-36"><a href="#cb105-36" aria-hidden="true" tabindex="-1"></a>  locfit_0_calib <span class="ot">&lt;-</span> <span class="fu">locfit</span>(</span>
<span id="cb105-37"><a href="#cb105-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> obs <span class="sc">~</span> <span class="fu">lp</span>(scores, <span class="at">nn =</span> <span class="fl">0.15</span>, <span class="at">deg =</span> <span class="dv">0</span>), </span>
<span id="cb105-38"><a href="#cb105-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">kern =</span> <span class="st">"rect"</span>, <span class="at">maxk =</span> <span class="dv">200</span>, <span class="at">data =</span> tb_calib</span>
<span id="cb105-39"><a href="#cb105-39" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb105-40"><a href="#cb105-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-41"><a href="#cb105-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Predictions on [0,1]</span></span>
<span id="cb105-42"><a href="#cb105-42" aria-hidden="true" tabindex="-1"></a>  linspace_raw <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb105-43"><a href="#cb105-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-44"><a href="#cb105-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Restricting this space to the range of observed scores</span></span>
<span id="cb105-45"><a href="#cb105-45" aria-hidden="true" tabindex="-1"></a>  keep_linspace_calib <span class="ot">&lt;-</span> <span class="fu">which</span>(</span>
<span id="cb105-46"><a href="#cb105-46" aria-hidden="true" tabindex="-1"></a>    linspace_raw <span class="sc">&gt;=</span> <span class="fu">min</span>(scores_calib) <span class="sc">&amp;</span> linspace_raw <span class="sc">&lt;=</span> <span class="fu">max</span>(scores_calib)</span>
<span id="cb105-47"><a href="#cb105-47" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb105-48"><a href="#cb105-48" aria-hidden="true" tabindex="-1"></a>  linspace_calib <span class="ot">&lt;-</span> linspace_raw[keep_linspace_calib]</span>
<span id="cb105-49"><a href="#cb105-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-50"><a href="#cb105-50" aria-hidden="true" tabindex="-1"></a>  score_c_locfit_0_calib <span class="ot">&lt;-</span> <span class="fu">predict</span>(locfit_0_calib, <span class="at">newdata =</span> linspace_calib)</span>
<span id="cb105-51"><a href="#cb105-51" aria-hidden="true" tabindex="-1"></a>  score_c_locfit_0_calib[score_c_locfit_0_calib <span class="sc">&lt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb105-52"><a href="#cb105-52" aria-hidden="true" tabindex="-1"></a>  score_c_locfit_0_calib[score_c_locfit_0_calib <span class="sc">&gt;</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb105-53"><a href="#cb105-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-54"><a href="#cb105-54" aria-hidden="true" tabindex="-1"></a>  locfit_0_test <span class="ot">&lt;-</span> <span class="fu">locfit</span>(</span>
<span id="cb105-55"><a href="#cb105-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> obs <span class="sc">~</span> <span class="fu">lp</span>(scores, <span class="at">nn =</span> <span class="fl">0.15</span>, <span class="at">deg =</span> <span class="dv">0</span>), </span>
<span id="cb105-56"><a href="#cb105-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">kern =</span> <span class="st">"rect"</span>, <span class="at">maxk =</span> <span class="dv">200</span>, <span class="at">data =</span> tb_test</span>
<span id="cb105-57"><a href="#cb105-57" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb105-58"><a href="#cb105-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-59"><a href="#cb105-59" aria-hidden="true" tabindex="-1"></a>  keep_linspace_test <span class="ot">&lt;-</span> <span class="fu">which</span>(</span>
<span id="cb105-60"><a href="#cb105-60" aria-hidden="true" tabindex="-1"></a>    linspace_raw <span class="sc">&gt;=</span> <span class="fu">min</span>(scores_test) <span class="sc">&amp;</span> linspace_raw <span class="sc">&lt;=</span> <span class="fu">max</span>(scores_test)</span>
<span id="cb105-61"><a href="#cb105-61" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb105-62"><a href="#cb105-62" aria-hidden="true" tabindex="-1"></a>  linspace_test <span class="ot">&lt;-</span> linspace_raw[keep_linspace_test]</span>
<span id="cb105-63"><a href="#cb105-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-64"><a href="#cb105-64" aria-hidden="true" tabindex="-1"></a>  score_c_locfit_0_test <span class="ot">&lt;-</span> <span class="fu">predict</span>(locfit_0_test, <span class="at">newdata =</span> linspace_test)</span>
<span id="cb105-65"><a href="#cb105-65" aria-hidden="true" tabindex="-1"></a>  score_c_locfit_0_test[score_c_locfit_0_test <span class="sc">&lt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb105-66"><a href="#cb105-66" aria-hidden="true" tabindex="-1"></a>  score_c_locfit_0_test[score_c_locfit_0_test <span class="sc">&gt;</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb105-67"><a href="#cb105-67" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-68"><a href="#cb105-68" aria-hidden="true" tabindex="-1"></a>  tb_calibration_curve_locfit <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb105-69"><a href="#cb105-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlim =</span> linspace_calib,</span>
<span id="cb105-70"><a href="#cb105-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">locfit_pred =</span> score_c_locfit_0_calib,</span>
<span id="cb105-71"><a href="#cb105-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> method,</span>
<span id="cb105-72"><a href="#cb105-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> simul<span class="sc">$</span>seed,</span>
<span id="cb105-73"><a href="#cb105-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample =</span> <span class="st">"calibration"</span></span>
<span id="cb105-74"><a href="#cb105-74" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb105-75"><a href="#cb105-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(</span>
<span id="cb105-76"><a href="#cb105-76" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tibble</span>(</span>
<span id="cb105-77"><a href="#cb105-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlim =</span> linspace_test,</span>
<span id="cb105-78"><a href="#cb105-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">locfit_pred =</span> score_c_locfit_0_test,</span>
<span id="cb105-79"><a href="#cb105-79" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> method,</span>
<span id="cb105-80"><a href="#cb105-80" aria-hidden="true" tabindex="-1"></a>        <span class="at">seed =</span> simul<span class="sc">$</span>seed,</span>
<span id="cb105-81"><a href="#cb105-81" aria-hidden="true" tabindex="-1"></a>        <span class="at">sample =</span> <span class="st">"test"</span></span>
<span id="cb105-82"><a href="#cb105-82" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb105-83"><a href="#cb105-83" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb105-84"><a href="#cb105-84" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-85"><a href="#cb105-85" aria-hidden="true" tabindex="-1"></a>  tb_calibration_curve_locfit</span>
<span id="cb105-86"><a href="#cb105-86" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us loop over all the methods and all the replications for each value of <span class="math inline">\(\alpha\)</span> to get the calibration curves based on local regression.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For alpha</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">names</span>(simul_recalib_alpha[[<span class="dv">1</span>]]<span class="sc">$</span>res_recalibration)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"True Prob."</span>, <span class="st">"No Calibration"</span>, methods)</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>calib_curve_locfit_simuls_alpha <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"list"</span>, <span class="at">length =</span> <span class="fu">length</span>(methods))</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(calib_curve_locfit_simuls_alpha) <span class="ot">&lt;-</span> methods</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(future)</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>nb_cores <span class="ot">&lt;-</span> future<span class="sc">::</span><span class="fu">availableCores</span>()<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> nb_cores)</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(methods)) {</span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>  progressr<span class="sc">::</span><span class="fu">with_progress</span>({</span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> progressr<span class="sc">::</span><span class="fu">progressor</span>(<span class="at">steps =</span> <span class="fu">nrow</span>(grid_alpha))</span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a>    calib_curve_locfit_simuls_m <span class="ot">&lt;-</span> furrr<span class="sc">::</span><span class="fu">future_map</span>(</span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">.x =</span> simul_recalib_alpha,</span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">.f =</span> <span class="sc">~</span>{</span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">p</span>()</span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">calibration_curve_locfit_simul</span>(</span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">simul =</span> .x, <span class="at">method =</span> methods[i_method], <span class="at">k =</span> <span class="dv">10</span></span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb106-20"><a href="#cb106-20" aria-hidden="true" tabindex="-1"></a>      },</span>
<span id="cb106-21"><a href="#cb106-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">.options =</span> furrr<span class="sc">::</span><span class="fu">furrr_options</span>(<span class="at">seed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb106-22"><a href="#cb106-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb106-23"><a href="#cb106-23" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb106-24"><a href="#cb106-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add value for alpha</span></span>
<span id="cb106-25"><a href="#cb106-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(calib_curve_locfit_simuls_m)) {</span>
<span id="cb106-26"><a href="#cb106-26" aria-hidden="true" tabindex="-1"></a>    calib_curve_locfit_simuls_m[[j]]<span class="sc">$</span>scale_parameter <span class="ot">&lt;-</span> grid_alpha<span class="sc">$</span>alpha[j]</span>
<span id="cb106-27"><a href="#cb106-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb106-28"><a href="#cb106-28" aria-hidden="true" tabindex="-1"></a>  calib_curve_locfit_simuls_alpha[[i_method]] <span class="ot">&lt;-</span> calib_curve_locfit_simuls_m <span class="sc">|&gt;</span> </span>
<span id="cb106-29"><a href="#cb106-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list_rbind</span>(<span class="at">names_to =</span> <span class="st">"i_row"</span>)</span>
<span id="cb106-30"><a href="#cb106-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb106-31"><a href="#cb106-31" aria-hidden="true" tabindex="-1"></a>calib_curve_locfit_simuls_alpha <span class="ot">&lt;-</span> <span class="fu">list_rbind</span>(</span>
<span id="cb106-32"><a href="#cb106-32" aria-hidden="true" tabindex="-1"></a>  calib_curve_locfit_simuls_alpha, <span class="at">names_to =</span> <span class="st">"method"</span></span>
<span id="cb106-33"><a href="#cb106-33" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb106-34"><a href="#cb106-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="st">"alpha"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us loop over the simulations made with varying values for <span class="math inline">\(\gamma\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For gamma</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">names</span>(simul_recalib_gamma[[<span class="dv">1</span>]]<span class="sc">$</span>res_recalibration)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove isotonic which makes the R session crash...</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"True Prob."</span>, <span class="st">"No Calibration"</span>, methods)</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>calib_curve_locfit_simuls_gamma <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"list"</span>, <span class="at">length =</span> <span class="fu">length</span>(methods))</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(calib_curve_locfit_simuls_gamma) <span class="ot">&lt;-</span> methods</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(future)</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>nb_cores <span class="ot">&lt;-</span> future<span class="sc">::</span><span class="fu">availableCores</span>()<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> nb_cores)</span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(methods)) {</span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>  progressr<span class="sc">::</span><span class="fu">with_progress</span>({</span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> progressr<span class="sc">::</span><span class="fu">progressor</span>(<span class="at">steps =</span> <span class="fu">nrow</span>(grid_gamma))</span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a>    calib_curve_locfit_simuls_m <span class="ot">&lt;-</span> furrr<span class="sc">::</span><span class="fu">future_map</span>(</span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">.x =</span> simul_recalib_gamma,</span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">.f =</span> <span class="sc">~</span>{</span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">p</span>()</span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">calibration_curve_locfit_simul</span>(</span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">simul =</span> .x, <span class="at">method =</span> methods[i_method], <span class="at">k =</span> <span class="dv">10</span></span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb107-21"><a href="#cb107-21" aria-hidden="true" tabindex="-1"></a>      },</span>
<span id="cb107-22"><a href="#cb107-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">.options =</span> furrr<span class="sc">::</span><span class="fu">furrr_options</span>(<span class="at">seed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb107-23"><a href="#cb107-23" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb107-24"><a href="#cb107-24" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb107-25"><a href="#cb107-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add value for alpha</span></span>
<span id="cb107-26"><a href="#cb107-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(calib_curve_locfit_simuls_m)) {</span>
<span id="cb107-27"><a href="#cb107-27" aria-hidden="true" tabindex="-1"></a>    calib_curve_locfit_simuls_m[[j]]<span class="sc">$</span>scale_parameter <span class="ot">&lt;-</span> grid_gamma<span class="sc">$</span>gamma[j]</span>
<span id="cb107-28"><a href="#cb107-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb107-29"><a href="#cb107-29" aria-hidden="true" tabindex="-1"></a>  calib_curve_locfit_simuls_gamma[[i_method]] <span class="ot">&lt;-</span> calib_curve_locfit_simuls_m <span class="sc">|&gt;</span> </span>
<span id="cb107-30"><a href="#cb107-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list_rbind</span>(<span class="at">names_to =</span> <span class="st">"i_row"</span>)</span>
<span id="cb107-31"><a href="#cb107-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-32"><a href="#cb107-32" aria-hidden="true" tabindex="-1"></a>calib_curve_locfit_simuls_gamma <span class="ot">&lt;-</span> <span class="fu">list_rbind</span>(</span>
<span id="cb107-33"><a href="#cb107-33" aria-hidden="true" tabindex="-1"></a>  calib_curve_locfit_simuls_gamma, <span class="at">names_to =</span> <span class="st">"method"</span></span>
<span id="cb107-34"><a href="#cb107-34" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb107-35"><a href="#cb107-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="st">"gamma"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The results are stored in a single tibble:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>calib_curve_locfit_simuls <span class="ot">&lt;-</span> </span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>  calib_curve_locfit_simuls_alpha <span class="sc">|&gt;</span> </span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(calib_curve_locfit_simuls_gamma) <span class="sc">|&gt;</span> </span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample =</span> <span class="fu">factor</span>(</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>      sample, </span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"calibration"</span>, <span class="st">"test"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Calibration"</span>, <span class="st">"Test"</span>)</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us define a function to plot the calibration curves on the calibration and the test samples.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>plot_calib_locfit_simuls <span class="ot">&lt;-</span> <span class="cf">function</span>(method, type) {</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  tb_calibration_curve <span class="ot">&lt;-</span> calib_curve_locfit_simuls <span class="sc">|&gt;</span> </span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>      method <span class="sc">==</span> <span class="sc">!!</span>method,</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>      type <span class="sc">==</span> <span class="sc">!!</span>type</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">"alpha"</span>) {</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>    count_scores <span class="ot">&lt;-</span> count_scores_alpha <span class="sc">|&gt;</span> <span class="fu">filter</span>(method <span class="sc">==</span> <span class="sc">!!</span>method)</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">"gamma"</span>) {</span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>    count_scores <span class="ot">&lt;-</span> count_scores_gamma <span class="sc">|&gt;</span> <span class="fu">filter</span>(method <span class="sc">==</span> <span class="sc">!!</span>method)</span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Type should be either alpha or gamma"</span>)</span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a>  scale_params <span class="ot">&lt;-</span> <span class="fu">unique</span>(tb_calibration_curve<span class="sc">$</span>scale_parameter)</span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a>  seeds <span class="ot">&lt;-</span> <span class="fu">unique</span>(tb_calibration_curve<span class="sc">$</span>seed)</span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a>  colours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Calibration"</span> <span class="ot">=</span> <span class="st">"#D55E00"</span>, <span class="st">"Test"</span> <span class="ot">=</span> <span class="st">"#009E73"</span>)</span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb109-19"><a href="#cb109-19" aria-hidden="true" tabindex="-1"></a>  nb <span class="ot">&lt;-</span> <span class="fu">length</span>(scale_params)</span>
<span id="cb109-20"><a href="#cb109-20" aria-hidden="true" tabindex="-1"></a>  mat <span class="ot">&lt;-</span> mat_init <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb109-21"><a href="#cb109-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(nb<span class="dv">-1</span>)) {</span>
<span id="cb109-22"><a href="#cb109-22" aria-hidden="true" tabindex="-1"></a>    mat <span class="ot">&lt;-</span> <span class="fu">rbind</span>(mat, mat_init <span class="sc">+</span> j <span class="sc">*</span> <span class="dv">4</span>)</span>
<span id="cb109-23"><a href="#cb109-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb109-24"><a href="#cb109-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(mat, <span class="at">heights =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), nb))</span>
<span id="cb109-25"><a href="#cb109-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb109-26"><a href="#cb109-26" aria-hidden="true" tabindex="-1"></a>  y_lim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb109-27"><a href="#cb109-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb109-28"><a href="#cb109-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (scale_param <span class="cf">in</span> scale_params) {</span>
<span id="cb109-29"><a href="#cb109-29" aria-hidden="true" tabindex="-1"></a>    title <span class="ot">&lt;-</span> <span class="fu">str_c</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">"</span>, type, <span class="st">" = $"</span>, <span class="fu">round</span>(scale_param, <span class="dv">2</span>))</span>
<span id="cb109-30"><a href="#cb109-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb109-31"><a href="#cb109-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (sample <span class="cf">in</span> <span class="fu">c</span>(<span class="st">"Calibration"</span>, <span class="st">"Test"</span>)) {</span>
<span id="cb109-32"><a href="#cb109-32" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb109-33"><a href="#cb109-33" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (sample <span class="sc">==</span> <span class="st">"Calibration"</span>){</span>
<span id="cb109-34"><a href="#cb109-34" aria-hidden="true" tabindex="-1"></a>        n_bins_current <span class="ot">&lt;-</span> count_scores <span class="sc">|&gt;</span> </span>
<span id="cb109-35"><a href="#cb109-35" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(transform_scale <span class="sc">==</span> <span class="sc">!!</span>scale_param) <span class="sc">|&gt;</span> <span class="fu">pull</span>(<span class="st">"n_bins_calib"</span>)</span>
<span id="cb109-36"><a href="#cb109-36" aria-hidden="true" tabindex="-1"></a>        n_bins_c_current <span class="ot">&lt;-</span> count_scores <span class="sc">|&gt;</span> </span>
<span id="cb109-37"><a href="#cb109-37" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(transform_scale <span class="sc">==</span> <span class="sc">!!</span>scale_param) <span class="sc">|&gt;</span> <span class="fu">pull</span>(<span class="st">"n_bins_c_calib"</span>)</span>
<span id="cb109-38"><a href="#cb109-38" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb109-39"><a href="#cb109-39" aria-hidden="true" tabindex="-1"></a>        n_bins_current <span class="ot">&lt;-</span> count_scores <span class="sc">|&gt;</span> </span>
<span id="cb109-40"><a href="#cb109-40" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(transform_scale <span class="sc">==</span> <span class="sc">!!</span>scale_param) <span class="sc">|&gt;</span> <span class="fu">pull</span>(<span class="st">"n_bins_test"</span>)</span>
<span id="cb109-41"><a href="#cb109-41" aria-hidden="true" tabindex="-1"></a>        n_bins_c_current <span class="ot">&lt;-</span> count_scores <span class="sc">|&gt;</span> </span>
<span id="cb109-42"><a href="#cb109-42" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(transform_scale <span class="sc">==</span> <span class="sc">!!</span>scale_param) <span class="sc">|&gt;</span> <span class="fu">pull</span>(<span class="st">"n_bins_c_test"</span>)</span>
<span id="cb109-43"><a href="#cb109-43" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb109-44"><a href="#cb109-44" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb109-45"><a href="#cb109-45" aria-hidden="true" tabindex="-1"></a>      <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">4.3</span>, <span class="fl">1.0</span>, <span class="fl">0.5</span>))</span>
<span id="cb109-46"><a href="#cb109-46" aria-hidden="true" tabindex="-1"></a>      y_lim_bp <span class="ot">&lt;-</span> <span class="fu">range</span>(<span class="fu">c</span>(n_bins_current, n_bins_c_current), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb109-47"><a href="#cb109-47" aria-hidden="true" tabindex="-1"></a>      <span class="fu">barplot</span>(</span>
<span id="cb109-48"><a href="#cb109-48" aria-hidden="true" tabindex="-1"></a>        n_bins_current,</span>
<span id="cb109-49"><a href="#cb109-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">"#000000"</span>, <span class="at">alpha.f =</span> .<span class="dv">3</span>),</span>
<span id="cb109-50"><a href="#cb109-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylim =</span> y_lim_bp,</span>
<span id="cb109-51"><a href="#cb109-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="st">"white"</span>,</span>
<span id="cb109-52"><a href="#cb109-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">axes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb109-53"><a href="#cb109-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>, </span>
<span id="cb109-54"><a href="#cb109-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(title)</span>
<span id="cb109-55"><a href="#cb109-55" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb109-56"><a href="#cb109-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">barplot</span>(</span>
<span id="cb109-57"><a href="#cb109-57" aria-hidden="true" tabindex="-1"></a>        n_bins_c_current,</span>
<span id="cb109-58"><a href="#cb109-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">"#0072B2"</span>, <span class="at">alpha.f =</span> .<span class="dv">3</span>),</span>
<span id="cb109-59"><a href="#cb109-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylim =</span> y_lim_bp,</span>
<span id="cb109-60"><a href="#cb109-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="st">"white"</span>,</span>
<span id="cb109-61"><a href="#cb109-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">axes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb109-62"><a href="#cb109-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">main =</span> <span class="st">""</span>,</span>
<span id="cb109-63"><a href="#cb109-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">add =</span> <span class="cn">TRUE</span></span>
<span id="cb109-64"><a href="#cb109-64" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb109-65"><a href="#cb109-65" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb109-66"><a href="#cb109-66" aria-hidden="true" tabindex="-1"></a>      tb_current <span class="ot">&lt;-</span> </span>
<span id="cb109-67"><a href="#cb109-67" aria-hidden="true" tabindex="-1"></a>        tb_calibration_curve <span class="sc">|&gt;</span> </span>
<span id="cb109-68"><a href="#cb109-68" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(</span>
<span id="cb109-69"><a href="#cb109-69" aria-hidden="true" tabindex="-1"></a>          scale_parameter <span class="sc">==</span> <span class="sc">!!</span>scale_param,</span>
<span id="cb109-70"><a href="#cb109-70" aria-hidden="true" tabindex="-1"></a>          sample <span class="sc">==</span> <span class="sc">!!</span>sample</span>
<span id="cb109-71"><a href="#cb109-71" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">|&gt;</span> </span>
<span id="cb109-72"><a href="#cb109-72" aria-hidden="true" tabindex="-1"></a>        <span class="fu">group_by</span>(type, scale_parameter, xlim) <span class="sc">|&gt;</span> </span>
<span id="cb109-73"><a href="#cb109-73" aria-hidden="true" tabindex="-1"></a>        <span class="fu">summarise</span>(</span>
<span id="cb109-74"><a href="#cb109-74" aria-hidden="true" tabindex="-1"></a>          <span class="at">mean =</span> <span class="fu">mean</span>(locfit_pred),</span>
<span id="cb109-75"><a href="#cb109-75" aria-hidden="true" tabindex="-1"></a>          <span class="at">lower =</span> <span class="fu">quantile</span>(locfit_pred, <span class="at">probs =</span> .<span class="dv">025</span>),</span>
<span id="cb109-76"><a href="#cb109-76" aria-hidden="true" tabindex="-1"></a>          <span class="at">upper =</span> <span class="fu">quantile</span>(locfit_pred, <span class="at">probs =</span> .<span class="dv">975</span>),</span>
<span id="cb109-77"><a href="#cb109-77" aria-hidden="true" tabindex="-1"></a>          <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb109-78"><a href="#cb109-78" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb109-79"><a href="#cb109-79" aria-hidden="true" tabindex="-1"></a>      <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">4.1</span>, <span class="fl">4.3</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb109-80"><a href="#cb109-80" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot</span>(</span>
<span id="cb109-81"><a href="#cb109-81" aria-hidden="true" tabindex="-1"></a>        tb_current<span class="sc">$</span>xlim, tb_current<span class="sc">$</span>mean,</span>
<span id="cb109-82"><a href="#cb109-82" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> colours[sample],</span>
<span id="cb109-83"><a href="#cb109-83" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlim =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">ylim =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,</span>
<span id="cb109-84"><a href="#cb109-84" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">"Predicted probability"</span>, <span class="at">ylab =</span> <span class="st">"Mean predicted probability"</span>,</span>
<span id="cb109-85"><a href="#cb109-85" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">""</span></span>
<span id="cb109-86"><a href="#cb109-86" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb109-87"><a href="#cb109-87" aria-hidden="true" tabindex="-1"></a>      <span class="fu">polygon</span>(</span>
<span id="cb109-88"><a href="#cb109-88" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(tb_current<span class="sc">$</span>xlim, <span class="fu">rev</span>(tb_current<span class="sc">$</span>xlim)),</span>
<span id="cb109-89"><a href="#cb109-89" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(tb_current<span class="sc">$</span>lower, <span class="fu">rev</span>(tb_current<span class="sc">$</span>upper)),</span>
<span id="cb109-90"><a href="#cb109-90" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="at">col =</span> colours[sample], <span class="at">alpha.f =</span> .<span class="dv">4</span>),</span>
<span id="cb109-91"><a href="#cb109-91" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span></span>
<span id="cb109-92"><a href="#cb109-92" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb109-93"><a href="#cb109-93" aria-hidden="true" tabindex="-1"></a>      <span class="fu">segments</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb109-94"><a href="#cb109-94" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb109-95"><a href="#cb109-95" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb109-96"><a href="#cb109-96" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The figures below show a panel of graphs with the calibration curves obtained with the local regression method. Each tab shows the average curve obtained on the 200 replications for a type of recalibration used, as well as the 95% bootstrap confidence intervals. The first two tab (<code>True Prob.</code> and <code>No Calibration</code>) show the curves obtained using the true probabilities <span class="math inline">\(p\)</span> and the uncalibrated probabilities <span class="math inline">\(p^u\)</span>, instead of the recalibrated probabilities <span class="math inline">\(p^c\)</span>. Each row of the panel in the Figures corresponds to a value for either <span class="math inline">\(\alpha\)</span> or <span class="math inline">\(\gamma\)</span> used to transform <span class="math inline">\(p\)</span> to get <span class="math inline">\(p^u\)</span>. The left column shows the calibration curve obtained on the calibration set whereas the right column shows the calibration curve obtained on the test set. The average distribution (computed over the 200 simulations) of the <span style="\&quot;color:#0000004D\&quot;">uncalibrated scores</span> and of the <span style="\&quot;color:#0072B24D\&quot;">calibrated scores</span> are shown in the histograms on top of each graph.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-18-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-1" role="tab" aria-controls="tabset-18-1" aria-selected="true">For <span class="math inline">\(\alpha\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-2" role="tab" aria-controls="tabset-18-2" aria-selected="false">For <span class="math inline">\(\gamma\)</span></a></li></ul>
<div class="tab-content">
<div id="tabset-18-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-18-1-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true">True Prob.</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false">No Calibration</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-3" role="tab" aria-controls="tabset-16-3" aria-selected="false">Platt Scaling</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-4" role="tab" aria-controls="tabset-16-4" aria-selected="false">Isotonic Reg.</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-5" role="tab" aria-controls="tabset-16-5" aria-selected="false">Beta Calib.</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-6" role="tab" aria-controls="tabset-16-6" aria-selected="false">Local Reg. (deg = 0)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-7" role="tab" aria-controls="tabset-16-7" aria-selected="false">Local Reg. (deg = 1)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-8" role="tab" aria-controls="tabset-16-8" aria-selected="false">Local Reg (deg = 2)</a></li></ul>
<div class="tab-content">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with local regressions for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-142-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with local regressions for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-143-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-16-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-3-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with local regressions for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-144-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-16-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-4-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with local regressions for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-145-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-16-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-5-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with local regressions for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-146-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-16-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-6-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with local regressions for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-147-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-16-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-7-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with local regressions for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-148-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-16-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-8-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with local regressions for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-149-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-18-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-2-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true">True Prob.</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false">No Calibration</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-3" role="tab" aria-controls="tabset-17-3" aria-selected="false">Platt Scaling</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-4" role="tab" aria-controls="tabset-17-4" aria-selected="false">Isotonic Reg.</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-5" role="tab" aria-controls="tabset-17-5" aria-selected="false">Beta Calib.</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-6" role="tab" aria-controls="tabset-17-6" aria-selected="false">Local Reg. (deg = 0)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-7" role="tab" aria-controls="tabset-17-7" aria-selected="false">Local Reg. (deg = 1)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-8" role="tab" aria-controls="tabset-17-8" aria-selected="false">Local Reg (deg = 2)</a></li></ul>
<div class="tab-content">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with local regressions for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-150-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with local regressions for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-151-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-17-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-3-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with local regressions for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-152-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-17-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-4-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with local regressions for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-153-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-17-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-5-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with local regressions for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-154-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-17-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-6-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with local regressions for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-155-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-17-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-7-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with local regressions for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-156-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-17-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-8-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with local regressions for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-157-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Let us visualize this in another way.</p>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>plot_calib_locfit_simuls_2 <span class="ot">&lt;-</span> <span class="cf">function</span>(calib_curve, method) {</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>  tb_calibration_curve_both <span class="ot">&lt;-</span> calib_curve <span class="sc">|&gt;</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>      method <span class="sc">==</span> <span class="sc">!!</span>method</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>  mat <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">13</span>, <span class="dv">15</span>,</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">14</span>, <span class="dv">16</span>,</span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">17</span>, <span class="dv">19</span>,</span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>    <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">18</span>, <span class="dv">20</span>,</span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>    <span class="dv">9</span>, <span class="dv">11</span>, <span class="dv">21</span>, <span class="dv">23</span>,</span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>    <span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">22</span>, <span class="dv">24</span></span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(mat, <span class="at">height =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="dv">3</span>))</span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a>  y_lim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb110-21"><a href="#cb110-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (type <span class="cf">in</span> <span class="fu">c</span>(<span class="st">"alpha"</span>, <span class="st">"gamma"</span>)) {</span>
<span id="cb110-22"><a href="#cb110-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-23"><a href="#cb110-23" aria-hidden="true" tabindex="-1"></a>    tb_calibration_curve <span class="ot">&lt;-</span></span>
<span id="cb110-24"><a href="#cb110-24" aria-hidden="true" tabindex="-1"></a>      tb_calibration_curve_both <span class="sc">|&gt;</span></span>
<span id="cb110-25"><a href="#cb110-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(type <span class="sc">==</span> <span class="sc">!!</span>type)</span>
<span id="cb110-26"><a href="#cb110-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-27"><a href="#cb110-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">"alpha"</span>) {</span>
<span id="cb110-28"><a href="#cb110-28" aria-hidden="true" tabindex="-1"></a>      count_scores <span class="ot">&lt;-</span> count_scores_alpha <span class="sc">|&gt;</span> <span class="fu">filter</span>(method <span class="sc">==</span> <span class="sc">!!</span>method)</span>
<span id="cb110-29"><a href="#cb110-29" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">"gamma"</span>) {</span>
<span id="cb110-30"><a href="#cb110-30" aria-hidden="true" tabindex="-1"></a>      count_scores <span class="ot">&lt;-</span> count_scores_gamma <span class="sc">|&gt;</span> <span class="fu">filter</span>(method <span class="sc">==</span> <span class="sc">!!</span>method)</span>
<span id="cb110-31"><a href="#cb110-31" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb110-32"><a href="#cb110-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-33"><a href="#cb110-33" aria-hidden="true" tabindex="-1"></a>    scale_params <span class="ot">&lt;-</span> <span class="fu">unique</span>(tb_calibration_curve<span class="sc">$</span>scale_parameter)</span>
<span id="cb110-34"><a href="#cb110-34" aria-hidden="true" tabindex="-1"></a>    seeds <span class="ot">&lt;-</span> <span class="fu">unique</span>(tb_calibration_curve<span class="sc">$</span>seed)</span>
<span id="cb110-35"><a href="#cb110-35" aria-hidden="true" tabindex="-1"></a>    colours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Calibration"</span> <span class="ot">=</span> <span class="st">"#D55E00"</span>, <span class="st">"Test"</span> <span class="ot">=</span> <span class="st">"#009E73"</span>)</span>
<span id="cb110-36"><a href="#cb110-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-37"><a href="#cb110-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (scale_param <span class="cf">in</span> scale_params) {</span>
<span id="cb110-38"><a href="#cb110-38" aria-hidden="true" tabindex="-1"></a>      title <span class="ot">&lt;-</span> <span class="fu">str_c</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">"</span>, type, <span class="st">" = $"</span>, <span class="fu">round</span>(scale_param, <span class="dv">2</span>))</span>
<span id="cb110-39"><a href="#cb110-39" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb110-40"><a href="#cb110-40" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (sample <span class="cf">in</span> <span class="fu">c</span>(<span class="st">"Calibration"</span>, <span class="st">"Test"</span>)) {</span>
<span id="cb110-41"><a href="#cb110-41" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb110-42"><a href="#cb110-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (sample <span class="sc">==</span> <span class="st">"Calibration"</span>){</span>
<span id="cb110-43"><a href="#cb110-43" aria-hidden="true" tabindex="-1"></a>          n_bins_current <span class="ot">&lt;-</span> count_scores <span class="sc">|&gt;</span></span>
<span id="cb110-44"><a href="#cb110-44" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(transform_scale <span class="sc">==</span> <span class="sc">!!</span>scale_param) <span class="sc">|&gt;</span> <span class="fu">pull</span>(<span class="st">"n_bins_calib"</span>)</span>
<span id="cb110-45"><a href="#cb110-45" aria-hidden="true" tabindex="-1"></a>          n_bins_c_current <span class="ot">&lt;-</span> count_scores <span class="sc">|&gt;</span></span>
<span id="cb110-46"><a href="#cb110-46" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(transform_scale <span class="sc">==</span> <span class="sc">!!</span>scale_param) <span class="sc">|&gt;</span> <span class="fu">pull</span>(<span class="st">"n_bins_c_calib"</span>)</span>
<span id="cb110-47"><a href="#cb110-47" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb110-48"><a href="#cb110-48" aria-hidden="true" tabindex="-1"></a>          n_bins_current <span class="ot">&lt;-</span> count_scores <span class="sc">|&gt;</span></span>
<span id="cb110-49"><a href="#cb110-49" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(transform_scale <span class="sc">==</span> <span class="sc">!!</span>scale_param) <span class="sc">|&gt;</span> <span class="fu">pull</span>(<span class="st">"n_bins_test"</span>)</span>
<span id="cb110-50"><a href="#cb110-50" aria-hidden="true" tabindex="-1"></a>          n_bins_c_current <span class="ot">&lt;-</span> count_scores <span class="sc">|&gt;</span></span>
<span id="cb110-51"><a href="#cb110-51" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(transform_scale <span class="sc">==</span> <span class="sc">!!</span>scale_param) <span class="sc">|&gt;</span> <span class="fu">pull</span>(<span class="st">"n_bins_c_test"</span>)</span>
<span id="cb110-52"><a href="#cb110-52" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb110-53"><a href="#cb110-53" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb110-54"><a href="#cb110-54" aria-hidden="true" tabindex="-1"></a>        <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">4.3</span>, <span class="fl">1.0</span>, <span class="fl">0.5</span>))</span>
<span id="cb110-55"><a href="#cb110-55" aria-hidden="true" tabindex="-1"></a>        y_lim_bp <span class="ot">&lt;-</span> <span class="fu">range</span>(<span class="fu">c</span>(n_bins_current, n_bins_c_current), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb110-56"><a href="#cb110-56" aria-hidden="true" tabindex="-1"></a>        <span class="fu">barplot</span>(</span>
<span id="cb110-57"><a href="#cb110-57" aria-hidden="true" tabindex="-1"></a>          n_bins_current,</span>
<span id="cb110-58"><a href="#cb110-58" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">"#000000"</span>, <span class="at">alpha.f =</span> .<span class="dv">3</span>),</span>
<span id="cb110-59"><a href="#cb110-59" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylim =</span> y_lim_bp,</span>
<span id="cb110-60"><a href="#cb110-60" aria-hidden="true" tabindex="-1"></a>          <span class="at">border =</span> <span class="st">"white"</span>,</span>
<span id="cb110-61"><a href="#cb110-61" aria-hidden="true" tabindex="-1"></a>          <span class="at">axes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb110-62"><a href="#cb110-62" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb110-63"><a href="#cb110-63" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(title)</span>
<span id="cb110-64"><a href="#cb110-64" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb110-65"><a href="#cb110-65" aria-hidden="true" tabindex="-1"></a>        <span class="fu">barplot</span>(</span>
<span id="cb110-66"><a href="#cb110-66" aria-hidden="true" tabindex="-1"></a>          n_bins_c_current,</span>
<span id="cb110-67"><a href="#cb110-67" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">"#0072B2"</span>, <span class="at">alpha.f =</span> .<span class="dv">3</span>),</span>
<span id="cb110-68"><a href="#cb110-68" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylim =</span> y_lim_bp,</span>
<span id="cb110-69"><a href="#cb110-69" aria-hidden="true" tabindex="-1"></a>          <span class="at">border =</span> <span class="st">"white"</span>,</span>
<span id="cb110-70"><a href="#cb110-70" aria-hidden="true" tabindex="-1"></a>          <span class="at">axes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb110-71"><a href="#cb110-71" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">main =</span> <span class="st">""</span>,</span>
<span id="cb110-72"><a href="#cb110-72" aria-hidden="true" tabindex="-1"></a>          <span class="at">add =</span> <span class="cn">TRUE</span></span>
<span id="cb110-73"><a href="#cb110-73" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb110-74"><a href="#cb110-74" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb110-75"><a href="#cb110-75" aria-hidden="true" tabindex="-1"></a>        tb_current <span class="ot">&lt;-</span></span>
<span id="cb110-76"><a href="#cb110-76" aria-hidden="true" tabindex="-1"></a>          tb_calibration_curve <span class="sc">|&gt;</span></span>
<span id="cb110-77"><a href="#cb110-77" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(</span>
<span id="cb110-78"><a href="#cb110-78" aria-hidden="true" tabindex="-1"></a>            scale_parameter <span class="sc">==</span> <span class="sc">!!</span>scale_param,</span>
<span id="cb110-79"><a href="#cb110-79" aria-hidden="true" tabindex="-1"></a>            sample <span class="sc">==</span> <span class="sc">!!</span>sample</span>
<span id="cb110-80"><a href="#cb110-80" aria-hidden="true" tabindex="-1"></a>          ) <span class="sc">|&gt;</span></span>
<span id="cb110-81"><a href="#cb110-81" aria-hidden="true" tabindex="-1"></a>          <span class="fu">group_by</span>(type, scale_parameter, xlim, sample) <span class="sc">|&gt;</span></span>
<span id="cb110-82"><a href="#cb110-82" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(</span>
<span id="cb110-83"><a href="#cb110-83" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean =</span> <span class="fu">mean</span>(locfit_pred),</span>
<span id="cb110-84"><a href="#cb110-84" aria-hidden="true" tabindex="-1"></a>            <span class="at">lower =</span> <span class="fu">quantile</span>(locfit_pred, <span class="at">probs =</span> .<span class="dv">025</span>),</span>
<span id="cb110-85"><a href="#cb110-85" aria-hidden="true" tabindex="-1"></a>            <span class="at">upper =</span> <span class="fu">quantile</span>(locfit_pred, <span class="at">probs =</span> .<span class="dv">975</span>),</span>
<span id="cb110-86"><a href="#cb110-86" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb110-87"><a href="#cb110-87" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb110-88"><a href="#cb110-88" aria-hidden="true" tabindex="-1"></a>        <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">4.1</span>, <span class="fl">4.3</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="at">mgp =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb110-89"><a href="#cb110-89" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plot</span>(</span>
<span id="cb110-90"><a href="#cb110-90" aria-hidden="true" tabindex="-1"></a>          tb_current<span class="sc">$</span>xlim, tb_current<span class="sc">$</span>mean,</span>
<span id="cb110-91"><a href="#cb110-91" aria-hidden="true" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> colours[sample],</span>
<span id="cb110-92"><a href="#cb110-92" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlim =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">ylim =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,</span>
<span id="cb110-93"><a href="#cb110-93" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$p^u$"</span>), </span>
<span id="cb110-94"><a href="#cb110-94" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$E(D | p^u = p^c)$"</span>),</span>
<span id="cb110-95"><a href="#cb110-95" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">""</span></span>
<span id="cb110-96"><a href="#cb110-96" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb110-97"><a href="#cb110-97" aria-hidden="true" tabindex="-1"></a>        <span class="fu">polygon</span>(</span>
<span id="cb110-98"><a href="#cb110-98" aria-hidden="true" tabindex="-1"></a>          <span class="fu">c</span>(tb_current<span class="sc">$</span>xlim, <span class="fu">rev</span>(tb_current<span class="sc">$</span>xlim)),</span>
<span id="cb110-99"><a href="#cb110-99" aria-hidden="true" tabindex="-1"></a>          <span class="fu">c</span>(tb_current<span class="sc">$</span>lower, <span class="fu">rev</span>(tb_current<span class="sc">$</span>upper)),</span>
<span id="cb110-100"><a href="#cb110-100" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="at">col =</span> colours[sample], <span class="at">alpha.f =</span> .<span class="dv">4</span>),</span>
<span id="cb110-101"><a href="#cb110-101" aria-hidden="true" tabindex="-1"></a>          <span class="at">border =</span> <span class="cn">NA</span></span>
<span id="cb110-102"><a href="#cb110-102" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb110-103"><a href="#cb110-103" aria-hidden="true" tabindex="-1"></a>        <span class="fu">segments</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb110-104"><a href="#cb110-104" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb110-105"><a href="#cb110-105" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb110-106"><a href="#cb110-106" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb110-107"><a href="#cb110-107" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-19-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-1" role="tab" aria-controls="tabset-19-1" aria-selected="true">True Prob.</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-2" role="tab" aria-controls="tabset-19-2" aria-selected="false">No Calibration</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-3" role="tab" aria-controls="tabset-19-3" aria-selected="false">Platt</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-4" role="tab" aria-controls="tabset-19-4" aria-selected="false">Isotonic</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-5" role="tab" aria-controls="tabset-19-5" aria-selected="false">Beta</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-6" role="tab" aria-controls="tabset-19-6" aria-selected="false">Locfit (deg=0)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-7" role="tab" aria-controls="tabset-19-7" aria-selected="false">Locfit (deg=1)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-8" role="tab" aria-controls="tabset-19-8" aria-selected="false">Locfit (deg=2)</a></li></ul>
<div class="tab-content">
<div id="tabset-19-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-19-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_calib_locfit_simuls_2</span>(</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">calib_curve =</span> calib_curve_locfit_simuls <span class="sc">|&gt;</span> </span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(scale_parameter <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>)), </span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"True Prob."</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-recalib-simuls-calib-curve-locfit-trueprob" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.27: Calibration Curves Calculated with True Probabilities as the Scores. The curves are obtained with quantile binning, for the calibration set (orange) and for the test set (green) for varying values of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\gamma\)</span>. The curves are the average values obtained on 200 replications of the simulations, the bands correspond to 95% bootstrap interval. The histogram on top of each graph show the distribution of the true probabilities</figcaption>
<p><img src="recalibration_files/figure-html/fig-recalib-simuls-calib-curve-locfit-trueprob-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-19-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_calib_locfit_simuls_2</span>(</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">calib_curve =</span> calib_curve_locfit_simuls <span class="sc">|&gt;</span> </span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(scale_parameter <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>)), </span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"No Calibration"</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-recalib-simuls-calib-curve-locfit-nocalib" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.28: Calibration Curves Calculated with Uncalibrated Scores. The curves are obtained with quantile binning, for the calibration set (orange) and for the test set (green) for varying values of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\gamma\)</span>. The curves are the average values obtained on 200 replications of the simulations, the bands correspond to 95% bootstrap interval. The histogram on top of each graph show the distribution of the true probabilities</figcaption>
<p><img src="recalibration_files/figure-html/fig-recalib-simuls-calib-curve-locfit-nocalib-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-19-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_calib_locfit_simuls_2</span>(</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">calib_curve =</span> calib_curve_locfit_simuls <span class="sc">|&gt;</span> </span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(scale_parameter <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>)), </span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"platt"</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-recalib-simuls-calib-curve-locfit-platt" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.29: Calibration Curves Calculated with Scores Recalibrated Using Platt Scaling. The curves are obtained with quantile binning, for the calibration set (orange) and for the test set (green) for varying values of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\gamma\)</span>. The curves are the average values obtained on 200 replications of the simulations, the bands correspond to 95% bootstrap interval. The histogram on top of each graph show the distribution of the uncalibrated scores, and that of the calibrated scores</figcaption>
<p><img src="recalibration_files/figure-html/fig-recalib-simuls-calib-curve-locfit-platt-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-19-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_calib_locfit_simuls_2</span>(</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">calib_curve =</span> calib_curve_locfit_simuls <span class="sc">|&gt;</span> </span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(scale_parameter <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>)), </span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"isotonic"</span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-recalib-simuls-calib-curve-locfit-isotonic" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.30: Calibration Curves Calculated with Scores Recalibrated Using Isotonic Regression. The curves are obtained with quantile binning, for the calibration set (orange) and for the test set (green) for varying values of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\gamma\)</span>. The curves are the average values obtained on 200 replications of the simulations, the bands correspond to 95% bootstrap interval. The histogram on top of each graph show the distribution of the uncalibrated scores, and that of the calibrated scores</figcaption>
<p><img src="recalibration_files/figure-html/fig-recalib-simuls-calib-curve-locfit-isotonic-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-19-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_calib_locfit_simuls_2</span>(</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">calib_curve =</span> calib_curve_locfit_simuls <span class="sc">|&gt;</span> </span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(scale_parameter <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>)), </span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"beta"</span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-recalib-simuls-calib-curve-locfit-beta" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.31: Calibration Curves Calculated with Scores Recalibrated Using Beta Calibration. The curves are obtained with quantile binning, for the calibration set (orange) and for the test set (green) for varying values of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\gamma\)</span>. The curves are the average values obtained on 200 replications of the simulations, the bands correspond to 95% bootstrap interval. The histogram on top of each graph show the distribution of the uncalibrated scores, and that of the calibrated scores</figcaption>
<p><img src="recalibration_files/figure-html/fig-recalib-simuls-calib-curve-locfit-beta-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-19-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-6-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_calib_locfit_simuls_2</span>(</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">calib_curve =</span> calib_curve_locfit_simuls <span class="sc">|&gt;</span> </span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(scale_parameter <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>)), </span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"locfit_0"</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-recalib-simuls-calib-curve-locfit-locfit0" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.32: Calibration Curves Calculated with Scores Recalibrated Using Local Regression (with degree 0). The curves are obtained with quantile binning, for the calibration set (orange) and for the test set (green) for varying values of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\gamma\)</span>. The curves are the average values obtained on 200 replications of the simulations, the bands correspond to 95% bootstrap interval. The histogram on top of each graph show the distribution of the uncalibrated scores, and that of the calibrated scores</figcaption>
<p><img src="recalibration_files/figure-html/fig-recalib-simuls-calib-curve-locfit-locfit0-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-19-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-7-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_calib_locfit_simuls_2</span>(</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">calib_curve =</span> calib_curve_locfit_simuls <span class="sc">|&gt;</span> </span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(scale_parameter <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>)), </span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"locfit_1"</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-recalib-simuls-calib-curve-locfit-locfit1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.33: Calibration Curves Calculated with Scores Recalibrated Using Local Regression (with degree 1). The curves are obtained with quantile binning, for the calibration set (orange) and for the test set (green) for varying values of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\gamma\)</span>. The curves are the average values obtained on 200 replications of the simulations, the bands correspond to 95% bootstrap interval. The histogram on top of each graph show the distribution of the uncalibrated scores, and that of the calibrated scores</figcaption>
<p><img src="recalibration_files/figure-html/fig-recalib-simuls-calib-curve-locfit-locfit1-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-19-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-8-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_calib_locfit_simuls_2</span>(</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">calib_curve =</span> calib_curve_locfit_simuls <span class="sc">|&gt;</span> </span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(scale_parameter <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>)), </span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"locfit_2"</span></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-recalib-simuls-calib-curve-locfit-locfit2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.34: Calibration Curves Calculated with Scores Recalibrated Using Local Regression (with degree 2). The curves are obtained with quantile binning, for the calibration set (orange) and for the test set (green) for varying values of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\gamma\)</span>. The curves are the average values obtained on 200 replications of the simulations, the bands correspond to 95% bootstrap interval. The histogram on top of each graph show the distribution of the uncalibrated scores, and that of the calibrated scores</figcaption>
<p><img src="recalibration_files/figure-html/fig-recalib-simuls-calib-curve-locfit-locfit2-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="calibration-curve-with-moving-average-1" class="level3" data-number="2.7.3">
<h3 data-number="2.7.3" class="anchored" data-anchor-id="calibration-curve-with-moving-average-1"><span class="header-section-number">2.7.3</span> Calibration Curve with Moving Average</h3>
<p>Let us plot the calibration curve obtained with moving average, for the 200 replications.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For alpha</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">names</span>(simul_recalib_alpha[[<span class="dv">1</span>]]<span class="sc">$</span>res_recalibration)</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"True Prob."</span>, <span class="st">"No Calibration"</span>, methods)</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>calib_curve_ma_simuls_alpha <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"list"</span>, <span class="at">length =</span> <span class="fu">length</span>(methods))</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(calib_curve_ma_simuls_alpha) <span class="ot">&lt;-</span> methods</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(future)</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>nb_cores <span class="ot">&lt;-</span> future<span class="sc">::</span><span class="fu">availableCores</span>()<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> nb_cores)</span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(methods)) {</span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a>  progressr<span class="sc">::</span><span class="fu">with_progress</span>({</span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> progressr<span class="sc">::</span><span class="fu">progressor</span>(<span class="at">steps =</span> <span class="fu">nrow</span>(grid_alpha))</span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a>    calib_curve_ma_simuls_m <span class="ot">&lt;-</span> furrr<span class="sc">::</span><span class="fu">future_map</span>(</span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">.x =</span> simul_recalib_alpha,</span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">.f =</span> <span class="sc">~</span>{</span>
<span id="cb119-16"><a href="#cb119-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">p</span>()</span>
<span id="cb119-17"><a href="#cb119-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">calibration_curve_ma_simul</span>(</span>
<span id="cb119-18"><a href="#cb119-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">simul =</span> .x, <span class="at">method =</span> methods[i_method],</span>
<span id="cb119-19"><a href="#cb119-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">nn =</span> .<span class="dv">15</span>, </span>
<span id="cb119-20"><a href="#cb119-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">prob =</span> .<span class="dv">95</span>, </span>
<span id="cb119-21"><a href="#cb119-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">ci_method =</span> <span class="st">"probit"</span></span>
<span id="cb119-22"><a href="#cb119-22" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb119-23"><a href="#cb119-23" aria-hidden="true" tabindex="-1"></a>      },</span>
<span id="cb119-24"><a href="#cb119-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">.options =</span> furrr<span class="sc">::</span><span class="fu">furrr_options</span>(<span class="at">seed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb119-25"><a href="#cb119-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb119-26"><a href="#cb119-26" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb119-27"><a href="#cb119-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add value for alpha</span></span>
<span id="cb119-28"><a href="#cb119-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(calib_curve_ma_simuls_m)) {</span>
<span id="cb119-29"><a href="#cb119-29" aria-hidden="true" tabindex="-1"></a>    calib_curve_ma_simuls_m[[j]]<span class="sc">$</span>scale_parameter <span class="ot">&lt;-</span> grid_alpha<span class="sc">$</span>alpha[j]</span>
<span id="cb119-30"><a href="#cb119-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb119-31"><a href="#cb119-31" aria-hidden="true" tabindex="-1"></a>  calib_curve_ma_simuls_alpha[[i_method]] <span class="ot">&lt;-</span> calib_curve_ma_simuls_m <span class="sc">|&gt;</span> </span>
<span id="cb119-32"><a href="#cb119-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list_rbind</span>(<span class="at">names_to =</span> <span class="st">"i_row"</span>)</span>
<span id="cb119-33"><a href="#cb119-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb119-34"><a href="#cb119-34" aria-hidden="true" tabindex="-1"></a>calib_curve_ma_simuls_alpha <span class="ot">&lt;-</span> <span class="fu">list_rbind</span>(</span>
<span id="cb119-35"><a href="#cb119-35" aria-hidden="true" tabindex="-1"></a>  calib_curve_ma_simuls_alpha, <span class="at">names_to =</span> <span class="st">"method"</span></span>
<span id="cb119-36"><a href="#cb119-36" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb119-37"><a href="#cb119-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="st">"alpha"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us loop over the simulations made with varying values for <span class="math inline">\(\gamma\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For gamma</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">names</span>(simul_recalib_gamma[[<span class="dv">1</span>]]<span class="sc">$</span>res_recalibration)</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove isotonic which makes the R session crash...</span></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"True Prob."</span>, <span class="st">"No Calibration"</span>, methods)</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>calib_curve_ma_simuls_gamma <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"list"</span>, <span class="at">length =</span> <span class="fu">length</span>(methods))</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(calib_curve_ma_simuls_gamma) <span class="ot">&lt;-</span> methods</span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(future)</span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>nb_cores <span class="ot">&lt;-</span> future<span class="sc">::</span><span class="fu">availableCores</span>()<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> nb_cores)</span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(methods)) {</span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a>  progressr<span class="sc">::</span><span class="fu">with_progress</span>({</span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> progressr<span class="sc">::</span><span class="fu">progressor</span>(<span class="at">steps =</span> <span class="fu">nrow</span>(grid_gamma))</span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a>    calib_curve_ma_simuls_m <span class="ot">&lt;-</span> furrr<span class="sc">::</span><span class="fu">future_map</span>(</span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">.x =</span> simul_recalib_gamma,</span>
<span id="cb120-16"><a href="#cb120-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">.f =</span> <span class="sc">~</span>{</span>
<span id="cb120-17"><a href="#cb120-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">p</span>()</span>
<span id="cb120-18"><a href="#cb120-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">calibration_curve_ma_simul</span>(</span>
<span id="cb120-19"><a href="#cb120-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">simul =</span> .x, <span class="at">method =</span> methods[i_method],</span>
<span id="cb120-20"><a href="#cb120-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">nn =</span> .<span class="dv">15</span>, </span>
<span id="cb120-21"><a href="#cb120-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">prob =</span> .<span class="dv">95</span>, </span>
<span id="cb120-22"><a href="#cb120-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">ci_method =</span> <span class="st">"probit"</span></span>
<span id="cb120-23"><a href="#cb120-23" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb120-24"><a href="#cb120-24" aria-hidden="true" tabindex="-1"></a>      },</span>
<span id="cb120-25"><a href="#cb120-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">.options =</span> furrr<span class="sc">::</span><span class="fu">furrr_options</span>(<span class="at">seed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb120-26"><a href="#cb120-26" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb120-27"><a href="#cb120-27" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb120-28"><a href="#cb120-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add value for alpha</span></span>
<span id="cb120-29"><a href="#cb120-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(calib_curve_ma_simuls_m)) {</span>
<span id="cb120-30"><a href="#cb120-30" aria-hidden="true" tabindex="-1"></a>    calib_curve_ma_simuls_m[[j]]<span class="sc">$</span>scale_parameter <span class="ot">&lt;-</span> grid_gamma<span class="sc">$</span>gamma[j]</span>
<span id="cb120-31"><a href="#cb120-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb120-32"><a href="#cb120-32" aria-hidden="true" tabindex="-1"></a>  calib_curve_ma_simuls_gamma[[i_method]] <span class="ot">&lt;-</span> calib_curve_ma_simuls_m <span class="sc">|&gt;</span> </span>
<span id="cb120-33"><a href="#cb120-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list_rbind</span>(<span class="at">names_to =</span> <span class="st">"i_row"</span>)</span>
<span id="cb120-34"><a href="#cb120-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb120-35"><a href="#cb120-35" aria-hidden="true" tabindex="-1"></a>calib_curve_ma_simuls_gamma <span class="ot">&lt;-</span> <span class="fu">list_rbind</span>(</span>
<span id="cb120-36"><a href="#cb120-36" aria-hidden="true" tabindex="-1"></a>  calib_curve_ma_simuls_gamma, <span class="at">names_to =</span> <span class="st">"method"</span></span>
<span id="cb120-37"><a href="#cb120-37" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb120-38"><a href="#cb120-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="st">"gamma"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The results are stored in a single tibble:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>calib_curve_ma_simuls <span class="ot">&lt;-</span> </span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>  calib_curve_ma_simuls_alpha <span class="sc">|&gt;</span> </span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(calib_curve_ma_simuls_gamma) <span class="sc">|&gt;</span> </span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample =</span> <span class="fu">factor</span>(</span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>      sample, </span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Calibration"</span>, <span class="st">"Test"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Calibration"</span>, <span class="st">"Test"</span>)</span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us define a function to plot the calibration curves on the calibration and the test samples.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>plot_calib_ma_simuls <span class="ot">&lt;-</span> <span class="cf">function</span>(method, type) {</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>  tb_calibration_curve <span class="ot">&lt;-</span> calib_curve_ma_simuls <span class="sc">|&gt;</span> </span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>      method <span class="sc">==</span> <span class="sc">!!</span>method,</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>      type <span class="sc">==</span> <span class="sc">!!</span>type</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">"alpha"</span>) {</span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>    count_scores <span class="ot">&lt;-</span> count_scores_alpha <span class="sc">|&gt;</span> <span class="fu">filter</span>(method <span class="sc">==</span> <span class="sc">!!</span>method)</span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">"gamma"</span>) {</span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>    count_scores <span class="ot">&lt;-</span> count_scores_gamma <span class="sc">|&gt;</span> <span class="fu">filter</span>(method <span class="sc">==</span> <span class="sc">!!</span>method)</span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Type should be either </span><span class="sc">\"</span><span class="st">alpha</span><span class="sc">\"</span><span class="st"> or </span><span class="sc">\"</span><span class="st">gamma</span><span class="sc">\"</span><span class="st">"</span>)</span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a>  scale_params <span class="ot">&lt;-</span> <span class="fu">unique</span>(tb_calibration_curve<span class="sc">$</span>scale_parameter)</span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a>  seeds <span class="ot">&lt;-</span> <span class="fu">unique</span>(tb_calibration_curve<span class="sc">$</span>seed)</span>
<span id="cb122-16"><a href="#cb122-16" aria-hidden="true" tabindex="-1"></a>  colours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Calibration"</span> <span class="ot">=</span> <span class="st">"#D55E00"</span>, <span class="st">"Test"</span> <span class="ot">=</span> <span class="st">"#009E73"</span>)</span>
<span id="cb122-17"><a href="#cb122-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb122-18"><a href="#cb122-18" aria-hidden="true" tabindex="-1"></a>  nb <span class="ot">&lt;-</span> <span class="fu">length</span>(scale_params)</span>
<span id="cb122-19"><a href="#cb122-19" aria-hidden="true" tabindex="-1"></a>  mat <span class="ot">&lt;-</span> mat_init <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb122-20"><a href="#cb122-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(nb<span class="dv">-1</span>)) {</span>
<span id="cb122-21"><a href="#cb122-21" aria-hidden="true" tabindex="-1"></a>    mat <span class="ot">&lt;-</span> <span class="fu">rbind</span>(mat, mat_init <span class="sc">+</span> j <span class="sc">*</span> <span class="dv">4</span>)</span>
<span id="cb122-22"><a href="#cb122-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb122-23"><a href="#cb122-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(mat, <span class="at">heights =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), nb))</span>
<span id="cb122-24"><a href="#cb122-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb122-25"><a href="#cb122-25" aria-hidden="true" tabindex="-1"></a>  y_lim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb122-26"><a href="#cb122-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb122-27"><a href="#cb122-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (scale_param <span class="cf">in</span> scale_params) {</span>
<span id="cb122-28"><a href="#cb122-28" aria-hidden="true" tabindex="-1"></a>    title <span class="ot">&lt;-</span> <span class="fu">str_c</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">"</span>, type, <span class="st">" = $"</span>, <span class="fu">round</span>(scale_param, <span class="dv">2</span>))</span>
<span id="cb122-29"><a href="#cb122-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb122-30"><a href="#cb122-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (sample <span class="cf">in</span> <span class="fu">c</span>(<span class="st">"Calibration"</span>, <span class="st">"Test"</span>)) {</span>
<span id="cb122-31"><a href="#cb122-31" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb122-32"><a href="#cb122-32" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (sample <span class="sc">==</span> <span class="st">"Calibration"</span>){</span>
<span id="cb122-33"><a href="#cb122-33" aria-hidden="true" tabindex="-1"></a>        n_bins_current <span class="ot">&lt;-</span> count_scores <span class="sc">|&gt;</span> </span>
<span id="cb122-34"><a href="#cb122-34" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(transform_scale <span class="sc">==</span> <span class="sc">!!</span>scale_param) <span class="sc">|&gt;</span> <span class="fu">pull</span>(<span class="st">"n_bins_calib"</span>)</span>
<span id="cb122-35"><a href="#cb122-35" aria-hidden="true" tabindex="-1"></a>        n_bins_c_current <span class="ot">&lt;-</span> count_scores <span class="sc">|&gt;</span> </span>
<span id="cb122-36"><a href="#cb122-36" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(transform_scale <span class="sc">==</span> <span class="sc">!!</span>scale_param) <span class="sc">|&gt;</span> <span class="fu">pull</span>(<span class="st">"n_bins_c_calib"</span>)</span>
<span id="cb122-37"><a href="#cb122-37" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb122-38"><a href="#cb122-38" aria-hidden="true" tabindex="-1"></a>        n_bins_current <span class="ot">&lt;-</span> count_scores <span class="sc">|&gt;</span> </span>
<span id="cb122-39"><a href="#cb122-39" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(transform_scale <span class="sc">==</span> <span class="sc">!!</span>scale_param) <span class="sc">|&gt;</span> <span class="fu">pull</span>(<span class="st">"n_bins_test"</span>)</span>
<span id="cb122-40"><a href="#cb122-40" aria-hidden="true" tabindex="-1"></a>        n_bins_c_current <span class="ot">&lt;-</span> count_scores <span class="sc">|&gt;</span> </span>
<span id="cb122-41"><a href="#cb122-41" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(transform_scale <span class="sc">==</span> <span class="sc">!!</span>scale_param) <span class="sc">|&gt;</span> <span class="fu">pull</span>(<span class="st">"n_bins_c_test"</span>)</span>
<span id="cb122-42"><a href="#cb122-42" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb122-43"><a href="#cb122-43" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb122-44"><a href="#cb122-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">4.3</span>, <span class="fl">1.0</span>, <span class="fl">0.5</span>))</span>
<span id="cb122-45"><a href="#cb122-45" aria-hidden="true" tabindex="-1"></a>      y_lim <span class="ot">&lt;-</span> <span class="fu">range</span>(<span class="fu">c</span>(n_bins_current, n_bins_c_current), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb122-46"><a href="#cb122-46" aria-hidden="true" tabindex="-1"></a>      <span class="fu">barplot</span>(</span>
<span id="cb122-47"><a href="#cb122-47" aria-hidden="true" tabindex="-1"></a>        n_bins_current,</span>
<span id="cb122-48"><a href="#cb122-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">"#000000"</span>, <span class="at">alpha.f =</span> .<span class="dv">3</span>),</span>
<span id="cb122-49"><a href="#cb122-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylim =</span> y_lim,</span>
<span id="cb122-50"><a href="#cb122-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="st">"white"</span>,</span>
<span id="cb122-51"><a href="#cb122-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">axes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb122-52"><a href="#cb122-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>, </span>
<span id="cb122-53"><a href="#cb122-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(title)</span>
<span id="cb122-54"><a href="#cb122-54" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb122-55"><a href="#cb122-55" aria-hidden="true" tabindex="-1"></a>      <span class="fu">barplot</span>(</span>
<span id="cb122-56"><a href="#cb122-56" aria-hidden="true" tabindex="-1"></a>        n_bins_c_current,</span>
<span id="cb122-57"><a href="#cb122-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">"#0072B2"</span>, <span class="at">alpha.f =</span> .<span class="dv">3</span>),</span>
<span id="cb122-58"><a href="#cb122-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="st">"white"</span>,</span>
<span id="cb122-59"><a href="#cb122-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">axes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb122-60"><a href="#cb122-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">main =</span> <span class="st">""</span>,</span>
<span id="cb122-61"><a href="#cb122-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">add =</span> <span class="cn">TRUE</span></span>
<span id="cb122-62"><a href="#cb122-62" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb122-63"><a href="#cb122-63" aria-hidden="true" tabindex="-1"></a>      <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">4.1</span>, <span class="fl">4.3</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb122-64"><a href="#cb122-64" aria-hidden="true" tabindex="-1"></a>      tb_current <span class="ot">&lt;-</span> </span>
<span id="cb122-65"><a href="#cb122-65" aria-hidden="true" tabindex="-1"></a>        tb_calibration_curve <span class="sc">|&gt;</span> </span>
<span id="cb122-66"><a href="#cb122-66" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(</span>
<span id="cb122-67"><a href="#cb122-67" aria-hidden="true" tabindex="-1"></a>          scale_parameter <span class="sc">==</span> <span class="sc">!!</span>scale_param,</span>
<span id="cb122-68"><a href="#cb122-68" aria-hidden="true" tabindex="-1"></a>          sample <span class="sc">==</span> <span class="sc">!!</span>sample</span>
<span id="cb122-69"><a href="#cb122-69" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">|&gt;</span> </span>
<span id="cb122-70"><a href="#cb122-70" aria-hidden="true" tabindex="-1"></a>        <span class="fu">group_by</span>(type, scale_parameter, xlim) <span class="sc">|&gt;</span> </span>
<span id="cb122-71"><a href="#cb122-71" aria-hidden="true" tabindex="-1"></a>        <span class="fu">summarise</span>(</span>
<span id="cb122-72"><a href="#cb122-72" aria-hidden="true" tabindex="-1"></a>          <span class="at">lower =</span> <span class="fu">quantile</span>(mean, <span class="at">probs =</span> .<span class="dv">025</span>),</span>
<span id="cb122-73"><a href="#cb122-73" aria-hidden="true" tabindex="-1"></a>          <span class="at">upper =</span> <span class="fu">quantile</span>(mean, <span class="at">probs =</span> .<span class="dv">975</span>),</span>
<span id="cb122-74"><a href="#cb122-74" aria-hidden="true" tabindex="-1"></a>          <span class="at">mean =</span> <span class="fu">mean</span>(mean),</span>
<span id="cb122-75"><a href="#cb122-75" aria-hidden="true" tabindex="-1"></a>          <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb122-76"><a href="#cb122-76" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb122-77"><a href="#cb122-77" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot</span>(</span>
<span id="cb122-78"><a href="#cb122-78" aria-hidden="true" tabindex="-1"></a>        tb_current<span class="sc">$</span>xlim, tb_current<span class="sc">$</span>mean,</span>
<span id="cb122-79"><a href="#cb122-79" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> colours[sample],</span>
<span id="cb122-80"><a href="#cb122-80" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlim =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">ylim =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,</span>
<span id="cb122-81"><a href="#cb122-81" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">"Predicted probability"</span>, <span class="at">ylab =</span> <span class="st">"Mean predicted probability"</span>,</span>
<span id="cb122-82"><a href="#cb122-82" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">""</span></span>
<span id="cb122-83"><a href="#cb122-83" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb122-84"><a href="#cb122-84" aria-hidden="true" tabindex="-1"></a>      <span class="fu">polygon</span>(</span>
<span id="cb122-85"><a href="#cb122-85" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(tb_current<span class="sc">$</span>xlim, <span class="fu">rev</span>(tb_current<span class="sc">$</span>xlim)),</span>
<span id="cb122-86"><a href="#cb122-86" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(tb_current<span class="sc">$</span>lower, <span class="fu">rev</span>(tb_current<span class="sc">$</span>upper)),</span>
<span id="cb122-87"><a href="#cb122-87" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="at">col =</span> colours[sample], <span class="at">alpha.f =</span> .<span class="dv">4</span>),</span>
<span id="cb122-88"><a href="#cb122-88" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="cn">NA</span></span>
<span id="cb122-89"><a href="#cb122-89" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb122-90"><a href="#cb122-90" aria-hidden="true" tabindex="-1"></a>      <span class="fu">segments</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb122-91"><a href="#cb122-91" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb122-92"><a href="#cb122-92" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb122-93"><a href="#cb122-93" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The figures below show a panel of graphs with the calibration curves obtained with the moving average method. Each tab shows the average curve obtained on the 200 replications for a type of recalibration used, as well as the average of the 95% confidence intervals computed on each simulation The first two tab (<code>True Prob.</code> and <code>No Calibration</code>) show the curves obtained using the true probabilities <span class="math inline">\(p\)</span> and the uncalibrated probabilities <span class="math inline">\(p^u\)</span>, instead of the recalibrated probabilities <span class="math inline">\(p^c\)</span>. Each row of the panel in the Figures corresponds to a value for either <span class="math inline">\(\alpha\)</span> or <span class="math inline">\(\gamma\)</span> used to transform <span class="math inline">\(p\)</span> to get <span class="math inline">\(p^u\)</span>. The left column shows the calibration curve obtained on the calibration set whereas the right column shows the calibration curve obtained on the test set. The average distribution (computed over the 200 simulations) of the <span style="\&quot;color:#0000004D\&quot;">uncalibrated scores</span> and of the <span style="\&quot;color:#0072B24D\&quot;">calibrated scores</span> are shown in the histograms on top of each graph.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-22-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-1" role="tab" aria-controls="tabset-22-1" aria-selected="true">For <span class="math inline">\(\alpha\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-2" role="tab" aria-controls="tabset-22-2" aria-selected="false">For <span class="math inline">\(\gamma\)</span></a></li></ul>
<div class="tab-content">
<div id="tabset-22-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-22-1-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-20-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-1" role="tab" aria-controls="tabset-20-1" aria-selected="true">True Prob.</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-2" role="tab" aria-controls="tabset-20-2" aria-selected="false">No Calibration</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-3" role="tab" aria-controls="tabset-20-3" aria-selected="false">Platt Scaling</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-4" role="tab" aria-controls="tabset-20-4" aria-selected="false">Isotonic Reg.</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-5" role="tab" aria-controls="tabset-20-5" aria-selected="false">Beta Calib.</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-6" role="tab" aria-controls="tabset-20-6" aria-selected="false">Local Reg. (deg = 0)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-7" role="tab" aria-controls="tabset-20-7" aria-selected="false">Local Reg. (deg = 1)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-8" role="tab" aria-controls="tabset-20-8" aria-selected="false">Local Reg (deg = 2)</a></li></ul>
<div class="tab-content">
<div id="tabset-20-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-20-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with the moving average method for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-158-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-20-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with the moving average method for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-159-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-20-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-3-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with the moving average method for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-160-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-20-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-4-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with the moving average method for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-161-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-20-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-5-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with the moving average method for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-162-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-20-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-6-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with the moving average method for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-163-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-20-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-7-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with the moving average method for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-164-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-20-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-8-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with the moving average method for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\alpha\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-165-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-22-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-2-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-21-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-1" role="tab" aria-controls="tabset-21-1" aria-selected="true">True Prob.</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-2" role="tab" aria-controls="tabset-21-2" aria-selected="false">No Calibration</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-3" role="tab" aria-controls="tabset-21-3" aria-selected="false">Platt Scaling</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-4" role="tab" aria-controls="tabset-21-4" aria-selected="false">Isotonic Reg.</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-5" role="tab" aria-controls="tabset-21-5" aria-selected="false">Beta Calib.</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-6" role="tab" aria-controls="tabset-21-6" aria-selected="false">Local Reg. (deg = 0)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-7" role="tab" aria-controls="tabset-21-7" aria-selected="false">Local Reg. (deg = 1)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-8" role="tab" aria-controls="tabset-21-8" aria-selected="false">Local Reg (deg = 2)</a></li></ul>
<div class="tab-content">
<div id="tabset-21-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-21-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with the moving average method for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-166-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-21-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with the moving average method for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-167-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-21-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-3-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with the moving average method for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-168-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-21-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-4-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with the moving average method for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-169-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-21-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-5-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with the moving average method for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-170-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-21-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-6-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with the moving average method for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-171-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-21-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-7-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with the moving average method for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-172-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-21-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-8-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Calibration curves obtained with recalibrated scores. The curves are obtained with the moving average method for the <span style="color:#D55E00">calibration set</span> (left) and for the <span style="color:#009E73">test set</span> (right) for varying values of <span class="math inline">\(\gamma\)</span> for 200 replication of the simulations. The histogram on top of each graph show the distribution of the <span style="color:#0000004D">uncalibrated scores</span>, and that of the <span style="color:#0072B24D">calibrated scores</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-173-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="boxplots-of-the-metrics" class="level2" data-number="2.8">
<h2 data-number="2.8" class="anchored" data-anchor-id="boxplots-of-the-metrics"><span class="header-section-number">2.8</span> Boxplots of the Metrics</h2>
<p>We now focus on the calibration metrics</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>calib_metrics_simul_alpha <span class="ot">&lt;-</span> <span class="fu">map</span>(simul_recalib_alpha, <span class="st">"calib_metrics"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list_rbind</span>()</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>calib_metrics_simul_gamma <span class="ot">&lt;-</span> <span class="fu">map</span>(simul_recalib_gamma, <span class="st">"calib_metrics"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list_rbind</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us put all the metrics computed for all the simulations in a single tibble.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>calib_metrics_simul <span class="ot">&lt;-</span> calib_metrics_simul_alpha <span class="sc">|&gt;</span> </span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(calib_metrics_simul_gamma) <span class="sc">|&gt;</span> </span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(mse, brier, ece, qmse, wmse, lcs),</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"metric"</span>, <span class="at">values_to =</span> <span class="st">"value"</span></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">metric =</span> <span class="fu">factor</span>(</span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>      metric,</span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"mse"</span>, <span class="st">"brier"</span>, <span class="st">"ece"</span>, <span class="st">"qmse"</span>, <span class="st">"wmse"</span>, <span class="st">"lcs"</span>),</span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"True MSE"</span>, <span class="st">"Brier Score"</span>, <span class="st">"ECE"</span>, <span class="st">"QMSE"</span>, <span class="st">"WMSE"</span>, <span class="st">"LCS"</span>)</span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="fu">factor</span>(</span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a>      method,</span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(</span>
<span id="cb124-16"><a href="#cb124-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">"True Prob."</span>, <span class="st">"No Calibration"</span>, </span>
<span id="cb124-17"><a href="#cb124-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">"platt"</span>, <span class="st">"isotonic"</span>, <span class="st">"beta"</span>, <span class="st">"locfit_0"</span>, <span class="st">"locfit_1"</span>, <span class="st">"locfit_2"</span>),</span>
<span id="cb124-18"><a href="#cb124-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb124-19"><a href="#cb124-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">"True Prob."</span>, <span class="st">"No Calibration"</span>, </span>
<span id="cb124-20"><a href="#cb124-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Platt Scaling"</span>, <span class="st">"Isotonic Reg."</span>, <span class="st">"Beta Calib."</span>,</span>
<span id="cb124-21"><a href="#cb124-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Local Reg. (deg = 0)"</span>, <span class="st">"Local Reg. (deg = 1)"</span>, <span class="st">"Local Reg (deg = 2)"</span></span>
<span id="cb124-22"><a href="#cb124-22" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb124-23"><a href="#cb124-23" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb124-24"><a href="#cb124-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample =</span> <span class="fu">factor</span>(</span>
<span id="cb124-25"><a href="#cb124-25" aria-hidden="true" tabindex="-1"></a>      sample,</span>
<span id="cb124-26"><a href="#cb124-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Calibration"</span>, <span class="st">"Test"</span>)</span>
<span id="cb124-27"><a href="#cb124-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb124-28"><a href="#cb124-28" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, we create a function, <code class="sourceCode r"><span class="fu">plot_boxplot_metric</span>()</code> to graph boxplots for a metric, for each value of <span class="math inline">\(\alpha\)</span> or <span class="math inline">\(\gamma\)</span> (x-asis). The y-axis show the values of the desired metric. Each panel of the figure uses a specific predicted score:</p>
<ul>
<li><code>True Proba</code>: <span class="math inline">\(p^c := p\)</span> the true probabilities from the DGP</li>
<li><code>No Calibration</code>: <span class="math inline">\(p^c := p^u\)</span> the transformed probabilities</li>
<li><code>Platt Scaling</code>: <span class="math inline">\(p^c := g^{\text{platt}}(p^u)\)</span> scores recalibrated using Platt Scaling</li>
<li><code>Isotonic Reg.</code>: <span class="math inline">\(p^c := g^{\text{iso}}(p^u)\)</span> scores recalibrated using isotonic regression</li>
<li><code>Beta Calib.</code>: <span class="math inline">\(p^c := g^{\text{beta}}(p^u)\)</span> scores recalibrated using beta calibration</li>
<li><code>Local Reg. (deg = 0)</code>: <span class="math inline">\(p^c := g^{\text{locfit}}(p^u, 0)\)</span> scores recalibrated using local regression with degree 0</li>
<li><code>Local Reg. (deg = 1)</code>: <span class="math inline">\(p^c := g^{\text{locfit}}(p^u, 1)\)</span> scores recalibrated using local regression with degree 1</li>
<li><code>Local Reg. (deg = 2)</code>: <span class="math inline">\(p^c := g^{\text{locfit}}(p^u, 2)\)</span> scores recalibrated using local regression with degree 2.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>plot_boxplot_metric <span class="ot">&lt;-</span> <span class="cf">function</span>(metric, </span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>                                calib_metrics_simul,</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>                                type) {</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>  data_plot <span class="ot">&lt;-</span> calib_metrics_simul <span class="sc">|&gt;</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(metric <span class="sc">==</span> <span class="sc">!!</span>metric, type <span class="sc">==</span> <span class="sc">!!</span>type) <span class="sc">|&gt;</span> </span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(transform_scale)</span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>  methods <span class="ot">&lt;-</span> <span class="fu">levels</span>(data_plot<span class="sc">$</span>method)</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>  labels_y <span class="ot">&lt;-</span> <span class="fu">unique</span>(data_plot<span class="sc">$</span>transform_scale) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>))</span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (method <span class="cf">in</span> methods) {</span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a>    data_plot_current <span class="ot">&lt;-</span> data_plot <span class="sc">|&gt;</span> <span class="fu">filter</span>(method <span class="sc">==</span> <span class="sc">!!</span>method)</span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># par(mar = c(2.1, 12.1, 2.1, 2.1))</span></span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">3.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span>, <span class="fl">2.1</span>))</span>
<span id="cb125-17"><a href="#cb125-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">boxplot</span>(</span>
<span id="cb125-18"><a href="#cb125-18" aria-hidden="true" tabindex="-1"></a>      value <span class="sc">~</span> sample <span class="sc">+</span> transform_scale,</span>
<span id="cb125-19"><a href="#cb125-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> data_plot_current,</span>
<span id="cb125-20"><a href="#cb125-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"#D55E00"</span>, <span class="st">"#009E73"</span>),</span>
<span id="cb125-21"><a href="#cb125-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">horizontal =</span> <span class="cn">FALSE</span>,</span>
<span id="cb125-22"><a href="#cb125-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> method,</span>
<span id="cb125-23"><a href="#cb125-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb125-24"><a href="#cb125-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">xaxt =</span> <span class="st">"n"</span></span>
<span id="cb125-25"><a href="#cb125-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb125-26"><a href="#cb125-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ind_benchmark &lt;- which(labels_y == 1)</span></span>
<span id="cb125-27"><a href="#cb125-27" aria-hidden="true" tabindex="-1"></a>    labs_y <span class="ot">&lt;-</span> <span class="fu">str_c</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">"</span>, type, <span class="st">"="</span>, labels_y, <span class="st">"$"</span>)</span>
<span id="cb125-28"><a href="#cb125-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># labs_y[ind_benchmark] &lt;- str_c(labs_y[ind_benchmark], " (benchmark)")</span></span>
<span id="cb125-29"><a href="#cb125-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">axis</span>(</span>
<span id="cb125-30"><a href="#cb125-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">2</span><span class="sc">*</span><span class="fu">length</span>(labels_y), <span class="at">by =</span> <span class="dv">2</span>) <span class="sc">+</span> .<span class="dv">5</span>, </span>
<span id="cb125-31"><a href="#cb125-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(labs_y),</span>
<span id="cb125-32"><a href="#cb125-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">las =</span> <span class="dv">1</span>,</span>
<span id="cb125-33"><a href="#cb125-33" aria-hidden="true" tabindex="-1"></a>      <span class="co"># col.axis = "black"</span></span>
<span id="cb125-34"><a href="#cb125-34" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb125-35"><a href="#cb125-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># # Horizontal lines</span></span>
<span id="cb125-36"><a href="#cb125-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># for (i in seq(1, 2*(length(labels_y)-1), by = 2) + 1.5) {</span></span>
<span id="cb125-37"><a href="#cb125-37" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   abline(h = i, lty = 1, col = "gray")</span></span>
<span id="cb125-38"><a href="#cb125-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># }</span></span>
<span id="cb125-39"><a href="#cb125-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Vertical lines</span></span>
<span id="cb125-40"><a href="#cb125-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">2</span><span class="sc">*</span>(<span class="fu">length</span>(labels_y)<span class="sc">-</span><span class="dv">1</span>), <span class="at">by =</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="fl">1.5</span>) {</span>
<span id="cb125-41"><a href="#cb125-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">abline</span>(<span class="at">v =</span> i, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"gray"</span>)</span>
<span id="cb125-42"><a href="#cb125-42" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb125-43"><a href="#cb125-43" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb125-44"><a href="#cb125-44" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-25-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-1" role="tab" aria-controls="tabset-25-1" aria-selected="true">Varying <span class="math inline">\(\alpha\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-2" role="tab" aria-controls="tabset-25-2" aria-selected="false">Varying <span class="math inline">\(\gamma\)</span></a></li></ul>
<div class="tab-content">
<div id="tabset-25-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-25-1-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-23-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-1" role="tab" aria-controls="tabset-23-1" aria-selected="true">True MSE</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-2" role="tab" aria-controls="tabset-23-2" aria-selected="false">Brier Score</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-3" role="tab" aria-controls="tabset-23-3" aria-selected="false">ECE</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-4" role="tab" aria-controls="tabset-23-4" aria-selected="false">QMSE</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-5" role="tab" aria-controls="tabset-23-5" aria-selected="false">WMSE</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-6" role="tab" aria-controls="tabset-23-6" aria-selected="false">LCS</a></li></ul>
<div class="tab-content">
<div id="tabset-23-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-23-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Distribution of True MSE computed over the 200 replications, on the <span style="color:#D55E00">calibration set</span> and on <span style="color:#009E73">test set</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-174-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-23-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Distribution of Brier Score computed over the 200 replications, on the <span style="color:#D55E00">calibration set</span> and on <span style="color:#009E73">test set</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-175-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-23-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-3-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Distribution of ECE computed over the 200 replications, on the <span style="color:#D55E00">calibration set</span> and on <span style="color:#009E73">test set</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-176-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-23-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-4-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Distribution of QMSE computed over the 200 replications, on the <span style="color:#D55E00">calibration set</span> and on <span style="color:#009E73">test set</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-177-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-23-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-5-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Distribution of WMSE computed over the 200 replications, on the <span style="color:#D55E00">calibration set</span> and on <span style="color:#009E73">test set</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-178-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-23-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-6-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Distribution of LCS computed over the 200 replications, on the <span style="color:#D55E00">calibration set</span> and on <span style="color:#009E73">test set</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-179-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-25-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-25-2-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-24-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-1" role="tab" aria-controls="tabset-24-1" aria-selected="true">True MSE</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-2" role="tab" aria-controls="tabset-24-2" aria-selected="false">Brier Score</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-3" role="tab" aria-controls="tabset-24-3" aria-selected="false">ECE</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-4" role="tab" aria-controls="tabset-24-4" aria-selected="false">QMSE</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-5" role="tab" aria-controls="tabset-24-5" aria-selected="false">WMSE</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-6" role="tab" aria-controls="tabset-24-6" aria-selected="false">LCS</a></li></ul>
<div class="tab-content">
<div id="tabset-24-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-24-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Distribution of True MSE computed over the 200 replications, on the <span style="color:#D55E00">calibration set</span> and on <span style="color:#009E73">test set</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-180-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-24-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Distribution of Brier Score computed over the 200 replications, on the <span style="color:#D55E00">calibration set</span> and on <span style="color:#009E73">test set</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-181-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-24-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-3-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Distribution of ECE computed over the 200 replications, on the <span style="color:#D55E00">calibration set</span> and on <span style="color:#009E73">test set</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-182-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-24-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-4-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Distribution of QMSE computed over the 200 replications, on the <span style="color:#D55E00">calibration set</span> and on <span style="color:#009E73">test set</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-183-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-24-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-5-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Distribution of WMSE computed over the 200 replications, on the <span style="color:#D55E00">calibration set</span> and on <span style="color:#009E73">test set</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-184-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-24-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-6-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption class="figure-caption">Distribution of LCS computed over the 200 replications, on the <span style="color:#D55E00">calibration set</span> and on <span style="color:#009E73">test set</span></figcaption>
<p><img src="recalibration_files/figure-html/unnamed-chunk-185-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p>We can visualize this in a different way.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>boxplot_std_metrics_calib <span class="ot">&lt;-</span> <span class="cf">function</span>(tb_calib_metrics, metric, <span class="at">x_lim =</span> <span class="cn">NULL</span>) {</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>  scale_parameters <span class="ot">&lt;-</span> <span class="fu">unique</span>(tb_calib_metrics<span class="sc">$</span>transform_scale)</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  nb <span class="ot">&lt;-</span> <span class="fu">length</span>(scale_parameters)</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>  mat <span class="ot">&lt;-</span> mat_init <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>(<span class="dv">2</span><span class="sc">*</span>nb), <span class="fu">rep</span>(<span class="dv">2</span><span class="sc">*</span>nb<span class="sc">+</span><span class="dv">1</span>, nb)), <span class="at">ncol =</span> nb, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># colours_calib &lt;- c(</span></span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   "#332288", </span></span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   # "#117733", </span></span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   "#44AA99", "#88CCEE",</span></span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   "#DDCC77", "#CC6677", "#AA4499", "#882255") |&gt; rev()</span></span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a>  colours_names <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"True Prob."</span>,</span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"No Calibration"</span>, <span class="st">"Platt"</span>, <span class="st">"Isotonic"</span>, <span class="st">"Beta"</span>, </span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Locfit (deg=0)"</span>, <span class="st">"Locfit (deg=1)"</span>, <span class="st">"Locfit (deg=2)"</span></span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb126-17"><a href="#cb126-17" aria-hidden="true" tabindex="-1"></a>  colours_calib <span class="ot">&lt;-</span> colours_legend <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb126-18"><a href="#cb126-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"#332288"</span>, <span class="st">"#117733"</span>, <span class="st">"#44AA99"</span>, <span class="st">"#88CCEE"</span>,</span>
<span id="cb126-19"><a href="#cb126-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"#DDCC77"</span>, <span class="st">"#CC6677"</span>, <span class="st">"#AA4499"</span>, <span class="st">"#882255"</span></span>
<span id="cb126-20"><a href="#cb126-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb126-21"><a href="#cb126-21" aria-hidden="true" tabindex="-1"></a>  colours_test <span class="ot">&lt;-</span> <span class="fu">adjustcolor</span>(colours_calib, <span class="at">alpha.f =</span> .<span class="dv">5</span>)</span>
<span id="cb126-22"><a href="#cb126-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb126-23"><a href="#cb126-23" aria-hidden="true" tabindex="-1"></a>  colours <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb126-24"><a href="#cb126-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(colours_calib)) </span>
<span id="cb126-25"><a href="#cb126-25" aria-hidden="true" tabindex="-1"></a>    colours <span class="ot">&lt;-</span> <span class="fu">c</span>(colours, colours_calib[k], colours_test[k])</span>
<span id="cb126-26"><a href="#cb126-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb126-27"><a href="#cb126-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb126-28"><a href="#cb126-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(mat, <span class="at">heights =</span> <span class="fu">c</span>(.<span class="dv">45</span>, .<span class="dv">45</span>, .<span class="dv">15</span>))</span>
<span id="cb126-29"><a href="#cb126-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb126-30"><a href="#cb126-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (type <span class="cf">in</span> <span class="fu">unique</span>(tb_calib_metrics<span class="sc">$</span>type)) {</span>
<span id="cb126-31"><a href="#cb126-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i_scale <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(scale_parameters)) {</span>
<span id="cb126-32"><a href="#cb126-32" aria-hidden="true" tabindex="-1"></a>      scale_parameter <span class="ot">&lt;-</span> scale_parameters[i_scale]</span>
<span id="cb126-33"><a href="#cb126-33" aria-hidden="true" tabindex="-1"></a>      tb_metrics_current <span class="ot">&lt;-</span> tb_calib_metrics <span class="sc">|&gt;</span> </span>
<span id="cb126-34"><a href="#cb126-34" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(</span>
<span id="cb126-35"><a href="#cb126-35" aria-hidden="true" tabindex="-1"></a>          transform_scale <span class="sc">==</span> <span class="sc">!!</span>scale_parameter, </span>
<span id="cb126-36"><a href="#cb126-36" aria-hidden="true" tabindex="-1"></a>          type <span class="sc">==</span> <span class="sc">!!</span>type,</span>
<span id="cb126-37"><a href="#cb126-37" aria-hidden="true" tabindex="-1"></a>          metric <span class="sc">==</span> <span class="sc">!!</span>metric</span>
<span id="cb126-38"><a href="#cb126-38" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">|&gt;</span> </span>
<span id="cb126-39"><a href="#cb126-39" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(</span>
<span id="cb126-40"><a href="#cb126-40" aria-hidden="true" tabindex="-1"></a>          <span class="at">method =</span> <span class="fu">fct_rev</span>(<span class="fu">fct_drop</span>(method))</span>
<span id="cb126-41"><a href="#cb126-41" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb126-42"><a href="#cb126-42" aria-hidden="true" tabindex="-1"></a>      title <span class="ot">&lt;-</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(</span>
<span id="cb126-43"><a href="#cb126-43" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_c</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">"</span>, type, <span class="st">" = "</span>, <span class="fu">round</span>(scale_parameter, <span class="dv">2</span>), <span class="st">"$"</span>)</span>
<span id="cb126-44"><a href="#cb126-44" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb126-45"><a href="#cb126-45" aria-hidden="true" tabindex="-1"></a>      methods_bp <span class="ot">&lt;-</span> tb_metrics_current<span class="sc">$</span>method <span class="sc">|&gt;</span> <span class="fu">levels</span>()</span>
<span id="cb126-46"><a href="#cb126-46" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb126-47"><a href="#cb126-47" aria-hidden="true" tabindex="-1"></a>      ind_colours <span class="ot">&lt;-</span> <span class="fu">match</span>(methods_bp, colours_names)</span>
<span id="cb126-48"><a href="#cb126-48" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb126-49"><a href="#cb126-49" aria-hidden="true" tabindex="-1"></a>      colours <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb126-50"><a href="#cb126-50" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(colours_calib[ind_colours])) </span>
<span id="cb126-51"><a href="#cb126-51" aria-hidden="true" tabindex="-1"></a>        colours <span class="ot">&lt;-</span> <span class="fu">c</span>(colours, colours_calib[ind_colours][k], </span>
<span id="cb126-52"><a href="#cb126-52" aria-hidden="true" tabindex="-1"></a>                     colours_test[ind_colours][k])</span>
<span id="cb126-53"><a href="#cb126-53" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb126-54"><a href="#cb126-54" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb126-55"><a href="#cb126-55" aria-hidden="true" tabindex="-1"></a>      form <span class="ot">&lt;-</span> <span class="fu">str_c</span>(<span class="st">"value~sample + method"</span>)</span>
<span id="cb126-56"><a href="#cb126-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">1.5</span>, <span class="fl">3.1</span>, <span class="dv">1</span>))</span>
<span id="cb126-57"><a href="#cb126-57" aria-hidden="true" tabindex="-1"></a>      <span class="fu">boxplot</span>(</span>
<span id="cb126-58"><a href="#cb126-58" aria-hidden="true" tabindex="-1"></a>        <span class="fu">formula</span>(form), </span>
<span id="cb126-59"><a href="#cb126-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> tb_metrics_current <span class="sc">|&gt;</span> </span>
<span id="cb126-60"><a href="#cb126-60" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(</span>
<span id="cb126-61"><a href="#cb126-61" aria-hidden="true" tabindex="-1"></a>            <span class="at">sample =</span> <span class="fu">fct_rev</span>(sample)</span>
<span id="cb126-62"><a href="#cb126-62" aria-hidden="true" tabindex="-1"></a>            <span class="co"># method = fct_rev(method)</span></span>
<span id="cb126-63"><a href="#cb126-63" aria-hidden="true" tabindex="-1"></a>          ),</span>
<span id="cb126-64"><a href="#cb126-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">""</span>,</span>
<span id="cb126-65"><a href="#cb126-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb126-66"><a href="#cb126-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> title,</span>
<span id="cb126-67"><a href="#cb126-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">horizontal =</span> <span class="cn">TRUE</span>,</span>
<span id="cb126-68"><a href="#cb126-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">las =</span> <span class="dv">1</span>,</span>
<span id="cb126-69"><a href="#cb126-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> colours,</span>
<span id="cb126-70"><a href="#cb126-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylim =</span> x_lim,</span>
<span id="cb126-71"><a href="#cb126-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="fu">adjustcolor</span>(<span class="st">"black"</span>, <span class="at">alpha.f =</span> .<span class="dv">5</span>)),</span>
<span id="cb126-72"><a href="#cb126-72" aria-hidden="true" tabindex="-1"></a>        <span class="co"># sep = ", "</span></span>
<span id="cb126-73"><a href="#cb126-73" aria-hidden="true" tabindex="-1"></a>        <span class="at">yaxt =</span> <span class="st">"n"</span></span>
<span id="cb126-74"><a href="#cb126-74" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb126-75"><a href="#cb126-75" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Horizontal lines</span></span>
<span id="cb126-76"><a href="#cb126-76" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">3</span>, <span class="fu">length</span>(methods_bp) <span class="sc">*</span> <span class="dv">2</span>, <span class="at">by =</span> <span class="dv">2</span>) <span class="sc">-</span> .<span class="dv">5</span>) {</span>
<span id="cb126-77"><a href="#cb126-77" aria-hidden="true" tabindex="-1"></a>        <span class="fu">abline</span>(<span class="at">h =</span> i, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"gray"</span>)</span>
<span id="cb126-78"><a href="#cb126-78" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb126-79"><a href="#cb126-79" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb126-80"><a href="#cb126-80" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb126-81"><a href="#cb126-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">4.3</span>, <span class="dv">0</span>, <span class="fl">4.3</span>))</span>
<span id="cb126-82"><a href="#cb126-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot.new</span>()</span>
<span id="cb126-83"><a href="#cb126-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(</span>
<span id="cb126-84"><a href="#cb126-84" aria-hidden="true" tabindex="-1"></a>    <span class="st">"center"</span>, </span>
<span id="cb126-85"><a href="#cb126-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> colours_names,</span>
<span id="cb126-86"><a href="#cb126-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> colours_legend,</span>
<span id="cb126-87"><a href="#cb126-87" aria-hidden="true" tabindex="-1"></a>    <span class="co"># lwd = 2,</span></span>
<span id="cb126-88"><a href="#cb126-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">xpd =</span> <span class="cn">TRUE</span>, <span class="at">ncol =</span> <span class="dv">4</span></span>
<span id="cb126-89"><a href="#cb126-89" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb126-90"><a href="#cb126-90" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard Metrics</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>standard_metrics <span class="ot">&lt;-</span> recalib_metrics_alpha <span class="sc">|&gt;</span> </span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(recalib_metrics_gamma) <span class="sc">|&gt;</span> </span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Without recalibration</span></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>    metrics_alpha <span class="sc">|&gt;</span> </span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">method =</span> <span class="st">"No Calibration"</span>)</span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(</span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a>    metrics_gamma <span class="sc">|&gt;</span> </span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">method =</span> <span class="st">"No Calibration"</span>)</span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(threshold <span class="sc">==</span> .<span class="dv">5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb127-14"><a href="#cb127-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">transform_scale =</span> scale_parameter) <span class="sc">|&gt;</span> </span>
<span id="cb127-15"><a href="#cb127-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb127-16"><a href="#cb127-16" aria-hidden="true" tabindex="-1"></a>    sample, seed, transform_scale, type, method, </span>
<span id="cb127-17"><a href="#cb127-17" aria-hidden="true" tabindex="-1"></a>    mse, accuracy, sensitivity, specificity, auc</span>
<span id="cb127-18"><a href="#cb127-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb127-19"><a href="#cb127-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb127-20"><a href="#cb127-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(mse, accuracy, sensitivity, specificity, auc), </span>
<span id="cb127-21"><a href="#cb127-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"metric"</span>,</span>
<span id="cb127-22"><a href="#cb127-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"value"</span></span>
<span id="cb127-23"><a href="#cb127-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb127-24"><a href="#cb127-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-25"><a href="#cb127-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Calibration metrics</span></span>
<span id="cb127-26"><a href="#cb127-26" aria-hidden="true" tabindex="-1"></a>calib_metrics_simul_alpha <span class="ot">&lt;-</span> <span class="fu">map</span>(simul_recalib_alpha, <span class="st">"calib_metrics"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb127-27"><a href="#cb127-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list_rbind</span>()</span>
<span id="cb127-28"><a href="#cb127-28" aria-hidden="true" tabindex="-1"></a>calib_metrics_simul_gamma <span class="ot">&lt;-</span> <span class="fu">map</span>(simul_recalib_gamma, <span class="st">"calib_metrics"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb127-29"><a href="#cb127-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list_rbind</span>()</span>
<span id="cb127-30"><a href="#cb127-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-31"><a href="#cb127-31" aria-hidden="true" tabindex="-1"></a>calib_metrics_simul <span class="ot">&lt;-</span> calib_metrics_simul_alpha <span class="sc">|&gt;</span> </span>
<span id="cb127-32"><a href="#cb127-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(calib_metrics_simul_gamma) <span class="sc">|&gt;</span> </span>
<span id="cb127-33"><a href="#cb127-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb127-34"><a href="#cb127-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(mse, brier, ece, qmse, wmse, lcs),</span>
<span id="cb127-35"><a href="#cb127-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"metric"</span>, <span class="at">values_to =</span> <span class="st">"value"</span></span>
<span id="cb127-36"><a href="#cb127-36" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb127-37"><a href="#cb127-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb127-38"><a href="#cb127-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">metric =</span> <span class="fu">factor</span>(</span>
<span id="cb127-39"><a href="#cb127-39" aria-hidden="true" tabindex="-1"></a>      metric,</span>
<span id="cb127-40"><a href="#cb127-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"mse"</span>, <span class="st">"brier"</span>, <span class="st">"ece"</span>, <span class="st">"qmse"</span>, <span class="st">"wmse"</span>, <span class="st">"lcs"</span>),</span>
<span id="cb127-41"><a href="#cb127-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"True MSE"</span>, <span class="st">"Brier Score"</span>, <span class="st">"ECE"</span>, <span class="st">"QMSE"</span>, <span class="st">"WMSE"</span>, <span class="st">"LCS"</span>)</span>
<span id="cb127-42"><a href="#cb127-42" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb127-43"><a href="#cb127-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample =</span> <span class="fu">case_when</span>(</span>
<span id="cb127-44"><a href="#cb127-44" aria-hidden="true" tabindex="-1"></a>      sample <span class="sc">==</span> <span class="st">"Calibration"</span><span class="sc">~</span><span class="st">"calibration"</span>,</span>
<span id="cb127-45"><a href="#cb127-45" aria-hidden="true" tabindex="-1"></a>      sample <span class="sc">==</span> <span class="st">"Test"</span><span class="sc">~</span><span class="st">"test"</span>,</span>
<span id="cb127-46"><a href="#cb127-46" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span><span class="sc">~</span><span class="cn">NA_character_</span></span>
<span id="cb127-47"><a href="#cb127-47" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb127-48"><a href="#cb127-48" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb127-49"><a href="#cb127-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-50"><a href="#cb127-50" aria-hidden="true" tabindex="-1"></a>metrics_all <span class="ot">&lt;-</span> </span>
<span id="cb127-51"><a href="#cb127-51" aria-hidden="true" tabindex="-1"></a>  calib_metrics_simul <span class="sc">|&gt;</span> </span>
<span id="cb127-52"><a href="#cb127-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(standard_metrics) <span class="sc">|&gt;</span> </span>
<span id="cb127-53"><a href="#cb127-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb127-54"><a href="#cb127-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="fu">factor</span>(</span>
<span id="cb127-55"><a href="#cb127-55" aria-hidden="true" tabindex="-1"></a>      method,</span>
<span id="cb127-56"><a href="#cb127-56" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"True Prob."</span>, <span class="st">"No Calibration"</span>,</span>
<span id="cb127-57"><a href="#cb127-57" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"platt"</span>, <span class="st">"isotonic"</span>, <span class="st">"beta"</span>, <span class="st">"locfit_0"</span>, <span class="st">"locfit_1"</span>, <span class="st">"locfit_2"</span>),</span>
<span id="cb127-58"><a href="#cb127-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb127-59"><a href="#cb127-59" aria-hidden="true" tabindex="-1"></a>        <span class="st">"True Prob."</span>,</span>
<span id="cb127-60"><a href="#cb127-60" aria-hidden="true" tabindex="-1"></a>        <span class="st">"No Calibration"</span>, <span class="st">"Platt"</span>, <span class="st">"Isotonic"</span>, <span class="st">"Beta"</span>, </span>
<span id="cb127-61"><a href="#cb127-61" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Locfit (deg=0)"</span>, <span class="st">"Locfit (deg=1)"</span>, <span class="st">"Locfit (deg=2)"</span>)</span>
<span id="cb127-62"><a href="#cb127-62" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb127-63"><a href="#cb127-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample =</span> <span class="fu">factor</span>(</span>
<span id="cb127-64"><a href="#cb127-64" aria-hidden="true" tabindex="-1"></a>      sample, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"calibration"</span>, <span class="st">"test"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Calibration"</span>, <span class="st">"Test"</span>)</span>
<span id="cb127-65"><a href="#cb127-65" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb127-66"><a href="#cb127-66" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-26-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-1" role="tab" aria-controls="tabset-26-1" aria-selected="true">True MSE</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-2" role="tab" aria-controls="tabset-26-2" aria-selected="false">LCS</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-3" role="tab" aria-controls="tabset-26-3" aria-selected="false">Brier Score</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-4" role="tab" aria-controls="tabset-26-4" aria-selected="false">ECE</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-5" role="tab" aria-controls="tabset-26-5" aria-selected="false">WMSE</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-6" role="tab" aria-controls="tabset-26-6" aria-selected="false">Accuracy</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-7" role="tab" aria-controls="tabset-26-7" aria-selected="false">Sensitivity</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-8" role="tab" aria-controls="tabset-26-8" aria-selected="false">Specificity</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-9-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-9" role="tab" aria-controls="tabset-26-9" aria-selected="false">AUC</a></li></ul>
<div class="tab-content">
<div id="tabset-26-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-26-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot_std_metrics_calib</span>(</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">tb_calib_metrics =</span> metrics_all <span class="sc">|&gt;</span> </span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(transform_scale <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>)),</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">metric =</span> <span class="st">"True MSE"</span></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-recalib-simuls-metrics-truemse" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.35: True MSE on 200 Simulations for each Value of <span class="math inline">\(\alpha\)</span> (top) or <span class="math inline">\(\gamma\)</span> (bottom), on the Calibration (transparent colors) and on the Test Set (full colors). The metrics are computed for different definitions of the scores: using the true probabilities, the non calibrated scores, or the recalibrated scores.</figcaption>
<p><img src="recalibration_files/figure-html/fig-recalib-simuls-metrics-truemse-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-26-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot_std_metrics_calib</span>(</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">tb_calib_metrics =</span> metrics_all <span class="sc">|&gt;</span> </span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(transform_scale <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>)),</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">metric =</span> <span class="st">"LCS"</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-recalib-simuls-metrics-lcs" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.36: LCS on 200 Simulations for each Value of <span class="math inline">\(\alpha\)</span> (top) or <span class="math inline">\(\gamma\)</span> (bottom), on the Calibration (transparent colors) and on the Test Set (full colors). The metrics are computed for different definitions of the scores: using the true probabilities, the non calibrated scores, or the recalibrated scores.</figcaption>
<p><img src="recalibration_files/figure-html/fig-recalib-simuls-metrics-lcs-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-26-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot_std_metrics_calib</span>(</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">tb_calib_metrics =</span> metrics_all <span class="sc">|&gt;</span> </span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(transform_scale <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>)),</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">metric =</span> <span class="st">"Brier Score"</span></span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-recalib-simuls-metrics-brier" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.37: Brier Score on 200 Simulations for each Value of <span class="math inline">\(\alpha\)</span> (top) or <span class="math inline">\(\gamma\)</span> (bottom), on the Calibration (transparent colors) and on the Test Set (full colors). The metrics are computed for different definitions of the scores: using the true probabilities, the non calibrated scores, or the recalibrated scores.</figcaption>
<p><img src="recalibration_files/figure-html/fig-recalib-simuls-metrics-brier-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-26-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot_std_metrics_calib</span>(</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">tb_calib_metrics =</span> metrics_all <span class="sc">|&gt;</span> </span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(transform_scale <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>)),</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">metric =</span> <span class="st">"ECE"</span></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-recalib-simuls-metrics-ece" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.38: ECE on 200 Simulations for each Value of <span class="math inline">\(\alpha\)</span> (top) or <span class="math inline">\(\gamma\)</span> (bottom), on the Calibration (transparent colors) and on the Test Set (full colors). The metrics are computed for different definitions of the scores: using the true probabilities, the non calibrated scores, or the recalibrated scores.</figcaption>
<p><img src="recalibration_files/figure-html/fig-recalib-simuls-metrics-ece-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-26-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot_std_metrics_calib</span>(</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">tb_calib_metrics =</span> metrics_all <span class="sc">|&gt;</span> </span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(transform_scale <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>)),</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">metric =</span> <span class="st">"WMSE"</span></span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-recalib-simuls-metrics-mwse" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.39: WMSE on 200 Simulations for each Value of <span class="math inline">\(\alpha\)</span> (top) or <span class="math inline">\(\gamma\)</span> (bottom), on the Calibration (transparent colors) and on the Test Set (full colors). The metrics are computed for different definitions of the scores: using the true probabilities, the non calibrated scores, or the recalibrated scores.</figcaption>
<p><img src="recalibration_files/figure-html/fig-recalib-simuls-metrics-mwse-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-26-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-6-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot_std_metrics_calib</span>(</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">tb_calib_metrics =</span> metrics_all <span class="sc">|&gt;</span> </span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(transform_scale <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>)),</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">metric =</span> <span class="st">"accuracy"</span></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-recalib-simuls-metrics-accuracy" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.40: Accuracy on 200 Simulations for each Value of <span class="math inline">\(\alpha\)</span> (top) or <span class="math inline">\(\gamma\)</span> (bottom), on the Calibration (transparent colors) and on the Test Set (full colors). The metrics are computed for different definitions of the scores: using the true probabilities, the non calibrated scores, or the recalibrated scores.</figcaption>
<p><img src="recalibration_files/figure-html/fig-recalib-simuls-metrics-accuracy-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-26-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-7-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot_std_metrics_calib</span>(</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">tb_calib_metrics =</span> metrics_all <span class="sc">|&gt;</span> </span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(transform_scale <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>)),</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">metric =</span> <span class="st">"sensitivity"</span></span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-recalib-simuls-metrics-sensitivity" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.41: Sensitivity on 200 Simulations for each Value of <span class="math inline">\(\alpha\)</span> (top) or <span class="math inline">\(\gamma\)</span> (bottom), on the Calibration (transparent colors) and on the Test Set (full colors). The metrics are computed for different definitions of the scores: using the true probabilities, the non calibrated scores, or the recalibrated scores.</figcaption>
<p><img src="recalibration_files/figure-html/fig-recalib-simuls-metrics-sensitivity-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-26-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-8-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot_std_metrics_calib</span>(</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">tb_calib_metrics =</span> metrics_all <span class="sc">|&gt;</span> </span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(transform_scale <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>)),</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">metric =</span> <span class="st">"specificity"</span></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-recalib-simuls-metrics-specificity" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.42: Specificity on 200 Simulations for each Value of <span class="math inline">\(\alpha\)</span> (top) or <span class="math inline">\(\gamma\)</span> (bottom), on the Calibration (transparent colors) and on the Test Set (full colors). The metrics are computed for different definitions of the scores: using the true probabilities, the non calibrated scores, or the recalibrated scores.</figcaption>
<p><img src="recalibration_files/figure-html/fig-recalib-simuls-metrics-specificity-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-26-9" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-9-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot_std_metrics_calib</span>(</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">tb_calib_metrics =</span> metrics_all <span class="sc">|&gt;</span> </span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(transform_scale <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>)),</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">metric =</span> <span class="st">"auc"</span></span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-recalib-simuls-metrics-auc" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<figcaption class="figure-caption">Figure&nbsp;2.43: AUC on 200 Simulations for each Value of <span class="math inline">\(\alpha\)</span> (top) or <span class="math inline">\(\gamma\)</span> (bottom), on the Calibration (transparent colors) and on the Test Set (full colors). The metrics are computed for different definitions of the scores: using the true probabilities, the non calibrated scores, or the recalibrated scores.</figcaption>
<p><img src="recalibration_files/figure-html/fig-recalib-simuls-metrics-auc-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="summary-tables" class="level2" data-number="2.9">
<h2 data-number="2.9" class="anchored" data-anchor-id="summary-tables"><span class="header-section-number">2.9</span> Summary Tables</h2>
<p>Let us now report the results in tables. We will focus on a specific probability transformation, and for this transformation, show the computed metrics (in column) depending on the value of the predicted probability used (true probability, transformed probability without calibration, transformed probability with one of the recalibration method).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>table_calib_metrics_all <span class="ot">&lt;-</span> </span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>  calib_metrics_simul <span class="sc">|&gt;</span> </span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method, sample, transform_scale, type, metric) <span class="sc">|&gt;</span> </span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">value_mean =</span> <span class="fu">mean</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">value_sd =</span> <span class="fu">sd</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value_mean =</span> <span class="fu">round</span>(value_mean, <span class="dv">4</span>), <span class="at">value_sd =</span> <span class="fu">round</span>(value_sd, <span class="dv">4</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">str_c</span>(value_mean, <span class="st">" ("</span>, value_sd, <span class="st">")"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>value_mean, <span class="sc">-</span>value_sd) <span class="sc">|&gt;</span> </span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> <span class="fu">c</span>(metric, sample), <span class="at">values_from =</span> value, </span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_sort =</span> <span class="cn">TRUE</span></span>
<span id="cb137-15"><a href="#cb137-15" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We define a function to print a table depending on the transformation applied to the probabilities (varying either <span class="math inline">\(\alpha\)</span> or <span class="math inline">\(\gamma\)</span>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>print_table <span class="ot">&lt;-</span> <span class="cf">function</span>(transform_scale, type) {</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>  table_calib_metrics_all <span class="sc">|&gt;</span> </span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(transform_scale <span class="sc">==</span> <span class="sc">!!</span>transform_scale, type <span class="sc">==</span> type) <span class="sc">|&gt;</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>type, <span class="sc">-</span>transform_scale) <span class="sc">|&gt;</span> </span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">across</span>(</span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>        <span class="sc">-</span>method, </span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a>        <span class="sc">~</span>kableExtra<span class="sc">::</span><span class="fu">cell_spec</span>(</span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a>          .x, </span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="fu">ifelse</span>(</span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a>            .x <span class="sc">==</span> <span class="fu">max</span>(.x), <span class="at">yes =</span> <span class="st">"#882255"</span>,</span>
<span id="cb138-12"><a href="#cb138-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">no =</span> <span class="fu">ifelse</span>(.x <span class="sc">==</span> <span class="fu">min</span>(.x), <span class="st">"#44AA99"</span>, <span class="st">"black"</span>)</span>
<span id="cb138-13"><a href="#cb138-13" aria-hidden="true" tabindex="-1"></a>          ),</span>
<span id="cb138-14"><a href="#cb138-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">bold =</span> <span class="fu">ifelse</span>(</span>
<span id="cb138-15"><a href="#cb138-15" aria-hidden="true" tabindex="-1"></a>            .x <span class="sc">==</span> <span class="fu">max</span>(.x), <span class="at">yes =</span> <span class="cn">TRUE</span>,</span>
<span id="cb138-16"><a href="#cb138-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">no =</span> <span class="fu">ifelse</span>(.x <span class="sc">==</span> <span class="fu">min</span>(.x), <span class="cn">TRUE</span>, <span class="cn">FALSE</span>)</span>
<span id="cb138-17"><a href="#cb138-17" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb138-18"><a href="#cb138-18" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb138-19"><a href="#cb138-19" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb138-20"><a href="#cb138-20" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb138-21"><a href="#cb138-21" aria-hidden="true" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb138-22"><a href="#cb138-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">escape =</span> <span class="cn">FALSE</span>, <span class="at">booktabs =</span> T, <span class="at">digits =</span> <span class="dv">4</span>,</span>
<span id="cb138-23"><a href="#cb138-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="st">"html"</span>,</span>
<span id="cb138-24"><a href="#cb138-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Calibration Method"</span>, <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Calib."</span>, <span class="st">"Test"</span>), <span class="dv">6</span>))</span>
<span id="cb138-25"><a href="#cb138-25" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb138-26"><a href="#cb138-26" aria-hidden="true" tabindex="-1"></a>    kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>() <span class="sc">|&gt;</span></span>
<span id="cb138-27"><a href="#cb138-27" aria-hidden="true" tabindex="-1"></a>    kableExtra<span class="sc">::</span><span class="fu">add_header_above</span>(</span>
<span id="cb138-28"><a href="#cb138-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(</span>
<span id="cb138-29"><a href="#cb138-29" aria-hidden="true" tabindex="-1"></a>        <span class="st">""</span>, <span class="st">"MSE (True)"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"Brier"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"ECE"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"QMSE"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"WMSE"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"LCS"</span> <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb138-30"><a href="#cb138-30" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb138-31"><a href="#cb138-31" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb138-32"><a href="#cb138-32" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-29-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-29-1" role="tab" aria-controls="tabset-29-1" aria-selected="true">Varying <span class="math inline">\(\alpha\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-29-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-29-2" role="tab" aria-controls="tabset-29-2" aria-selected="false">Varying <span class="math inline">\(\gamma\)</span></a></li></ul>
<div class="tab-content">
<div id="tabset-29-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-29-1-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-27-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-1" role="tab" aria-controls="tabset-27-1" aria-selected="true"><span class="math inline">\(\alpha = 1/3\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-27-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-2" role="tab" aria-controls="tabset-27-2" aria-selected="false"><span class="math inline">\(\alpha = 2/3\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-27-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-3" role="tab" aria-controls="tabset-27-3" aria-selected="false"><span class="math inline">\(\alpha = 1.00\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-27-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-4" role="tab" aria-controls="tabset-27-4" aria-selected="false"><span class="math inline">\(\alpha = 3/2\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-27-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-5" role="tab" aria-controls="tabset-27-5" aria-selected="false"><span class="math inline">\(\alpha = 3\)</span></a></li></ul>
<div class="tab-content">
<div id="tabset-27-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-27-1-tab">
<div class="cell">
<div class="cell-output-display">
<div id="tbl-recalib-alpha-25" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;2.1: Average value for the calibration metrics (in column) over the 200 replications, for <span class="math inline">\(\alpha=0.33\)</span>, computed on the calibration and on the test set, using different predicted probabilities (in rows). Standard deviations are given between brackets.</caption>
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
MSE (True)
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Brier
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
ECE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
QMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
WMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
LCS
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th">Calibration Method</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style="     color: black !important;">0.083 (9e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0831 (0.001)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.3186 (0.0083)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.3185 (0.0098)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.2824 (0.0136)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.2826 (0.0166)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0847 (0.0079)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0859 (0.0096)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0765 (0.0092)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0777 (0.0116)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0801 (0.0093)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0827 (0.0118)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (2e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (3e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2418 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2416 (0.0013)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0998 (0.0123)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.1035 (0.0136)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0078 (0.0022)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.009 (0.0027)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.007 (0.0015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0083 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0067 (0.0027)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0079 (0.0034)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">True Prob.</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2359 (0.0033)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2355 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1056 (0.0105)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1113 (0.0126)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.002 (8e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.003 (0.0014)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0065 (0.0017)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0079 (0.0026)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0035 (0.0017)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">True Prob.</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2359 (0.0033)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2355 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1056 (0.0105)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1113 (0.0126)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.002 (8e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.003 (0.0014)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0065 (0.0017)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0079 (0.0026)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0035 (0.0017)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">5e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">5e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2354 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.236 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1032 (0.0173)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1128 (0.0153)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0034 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0082 (0.003)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0024 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0039 (0.0021)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style="     color: black !important;">4e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">4e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2354 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2359 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1031 (0.0174)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1126 (0.0153)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0016 (8e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0034 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0082 (0.003)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0025 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0038 (0.0021)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (7e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2314 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2373 (0.0043)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0935 (0.0185)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1134 (0.0164)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0033 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0102 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0053 (0.0015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0085 (0.0037)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (7e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2314 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2373 (0.0043)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0935 (0.0185)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1134 (0.0164)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0033 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0102 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0053 (0.0015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0085 (0.0037)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.235 (0.0033)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2372 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0998 (0.0189)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1093 (0.0156)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0014 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0039 (0.0016)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.005 (0.0011)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0082 (0.0031)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">6e-04 (3e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0026 (0.0015)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.235 (0.0033)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2372 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0999 (0.0179)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1097 (0.0163)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0014 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0039 (0.0018)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.005 (0.0011)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0082 (0.0031)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">6e-04 (3e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0026 (0.0015)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0016 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2342 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2369 (0.004)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1024 (0.0188)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1136 (0.016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.001 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0037 (0.0016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.0013)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0093 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0029 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0053 (0.0034)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2342 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.237 (0.004)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1021 (0.0177)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1135 (0.0164)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.001 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0037 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0094 (0.0035)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0031 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0055 (0.0033)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (9e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0031 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2326 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2384 (0.0044)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.106 (0.0174)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1154 (0.0165)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">9e-04 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0042 (0.0019)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0054 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0108 (0.0038)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0029 (0.0015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0066 (0.0036)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0031 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2327 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2383 (0.0044)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1057 (0.0178)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1154 (0.0165)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">9e-04 (5e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0042 (0.0021)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0054 (9e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0109 (0.0039)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0031 (0.0015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0069 (0.0037)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">5e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">5e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2357 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.236 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.105 (0.017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1141 (0.0146)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0018 (9e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0035 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0081 (0.0029)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0024 (8e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0036 (0.0021)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style="     color: black !important;">4e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">4e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2355 (0.0033)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2359 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1033 (0.0173)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1129 (0.0153)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (8e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0034 (0.0016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0081 (0.003)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0025 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0037 (0.0021)</span></td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
</div>
<div id="tabset-27-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-27-2-tab">
<div class="cell">
<div class="cell-output-display">
<div id="tbl-recalib-alpha-23" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;2.2: Average value for the calibration metrics (in column) over the 200 replications, for <span class="math inline">\(\alpha=0.67\)</span>, computed on the calibration and on the test set, using different predicted probabilities (in rows). Standard deviations are given between brackets.</caption>
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
MSE (True)
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Brier
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
ECE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
QMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
WMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
LCS
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th">Calibration Method</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0157 (1e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0157 (1e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.2515 (0.0047)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.2512 (0.0052)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.1313 (0.0138)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.1312 (0.0162)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0176 (0.0035)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0187 (0.0043)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0196 (0.0039)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0211 (0.0049)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0163 (0.0036)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0172 (0.0044)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0014 (1e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0014 (1e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2372 (0.0023)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2369 (0.0026)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.099 (0.0115)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.1037 (0.0127)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0033 (0.0013)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0044 (0.0018)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.005 (0.001)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0065 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0021 (9e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0028 (0.0013)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">True Prob.</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2359 (0.0033)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2355 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1056 (0.0105)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1113 (0.0126)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.002 (8e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.003 (0.0014)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0065 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0079 (0.0026)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0035 (0.0017)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">True Prob.</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2359 (0.0033)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2355 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1056 (0.0105)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1113 (0.0126)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.002 (8e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.003 (0.0014)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0065 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0079 (0.0026)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0035 (0.0017)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">5e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">5e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2354 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.236 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1032 (0.0172)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1128 (0.0153)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0034 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0082 (0.003)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0024 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0039 (0.0021)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style="     color: black !important;">4e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">4e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2354 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2359 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.103 (0.0173)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1125 (0.0152)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0034 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0082 (0.0029)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0024 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0039 (0.0021)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (7e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2314 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2373 (0.0043)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0935 (0.0185)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1134 (0.0164)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0033 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0102 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0053 (0.0015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0085 (0.0037)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (7e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2314 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2373 (0.0043)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0935 (0.0185)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1134 (0.0164)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0033 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0102 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0053 (0.0015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0085 (0.0037)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.235 (0.0033)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2372 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0998 (0.0189)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1089 (0.016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0014 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0038 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0051 (0.0011)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0082 (0.0031)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">6e-04 (3e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0026 (0.0015)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.235 (0.0033)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2372 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0998 (0.019)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1096 (0.0162)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0014 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0039 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.005 (0.0011)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0083 (0.003)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">6e-04 (3e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0026 (0.0015)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2342 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2369 (0.004)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1029 (0.0187)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1135 (0.0162)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.001 (5e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0037 (0.0016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0092 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0029 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0051 (0.0033)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0016 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2342 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2369 (0.004)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1022 (0.0183)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1136 (0.0164)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.001 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0037 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.0013)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0093 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0054 (0.0033)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2327 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2384 (0.0044)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1067 (0.0175)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.115 (0.0169)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">9e-04 (5e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0041 (0.002)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0054 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0108 (0.0039)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0029 (0.0015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0066 (0.0037)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0031 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2326 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2384 (0.0045)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1059 (0.0179)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1153 (0.0165)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">9e-04 (5e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0042 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0054 (9e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0108 (0.004)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.0015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0066 (0.0038)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style="     color: black !important;">4e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">4e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2356 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2359 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1048 (0.017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1135 (0.0147)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (8e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0034 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0081 (0.003)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0021 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0033 (0.002)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style="     color: black !important;">4e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">4e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2355 (0.0033)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2359 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1036 (0.0174)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1132 (0.0152)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (8e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0034 (0.0016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0081 (0.003)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0022 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0035 (0.002)</span></td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
</div>
<div id="tabset-27-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-27-3-tab">
<div class="cell">
<div class="cell-output-display">
<div id="tbl-recalib-alpha-1" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;2.3: Average value for the calibration metrics (in column) over the 200 replications, for <span class="math inline">\(\alpha=1\)</span>, computed on the calibration and on the test set, using different predicted probabilities (in rows). Standard deviations are given between brackets.</caption>
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
MSE (True)
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Brier
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
ECE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
QMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
WMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
LCS
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th">Calibration Method</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.2359 (0.0033)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2355 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1056 (0.0105)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1113 (0.0126)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.002 (8e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.003 (0.0014)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0065 (0.0017)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0079 (0.0026)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0035 (0.0016)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.2359 (0.0033)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2355 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1056 (0.0105)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1113 (0.0126)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.002 (8e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.003 (0.0014)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0065 (0.0017)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0079 (0.0026)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0035 (0.0016)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">True Prob.</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.2359 (0.0033)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2355 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1056 (0.0105)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1113 (0.0126)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.002 (8e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.003 (0.0014)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0065 (0.0017)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0079 (0.0026)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0035 (0.0017)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">True Prob.</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.2359 (0.0033)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2355 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1056 (0.0105)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1113 (0.0126)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.002 (8e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.003 (0.0014)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0065 (0.0017)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0079 (0.0026)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0035 (0.0017)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">5e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">5e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2354 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.236 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1031 (0.0173)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1127 (0.0153)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0034 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0082 (0.003)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0024 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0039 (0.0021)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">5e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">5e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2354 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.236 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1031 (0.0173)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1127 (0.0153)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0034 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0082 (0.003)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0024 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0039 (0.0021)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (7e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2314 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2373 (0.0043)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0935 (0.0185)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1134 (0.0164)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0033 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0102 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0053 (0.0015)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0085 (0.0037)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (7e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2314 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2373 (0.0043)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0935 (0.0185)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1134 (0.0164)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0033 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0102 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0053 (0.0015)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0085 (0.0037)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.235 (0.0033)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2372 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.099 (0.0182)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.1092 (0.016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0013 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0039 (0.0018)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.005 (0.0011)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0083 (0.0031)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">6e-04 (3e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0026 (0.0016)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.235 (0.0033)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2372 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.099 (0.0182)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.1092 (0.016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0013 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0039 (0.0018)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.005 (0.0011)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0083 (0.0031)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">6e-04 (3e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0026 (0.0016)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2342 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2369 (0.004)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1016 (0.0184)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1134 (0.0161)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">9e-04 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0038 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0059 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0092 (0.0035)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0028 (0.0016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.005 (0.0032)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2342 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2369 (0.004)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1016 (0.0184)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1134 (0.0161)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">9e-04 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0038 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0059 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0092 (0.0035)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0028 (0.0016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.005 (0.0032)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0029 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2327 (0.0034)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.2383 (0.0044)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.1058 (0.0179)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.1147 (0.0167)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">9e-04 (6e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0041 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0054 (9e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0107 (0.0039)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0029 (0.0014)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0065 (0.0037)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0029 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2327 (0.0034)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.2383 (0.0044)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.1058 (0.0179)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.1147 (0.0167)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">9e-04 (6e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0041 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0054 (9e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0107 (0.0039)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0029 (0.0014)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0065 (0.0037)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style="     color: black !important;">4e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">4e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2355 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2359 (0.0038)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.104 (0.0174)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1136 (0.0152)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (8e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0034 (0.0016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0081 (0.003)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0019 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0032 (0.0018)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style="     color: black !important;">4e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">4e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2355 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2359 (0.0038)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.104 (0.0174)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1136 (0.0152)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (8e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0034 (0.0016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0081 (0.003)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0019 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0032 (0.0018)</span></td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
</div>
<div id="tabset-27-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-27-4-tab">
<div class="cell">
<div class="cell-output-display">
<div id="tbl-recalib-alpha-32" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;2.4: Average value for the calibration metrics (in column) over the 200 replications, for <span class="math inline">\(\alpha=1.5\)</span>, computed on the calibration and on the test set, using different predicted probabilities (in rows). Standard deviations are given between brackets.</caption>
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
MSE (True)
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Brier
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
ECE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
QMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
WMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
LCS
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th">Calibration Method</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0192 (1e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0192 (1e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.2553 (0.005)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.2548 (0.0061)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.1927 (0.0136)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.1954 (0.0167)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0214 (0.004)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0222 (0.005)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0251 (0.0044)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0256 (0.0058)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0215 (0.0041)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0216 (0.0052)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0025 (1e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0025 (1e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2384 (0.0047)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2379 (0.0051)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1342 (0.0122)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1384 (0.0142)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0045 (0.0016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0053 (0.0021)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0117 (0.0028)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0129 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.008 (0.0024)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0084 (0.003)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">True Prob.</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2359 (0.0033)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2355 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1056 (0.0105)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1113 (0.0126)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.002 (8e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.003 (0.0014)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0065 (0.0017)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0079 (0.0026)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0035 (0.0017)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">True Prob.</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2359 (0.0033)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2355 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1056 (0.0105)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1113 (0.0126)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.002 (8e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.003 (0.0014)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0065 (0.0017)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0079 (0.0026)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0035 (0.0017)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">5e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">5e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2354 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.236 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1028 (0.0175)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1127 (0.0154)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0035 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0082 (0.0029)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0024 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.004 (0.0021)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">5e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">5e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2354 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.236 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1029 (0.0176)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1129 (0.0155)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0035 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0082 (0.0029)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0023 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.004 (0.0021)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (7e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2314 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2373 (0.0043)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0935 (0.0185)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1134 (0.0164)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0033 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0102 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0053 (0.0015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0085 (0.0037)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (7e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2314 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2373 (0.0043)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0935 (0.0185)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1134 (0.0164)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0033 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0102 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0053 (0.0015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0085 (0.0037)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.235 (0.0033)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2372 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0999 (0.019)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.1098 (0.0159)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0013 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0039 (0.0018)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.005 (0.0011)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0083 (0.0031)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">6e-04 (3e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0026 (0.0015)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0016 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2349 (0.0033)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2371 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0995 (0.0184)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1099 (0.0159)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0013 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0039 (0.0017)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.005 (0.0011)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0083 (0.0031)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">6e-04 (3e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0026 (0.0015)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2342 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.237 (0.004)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1022 (0.0182)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.114 (0.0163)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.001 (5e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0038 (0.0019)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0059 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0093 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0027 (0.0016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.005 (0.0033)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2342 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2369 (0.004)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1023 (0.0175)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1138 (0.0162)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">9e-04 (5e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0038 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.0013)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0092 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0024 (0.0016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0047 (0.0029)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0029 (9e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2327 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2382 (0.0044)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1062 (0.0176)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1157 (0.0159)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">9e-04 (5e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0042 (0.0019)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0054 (9e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0108 (0.004)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0028 (0.0015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0065 (0.0037)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0029 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2327 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2382 (0.0044)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1068 (0.0181)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1156 (0.0173)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">9e-04 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.004 (0.0019)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0054 (9e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0106 (0.0039)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0027 (0.0015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0062 (0.0037)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style="     color: black !important;">4e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">4e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2356 (0.0033)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.236 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1035 (0.0176)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1126 (0.0159)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (8e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0034 (0.0016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0081 (0.0029)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0018 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0032 (0.0017)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style="     color: black !important;">4e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">4e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2356 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.236 (0.0038)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1047 (0.0175)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1142 (0.0149)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (8e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0034 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0081 (0.003)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0015 (5e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0028 (0.0017)</span></td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
</div>
<div id="tabset-27-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-27-5-tab">
<div class="cell">
<div class="cell-output-display">
<div id="tbl-recalib-alpha-3" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;2.5: Average value for the calibration metrics (in column) over the 200 replications, for <span class="math inline">\(\alpha=3\)</span>, computed on the calibration and on the test set, using different predicted probabilities (in rows). Standard deviations are given between brackets.</caption>
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
MSE (True)
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Brier
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
ECE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
QMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
WMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
LCS
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th">Calibration Method</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style="     color: black !important;">0.1281 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.128 (8e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.3642 (0.01)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.3637 (0.0122)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.3459 (0.0141)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.3476 (0.0163)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1302 (0.0099)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.131 (0.012)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.1196 (0.0098)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.1183 (0.0117)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1211 (0.0099)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.1204 (0.0119)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0243 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0243 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2604 (0.0076)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2596 (0.0084)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2253 (0.0136)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.227 (0.0157)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0263 (0.0045)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0268 (0.0051)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.031 (0.0049)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0312 (0.0059)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0294 (0.0048)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0294 (0.0058)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">True Prob.</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2359 (0.0033)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2355 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1056 (0.0105)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1113 (0.0126)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.002 (8e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.003 (0.0014)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0065 (0.0017)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0079 (0.0026)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0035 (0.0017)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">True Prob.</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2359 (0.0033)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2355 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1056 (0.0105)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1113 (0.0126)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.002 (8e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.003 (0.0014)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0065 (0.0017)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0079 (0.0026)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0035 (0.0017)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style="     color: black !important;">5e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">5e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2354 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.236 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1025 (0.0176)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1124 (0.0154)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0035 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0082 (0.0029)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0026 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0042 (0.0021)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style="     color: black !important;">5e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">6e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2353 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2361 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1027 (0.0177)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.113 (0.0154)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0035 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0082 (0.0029)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0023 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.004 (0.0021)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (7e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2314 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2373 (0.0043)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0935 (0.0185)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1134 (0.0164)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0033 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0102 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0053 (0.0015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0085 (0.0037)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (7e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2314 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2373 (0.0043)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0935 (0.0185)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1134 (0.0164)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0033 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0102 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0053 (0.0015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0085 (0.0037)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.235 (0.0033)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2371 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1013 (0.0189)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1106 (0.0161)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0013 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0039 (0.0017)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0051 (0.0011)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0082 (0.0031)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">6e-04 (3e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0026 (0.0015)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0016 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.235 (0.0033)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2371 (0.0038)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1001 (0.0184)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1111 (0.0159)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0012 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0039 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0052 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0085 (0.0031)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">6e-04 (3e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0026 (0.0016)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2342 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2369 (0.004)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1018 (0.0176)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1143 (0.0161)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">9e-04 (5e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0037 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0061 (0.0013)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0092 (0.0035)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0025 (0.0015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0047 (0.003)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2344 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2369 (0.0041)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1027 (0.0185)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1143 (0.0161)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.001 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0038 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0061 (0.0013)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0093 (0.0035)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0037 (0.0024)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0029 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2327 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2383 (0.0044)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1067 (0.0185)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1154 (0.0169)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">9e-04 (5e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0042 (0.0019)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0054 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0108 (0.0039)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0027 (0.0014)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0063 (0.0036)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0029 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0029 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2327 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2381 (0.0043)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1069 (0.0179)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1154 (0.0177)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">9e-04 (5e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0042 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0055 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0107 (0.0039)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.002 (0.0013)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0054 (0.0033)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0011 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0012 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2363 (0.0032)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2367 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1013 (0.0184)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.1083 (0.0165)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0023 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.004 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0059 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0081 (0.0027)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0028 (0.0011)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0043 (0.0019)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">8e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">8e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.236 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2364 (0.0038)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1077 (0.0176)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1165 (0.0145)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (9e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0037 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0059 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0081 (0.0029)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.001 (5e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0024 (0.0015)</span></td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-29-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-29-2-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-28-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-1" role="tab" aria-controls="tabset-28-1" aria-selected="true"><span class="math inline">\(\gamma = 1/3\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-28-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-2" role="tab" aria-controls="tabset-28-2" aria-selected="false"><span class="math inline">\(\gamma = 2/3\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-28-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-3" role="tab" aria-controls="tabset-28-3" aria-selected="false"><span class="math inline">\(\gamma = 1\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-28-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-4" role="tab" aria-controls="tabset-28-4" aria-selected="false"><span class="math inline">\(\gamma = 3/2\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-28-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-5" role="tab" aria-controls="tabset-28-5" aria-selected="false"><span class="math inline">\(\gamma = 3\)</span></a></li></ul>
<div class="tab-content">
<div id="tabset-28-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-28-1-tab">
<div class="cell">
<div class="cell-output-display">
<div id="tbl-recalib-gamma-13" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;2.6: Average value for the calibration metrics (in column) over the 200 replications, for <span class="math inline">\(\gamma=0.33\)</span>, computed on the calibration and on the test set, using different predicted probabilities (in rows). Standard deviations are given between brackets.</caption>
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
MSE (True)
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Brier
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
ECE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
QMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
WMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
LCS
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th">Calibration Method</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style="     color: black !important;">0.083 (9e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0831 (0.001)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.3186 (0.0083)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.3185 (0.0098)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.2824 (0.0136)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.2826 (0.0166)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0847 (0.0079)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0859 (0.0096)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0765 (0.0092)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0777 (0.0116)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0801 (0.0093)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0827 (0.0118)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (2e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (3e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2418 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2416 (0.0013)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0998 (0.0123)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.1035 (0.0136)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0078 (0.0022)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.009 (0.0027)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.007 (0.0015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0083 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0067 (0.0027)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0079 (0.0034)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">True Prob.</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2359 (0.0033)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2355 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1056 (0.0105)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1113 (0.0126)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.002 (8e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.003 (0.0014)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0065 (0.0017)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0079 (0.0026)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0035 (0.0017)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">True Prob.</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2359 (0.0033)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2355 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1056 (0.0105)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1113 (0.0126)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.002 (8e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.003 (0.0014)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0065 (0.0017)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0079 (0.0026)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0035 (0.0017)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">5e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">5e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2354 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.236 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1032 (0.0173)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1128 (0.0153)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0034 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0082 (0.003)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0024 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0039 (0.0021)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style="     color: black !important;">4e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">4e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2354 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2359 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1031 (0.0174)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1126 (0.0153)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0016 (8e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0034 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0082 (0.003)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0025 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0038 (0.0021)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (7e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2314 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2373 (0.0043)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0935 (0.0185)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1134 (0.0164)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0033 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0102 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0053 (0.0015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0085 (0.0037)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (7e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2314 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2373 (0.0043)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0935 (0.0185)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1134 (0.0164)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0033 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0102 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0053 (0.0015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0085 (0.0037)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.235 (0.0033)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2372 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0998 (0.0189)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1093 (0.0156)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0014 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0039 (0.0016)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.005 (0.0011)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0082 (0.0031)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">6e-04 (3e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0026 (0.0015)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.235 (0.0033)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2372 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0999 (0.0179)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1097 (0.0163)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0014 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0039 (0.0018)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.005 (0.0011)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0082 (0.0031)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">6e-04 (3e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0026 (0.0015)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0016 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2342 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2369 (0.004)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1024 (0.0188)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1136 (0.016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.001 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0037 (0.0016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.0013)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0093 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0029 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0053 (0.0034)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2342 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.237 (0.004)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1021 (0.0177)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1135 (0.0164)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.001 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0037 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0094 (0.0035)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0031 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0055 (0.0033)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (9e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0031 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2326 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2384 (0.0044)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.106 (0.0174)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1154 (0.0165)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">9e-04 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0042 (0.0019)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0054 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0108 (0.0038)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0029 (0.0015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0066 (0.0036)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0031 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2327 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2383 (0.0044)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1057 (0.0178)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1154 (0.0165)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">9e-04 (5e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0042 (0.0021)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0054 (9e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0109 (0.0039)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0031 (0.0015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0069 (0.0037)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">5e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">5e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2357 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.236 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.105 (0.017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1141 (0.0146)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0018 (9e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0035 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0081 (0.0029)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0024 (8e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0036 (0.0021)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style="     color: black !important;">4e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">4e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2355 (0.0033)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2359 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1033 (0.0173)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1129 (0.0153)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (8e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0034 (0.0016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0081 (0.003)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0025 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0037 (0.0021)</span></td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
</div>
<div id="tabset-28-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-28-2-tab">
<div class="cell">
<div class="cell-output-display">
<div id="tbl-recalib-gamma-23" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;2.7: Average value for the calibration metrics (in column) over the 200 replications, for <span class="math inline">\(\gamma=0.67\)</span>, computed on the calibration and on the test set, using different predicted probabilities (in rows). Standard deviations are given between brackets.</caption>
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
MSE (True)
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Brier
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
ECE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
QMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
WMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
LCS
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th">Calibration Method</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0157 (1e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0157 (1e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.2515 (0.0047)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.2512 (0.0052)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.1313 (0.0138)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.1312 (0.0162)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0176 (0.0035)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0187 (0.0043)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0196 (0.0039)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0211 (0.0049)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0163 (0.0036)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0172 (0.0044)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0014 (1e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0014 (1e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2372 (0.0023)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2369 (0.0026)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.099 (0.0115)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.1037 (0.0127)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0033 (0.0013)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0044 (0.0018)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.005 (0.001)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0065 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0021 (9e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0028 (0.0013)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">True Prob.</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2359 (0.0033)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2355 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1056 (0.0105)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1113 (0.0126)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.002 (8e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.003 (0.0014)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0065 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0079 (0.0026)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0035 (0.0017)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">True Prob.</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2359 (0.0033)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2355 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1056 (0.0105)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1113 (0.0126)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.002 (8e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.003 (0.0014)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0065 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0079 (0.0026)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0035 (0.0017)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">5e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">5e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2354 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.236 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1032 (0.0172)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1128 (0.0153)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0034 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0082 (0.003)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0024 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0039 (0.0021)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style="     color: black !important;">4e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">4e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2354 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2359 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.103 (0.0173)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1125 (0.0152)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0034 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0082 (0.0029)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0024 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0039 (0.0021)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (7e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2314 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2373 (0.0043)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0935 (0.0185)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1134 (0.0164)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0033 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0102 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0053 (0.0015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0085 (0.0037)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (7e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2314 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2373 (0.0043)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0935 (0.0185)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1134 (0.0164)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0033 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0102 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0053 (0.0015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0085 (0.0037)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.235 (0.0033)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2372 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0998 (0.0189)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1089 (0.016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0014 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0038 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0051 (0.0011)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0082 (0.0031)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">6e-04 (3e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0026 (0.0015)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.235 (0.0033)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2372 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0998 (0.019)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1096 (0.0162)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0014 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0039 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.005 (0.0011)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0083 (0.003)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">6e-04 (3e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0026 (0.0015)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2342 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2369 (0.004)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1029 (0.0187)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1135 (0.0162)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.001 (5e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0037 (0.0016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0092 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0029 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0051 (0.0033)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0016 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2342 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2369 (0.004)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1022 (0.0183)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1136 (0.0164)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.001 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0037 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.0013)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0093 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0054 (0.0033)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2327 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2384 (0.0044)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1067 (0.0175)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.115 (0.0169)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">9e-04 (5e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0041 (0.002)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0054 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0108 (0.0039)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0029 (0.0015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0066 (0.0037)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0031 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2326 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2384 (0.0045)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1059 (0.0179)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1153 (0.0165)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">9e-04 (5e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0042 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0054 (9e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0108 (0.004)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.0015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0066 (0.0038)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style="     color: black !important;">4e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">4e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2356 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2359 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1048 (0.017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1135 (0.0147)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (8e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0034 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0081 (0.003)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0021 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0033 (0.002)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style="     color: black !important;">4e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">4e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2355 (0.0033)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2359 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1036 (0.0174)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1132 (0.0152)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (8e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0034 (0.0016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0081 (0.003)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0022 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0035 (0.002)</span></td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
</div>
<div id="tabset-28-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-28-3-tab">
<div class="cell">
<div class="cell-output-display">
<div id="tbl-recalib-gamma-1" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;2.8: Average value for the calibration metrics (in column) over the 200 replications, for <span class="math inline">\(\gamma=1\)</span>, computed on the calibration and on the test set, using different predicted probabilities (in rows). Standard deviations are given between brackets.</caption>
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
MSE (True)
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Brier
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
ECE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
QMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
WMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
LCS
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th">Calibration Method</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.2359 (0.0033)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2355 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1056 (0.0105)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1113 (0.0126)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.002 (8e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.003 (0.0014)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0065 (0.0017)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0079 (0.0026)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0035 (0.0016)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.2359 (0.0033)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2355 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1056 (0.0105)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1113 (0.0126)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.002 (8e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.003 (0.0014)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0065 (0.0017)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0079 (0.0026)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0035 (0.0016)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">True Prob.</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.2359 (0.0033)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2355 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1056 (0.0105)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1113 (0.0126)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.002 (8e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.003 (0.0014)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0065 (0.0017)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0079 (0.0026)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0035 (0.0017)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">True Prob.</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.2359 (0.0033)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2355 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1056 (0.0105)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1113 (0.0126)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.002 (8e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.003 (0.0014)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0065 (0.0017)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0079 (0.0026)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0035 (0.0017)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">5e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">5e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2354 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.236 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1031 (0.0173)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1127 (0.0153)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0034 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0082 (0.003)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0024 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0039 (0.0021)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">5e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">5e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2354 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.236 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1031 (0.0173)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1127 (0.0153)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0034 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0082 (0.003)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0024 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0039 (0.0021)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (7e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2314 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2373 (0.0043)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0935 (0.0185)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1134 (0.0164)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0033 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0102 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0053 (0.0015)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0085 (0.0037)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (7e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2314 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2373 (0.0043)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0935 (0.0185)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1134 (0.0164)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0033 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0102 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0053 (0.0015)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0085 (0.0037)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.235 (0.0033)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2372 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.099 (0.0182)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.1092 (0.016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0013 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0039 (0.0018)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.005 (0.0011)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0083 (0.0031)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">6e-04 (3e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0026 (0.0016)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.235 (0.0033)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2372 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.099 (0.0182)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.1092 (0.016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0013 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0039 (0.0018)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.005 (0.0011)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0083 (0.0031)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">6e-04 (3e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0026 (0.0016)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2342 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2369 (0.004)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1016 (0.0184)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1134 (0.0161)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">9e-04 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0038 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0059 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0092 (0.0035)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0028 (0.0016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.005 (0.0032)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2342 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2369 (0.004)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1016 (0.0184)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1134 (0.0161)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">9e-04 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0038 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0059 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0092 (0.0035)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0028 (0.0016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.005 (0.0032)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0029 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2327 (0.0034)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.2383 (0.0044)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.1058 (0.0179)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.1147 (0.0167)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">9e-04 (6e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0041 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0054 (9e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0107 (0.0039)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0029 (0.0014)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0065 (0.0037)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0029 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2327 (0.0034)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.2383 (0.0044)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.1058 (0.0179)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.1147 (0.0167)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">9e-04 (6e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0041 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0054 (9e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0107 (0.0039)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0029 (0.0014)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0065 (0.0037)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style="     color: black !important;">4e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">4e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2355 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2359 (0.0038)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.104 (0.0174)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1136 (0.0152)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (8e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0034 (0.0016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0081 (0.003)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0019 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0032 (0.0018)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style="     color: black !important;">4e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">4e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2355 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2359 (0.0038)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.104 (0.0174)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1136 (0.0152)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (8e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0034 (0.0016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0081 (0.003)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0019 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0032 (0.0018)</span></td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
</div>
<div id="tabset-28-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-28-4-tab">
<div class="cell">
<div class="cell-output-display">
<div id="tbl-recalib-gamma-32" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;2.9: Average value for the calibration metrics (in column) over the 200 replications, for <span class="math inline">\(\gamma=1.5\)</span>, computed on the calibration and on the test set, using different predicted probabilities (in rows). Standard deviations are given between brackets.</caption>
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
MSE (True)
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Brier
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
ECE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
QMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
WMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
LCS
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th">Calibration Method</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0192 (1e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0192 (1e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.2553 (0.005)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.2548 (0.0061)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.1927 (0.0136)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.1954 (0.0167)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0214 (0.004)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0222 (0.005)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0251 (0.0044)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0256 (0.0058)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0215 (0.0041)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.0216 (0.0052)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0025 (1e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0025 (1e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2384 (0.0047)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2379 (0.0051)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1342 (0.0122)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1384 (0.0142)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0045 (0.0016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0053 (0.0021)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0117 (0.0028)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0129 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.008 (0.0024)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0084 (0.003)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">True Prob.</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2359 (0.0033)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2355 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1056 (0.0105)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1113 (0.0126)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.002 (8e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.003 (0.0014)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0065 (0.0017)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0079 (0.0026)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0035 (0.0017)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">True Prob.</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2359 (0.0033)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2355 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1056 (0.0105)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1113 (0.0126)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.002 (8e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.003 (0.0014)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0065 (0.0017)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0079 (0.0026)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0035 (0.0017)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">5e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">5e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2354 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.236 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1028 (0.0175)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1127 (0.0154)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0035 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0082 (0.0029)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0024 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.004 (0.0021)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">5e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">5e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2354 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.236 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1029 (0.0176)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1129 (0.0155)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0035 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0082 (0.0029)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0023 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.004 (0.0021)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (7e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2314 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2373 (0.0043)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0935 (0.0185)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1134 (0.0164)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0033 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0102 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0053 (0.0015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0085 (0.0037)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (7e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2314 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2373 (0.0043)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0935 (0.0185)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1134 (0.0164)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0033 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0102 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0053 (0.0015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0085 (0.0037)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.235 (0.0033)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2372 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0999 (0.019)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.1098 (0.0159)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0013 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0039 (0.0018)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.005 (0.0011)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0083 (0.0031)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">6e-04 (3e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0026 (0.0015)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0016 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2349 (0.0033)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2371 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0995 (0.0184)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1099 (0.0159)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0013 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0039 (0.0017)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.005 (0.0011)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0083 (0.0031)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">6e-04 (3e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0026 (0.0015)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2342 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.237 (0.004)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1022 (0.0182)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.114 (0.0163)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.001 (5e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0038 (0.0019)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0059 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0093 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0027 (0.0016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.005 (0.0033)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2342 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2369 (0.004)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1023 (0.0175)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1138 (0.0162)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">9e-04 (5e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0038 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.0013)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0092 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0024 (0.0016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0047 (0.0029)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0029 (9e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2327 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2382 (0.0044)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1062 (0.0176)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1157 (0.0159)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">9e-04 (5e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0042 (0.0019)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0054 (9e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0108 (0.004)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0028 (0.0015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0065 (0.0037)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0029 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2327 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2382 (0.0044)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1068 (0.0181)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1156 (0.0173)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">9e-04 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.004 (0.0019)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0054 (9e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0106 (0.0039)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0027 (0.0015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0062 (0.0037)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style="     color: black !important;">4e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">4e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2356 (0.0033)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.236 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1035 (0.0176)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1126 (0.0159)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (8e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0034 (0.0016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0081 (0.0029)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0018 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0032 (0.0017)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style="     color: black !important;">4e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">4e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2356 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.236 (0.0038)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1047 (0.0175)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1142 (0.0149)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (8e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0034 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0081 (0.003)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0015 (5e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0028 (0.0017)</span></td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
</div>
<div id="tabset-28-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-28-5-tab">
<div class="cell">
<div class="cell-output-display">
<div id="tbl-recalib-gamma-3" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;2.10: Average value for the calibration metrics (in column) over the 200 replications, for <span class="math inline">\(\gamma=3\)</span>, computed on the calibration and on the test set, using different predicted probabilities (in rows). Standard deviations are given between brackets.</caption>
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
MSE (True)
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Brier
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
ECE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
QMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
WMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
LCS
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th">Calibration Method</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style="     color: black !important;">0.1281 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.128 (8e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.3642 (0.01)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.3637 (0.0122)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.3459 (0.0141)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.3476 (0.0163)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1302 (0.0099)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.131 (0.012)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.1196 (0.0098)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.1183 (0.0117)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1211 (0.0099)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">0.1204 (0.0119)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0243 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0243 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2604 (0.0076)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2596 (0.0084)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2253 (0.0136)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.227 (0.0157)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0263 (0.0045)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0268 (0.0051)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.031 (0.0049)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0312 (0.0059)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0294 (0.0048)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0294 (0.0058)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">True Prob.</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2359 (0.0033)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2355 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1056 (0.0105)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1113 (0.0126)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.002 (8e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.003 (0.0014)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0065 (0.0017)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0079 (0.0026)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0035 (0.0017)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">True Prob.</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2359 (0.0033)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2355 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1056 (0.0105)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1113 (0.0126)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.002 (8e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.003 (0.0014)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0065 (0.0017)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0079 (0.0026)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0035 (0.0017)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style="     color: black !important;">5e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">5e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2354 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.236 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1025 (0.0176)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1124 (0.0154)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0035 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0082 (0.0029)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0026 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0042 (0.0021)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style="     color: black !important;">5e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">6e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2353 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2361 (0.0037)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1027 (0.0177)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.113 (0.0154)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0035 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0082 (0.0029)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0023 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.004 (0.0021)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (7e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2314 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2373 (0.0043)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0935 (0.0185)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1134 (0.0164)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0033 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0102 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0053 (0.0015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0085 (0.0037)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (7e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2314 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2373 (0.0043)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0935 (0.0185)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1134 (0.0164)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0033 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.006 (0.0012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0102 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0053 (0.0015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0085 (0.0037)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.235 (0.0033)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2371 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1013 (0.0189)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1106 (0.0161)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0013 (7e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0039 (0.0017)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0051 (0.0011)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0082 (0.0031)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">6e-04 (3e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0026 (0.0015)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0016 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0017 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.235 (0.0033)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2371 (0.0038)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1001 (0.0184)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1111 (0.0159)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0012 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0039 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0052 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0085 (0.0031)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">6e-04 (3e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0026 (0.0016)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2342 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2369 (0.004)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1018 (0.0176)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1143 (0.0161)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">9e-04 (5e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0037 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0061 (0.0013)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0092 (0.0035)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0025 (0.0015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0047 (0.003)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2344 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2369 (0.0041)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1027 (0.0185)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1143 (0.0161)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.001 (6e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0038 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0061 (0.0013)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0093 (0.0035)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0015 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0037 (0.0024)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0029 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.003 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2327 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2383 (0.0044)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1067 (0.0185)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1154 (0.0169)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">9e-04 (5e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0042 (0.0019)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0054 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0108 (0.0039)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0027 (0.0014)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0063 (0.0036)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0029 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0029 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2327 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2381 (0.0043)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1069 (0.0179)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1154 (0.0177)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">9e-04 (5e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0042 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0055 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0107 (0.0039)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.002 (0.0013)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0054 (0.0033)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0011 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0012 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2363 (0.0032)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2367 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1013 (0.0184)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.1083 (0.0165)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0023 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.004 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0059 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0081 (0.0027)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0028 (0.0011)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0043 (0.0019)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">8e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">8e-04 (4e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.236 (0.0034)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2364 (0.0038)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1077 (0.0176)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1165 (0.0145)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0019 (9e-04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0037 (0.0018)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0059 (0.001)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0081 (0.0029)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.001 (5e-04)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0024 (0.0015)</span></td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Now, let us normalize the values. We use the calibration metric computed with the uncalibrated estimated probabilities as the reference value and express the metrics computed after recalibration of the scores as deviations from that reference.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>table_calib_metrics_all_rel <span class="ot">&lt;-</span> </span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>  calib_metrics_simul <span class="sc">|&gt;</span> </span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>method <span class="sc">==</span> <span class="st">"True Prob."</span>) <span class="sc">|&gt;</span> </span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">reference =</span> <span class="fu">ifelse</span>(method <span class="sc">==</span> <span class="st">"No Calibration"</span>, <span class="at">yes =</span> value, <span class="at">no =</span> <span class="cn">NA</span>)</span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sample, transform_scale, type, metric, seed) <span class="sc">|&gt;</span> </span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">reference =</span> <span class="fu">sum</span>(reference, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb139-13"><a href="#cb139-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">value_norm =</span> value <span class="sc">/</span> reference</span>
<span id="cb139-14"><a href="#cb139-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb139-15"><a href="#cb139-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb139-16"><a href="#cb139-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">value_norm =</span> <span class="fu">ifelse</span>(value <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> reference <span class="sc">==</span> <span class="dv">0</span>, <span class="at">yes =</span> <span class="dv">1</span>, <span class="at">no =</span> value_norm)</span>
<span id="cb139-17"><a href="#cb139-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb139-18"><a href="#cb139-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method, sample, transform_scale, type, metric) <span class="sc">|&gt;</span> </span>
<span id="cb139-19"><a href="#cb139-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb139-20"><a href="#cb139-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">value_norm_mean =</span> <span class="fu">mean</span>(value_norm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb139-21"><a href="#cb139-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">value_norm_sd =</span> <span class="fu">sd</span>(value_norm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb139-22"><a href="#cb139-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb139-23"><a href="#cb139-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb139-24"><a href="#cb139-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb139-25"><a href="#cb139-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">value_norm_mean =</span> <span class="fu">round</span>(value_norm_mean, <span class="dv">4</span>), </span>
<span id="cb139-26"><a href="#cb139-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">value_norm_sd =</span> <span class="fu">round</span>(value_norm_sd, <span class="dv">4</span>)</span>
<span id="cb139-27"><a href="#cb139-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb139-28"><a href="#cb139-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">str_c</span>(value_norm_mean, <span class="st">" ("</span>, value_norm_sd, <span class="st">")"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb139-29"><a href="#cb139-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>value_norm_mean, <span class="sc">-</span>value_norm_sd) <span class="sc">|&gt;</span> </span>
<span id="cb139-30"><a href="#cb139-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb139-31"><a href="#cb139-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> <span class="fu">c</span>(metric, sample), <span class="at">values_from =</span> value, </span>
<span id="cb139-32"><a href="#cb139-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_sort =</span> <span class="cn">TRUE</span></span>
<span id="cb139-33"><a href="#cb139-33" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We define a function to print a table depending on the transformation applied to the probabilities (varying either <span class="math inline">\(\alpha\)</span> or <span class="math inline">\(\gamma\)</span>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>print_table_rel <span class="ot">&lt;-</span> <span class="cf">function</span>(transform_scale, type) {</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>  table_calib_metrics_all_rel <span class="sc">|&gt;</span> </span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(transform_scale <span class="sc">==</span> <span class="sc">!!</span>transform_scale, type <span class="sc">==</span> type) <span class="sc">|&gt;</span></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>type, <span class="sc">-</span>transform_scale) <span class="sc">|&gt;</span> </span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">across</span>(</span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>        <span class="sc">-</span>method, </span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a>        <span class="sc">~</span>kableExtra<span class="sc">::</span><span class="fu">cell_spec</span>(</span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a>          .x, </span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="fu">ifelse</span>(</span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a>            .x <span class="sc">==</span> <span class="fu">max</span>(.x), <span class="at">yes =</span> <span class="st">"#882255"</span>,</span>
<span id="cb140-12"><a href="#cb140-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">no =</span> <span class="fu">ifelse</span>(.x <span class="sc">==</span> <span class="fu">min</span>(.x), <span class="st">"#44AA99"</span>, <span class="st">"black"</span>)</span>
<span id="cb140-13"><a href="#cb140-13" aria-hidden="true" tabindex="-1"></a>          ),</span>
<span id="cb140-14"><a href="#cb140-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">bold =</span> <span class="fu">ifelse</span>(</span>
<span id="cb140-15"><a href="#cb140-15" aria-hidden="true" tabindex="-1"></a>            .x <span class="sc">==</span> <span class="fu">max</span>(.x), <span class="at">yes =</span> <span class="cn">TRUE</span>,</span>
<span id="cb140-16"><a href="#cb140-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">no =</span> <span class="fu">ifelse</span>(.x <span class="sc">==</span> <span class="fu">min</span>(.x), <span class="cn">TRUE</span>, <span class="cn">FALSE</span>)</span>
<span id="cb140-17"><a href="#cb140-17" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb140-18"><a href="#cb140-18" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb140-19"><a href="#cb140-19" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb140-20"><a href="#cb140-20" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb140-21"><a href="#cb140-21" aria-hidden="true" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb140-22"><a href="#cb140-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">escape =</span> <span class="cn">FALSE</span>, <span class="at">booktabs =</span> T, <span class="at">digits =</span> <span class="dv">4</span>,</span>
<span id="cb140-23"><a href="#cb140-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="st">"html"</span>,</span>
<span id="cb140-24"><a href="#cb140-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Calibration Method"</span>, <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Calib."</span>, <span class="st">"Test"</span>), <span class="dv">6</span>))</span>
<span id="cb140-25"><a href="#cb140-25" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb140-26"><a href="#cb140-26" aria-hidden="true" tabindex="-1"></a>    kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>() <span class="sc">|&gt;</span></span>
<span id="cb140-27"><a href="#cb140-27" aria-hidden="true" tabindex="-1"></a>    kableExtra<span class="sc">::</span><span class="fu">add_header_above</span>(</span>
<span id="cb140-28"><a href="#cb140-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(</span>
<span id="cb140-29"><a href="#cb140-29" aria-hidden="true" tabindex="-1"></a>        <span class="st">""</span>, <span class="st">"MSE (True)"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"Brier"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"ECE"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"QMSE"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"WMSE"</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"LCS"</span> <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb140-30"><a href="#cb140-30" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb140-31"><a href="#cb140-31" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb140-32"><a href="#cb140-32" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-32-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-32-1" role="tab" aria-controls="tabset-32-1" aria-selected="true">Varying <span class="math inline">\(\alpha\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-32-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-32-2" role="tab" aria-controls="tabset-32-2" aria-selected="false">Varying <span class="math inline">\(\gamma\)</span></a></li></ul>
<div class="tab-content">
<div id="tabset-32-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-32-1-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-30-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-1" role="tab" aria-controls="tabset-30-1" aria-selected="true"><span class="math inline">\(\alpha = 1/3\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-30-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-2" role="tab" aria-controls="tabset-30-2" aria-selected="false"><span class="math inline">\(\alpha = 2/3\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-30-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-3" role="tab" aria-controls="tabset-30-3" aria-selected="false"><span class="math inline">\(\alpha = 1\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-30-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-4" role="tab" aria-controls="tabset-30-4" aria-selected="false"><span class="math inline">\(\alpha = 3/2\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-30-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-5" role="tab" aria-controls="tabset-30-5" aria-selected="false"><span class="math inline">\(\alpha = 3\)</span></a></li></ul>
<div class="tab-content">
<div id="tabset-30-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-30-1-tab">
<div class="cell">
<div class="cell-output-display">
<div id="tbl-recalib-alpha-13-rel" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;2.11: Deviation of the average calibration metrics from the reference (average metric computed using the uncalibrated predicted probabilities) over the 200 replications, for <span class="math inline">\(\alpha=0.33\)</span>, computed on the calibration and on the test set, using different predicted probabilities (in rows). Standard deviations are given between brackets.</caption>
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
MSE (True)
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Brier
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
ECE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
QMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
WMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
LCS
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th">Calibration Method</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0055 (0.0046)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0055 (0.0045)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7392 (0.0187)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.7415 (0.0232)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3645 (0.0519)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3991 (0.0499)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0182 (0.0086)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0404 (0.0206)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0797 (0.0163)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1092 (0.048)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0299 (0.0093)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0487 (0.0313)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0658 (0.0616)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0654 (0.0597)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9736 (0.0091)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9762 (0.0104)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0342 (0.1295)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0961 (0.1374)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2131 (0.0987)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3903 (0.1962)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9097 (0.2538)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0229 (0.4015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.46 (0.3116)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.67 (0.6865)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0228 (0.0077)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0232 (0.0081)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.7267 (0.0186)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7457 (0.0239)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.3296 (0.0556)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4012 (0.0524)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0386 (0.0223)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0797 (0.0184)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1357 (0.0569)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0676 (0.0226)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1062 (0.0542)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style="     color: black !important;">0.3141 (0.1088)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3191 (0.1093)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.957 (0.0101)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.982 (0.0132)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9359 (0.1396)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.1067 (0.1738)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4025 (0.2873)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9113 (0.2842)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.2907 (0.5483)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.0123 (0.7162)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.491 (1.6222)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0205 (0.0085)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0207 (0.0085)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7379 (0.0187)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7453 (0.0231)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3522 (0.057)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.387 (0.0518)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0161 (0.0072)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0463 (0.0199)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0665 (0.0164)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1094 (0.0497)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0073 (0.004)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0315 (0.0194)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style="     color: black !important;">0.2816 (0.1183)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2821 (0.1158)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9718 (0.0092)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9815 (0.0104)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0027 (0.1415)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0679 (0.1574)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1881 (0.1159)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4606 (0.2375)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7556 (0.247)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0281 (0.424)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1023 (0.0808)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3982 (0.3399)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0186 (0.0077)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0187 (0.0078)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7355 (0.0187)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7445 (0.0234)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3612 (0.057)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4018 (0.0513)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0117 (0.007)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0439 (0.0194)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0796 (0.0204)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1237 (0.0558)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0366 (0.0222)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0659 (0.0463)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style="     color: black !important;">0.256 (0.106)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2558 (0.1039)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9684 (0.0094)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9806 (0.0118)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0247 (0.1403)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.1067 (0.1661)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1376 (0.0933)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4466 (0.2642)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9121 (0.2943)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.1822 (0.5038)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.6195 (0.6098)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9626 (1.1471)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0356 (0.0114)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0367 (0.0124)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7305 (0.0184)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.749 (0.0241)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3743 (0.0524)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4083 (0.0525)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.011 (0.0069)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.05 (0.0247)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0719 (0.0158)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1434 (0.0597)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0369 (0.0194)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0827 (0.0506)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style="     color: black !important;">0.4947 (0.1607)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5096 (0.1716)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9622 (0.0097)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9862 (0.0139)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.0617 (0.14)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.1277 (0.1831)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1272 (0.0891)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5218 (0.3434)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8236 (0.2388)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.3761 (0.5756)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5872 (0.4857)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.1979 (1.2691)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0062 (0.0044)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0062 (0.0044)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.74 (0.0187)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7416 (0.0231)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3708 (0.0509)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4039 (0.0482)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0209 (0.0102)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0409 (0.0207)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0803 (0.0175)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.1083 (0.0484)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.031 (0.0131)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0462 (0.0332)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0619 (0.0617)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0616 (0.0601)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.974 (0.0091)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9761 (0.0104)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0361 (0.1287)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0987 (0.1373)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2223 (0.1025)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3882 (0.1954)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9089 (0.2517)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0174 (0.3997)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4558 (0.2903)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.6499 (0.6753)</span></td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
</div>
<div id="tabset-30-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-30-2-tab">
<div class="cell">
<div class="cell-output-display">
<div id="tbl-recalib-alpha-5-rel" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;2.12: Deviation of the average calibration metrics from the reference (average metric computed using the uncalibrated predicted probabilities) over the 200 replications, for <span class="math inline">\(\alpha=0.67\)</span>, computed on the calibration and on the test set, using different predicted probabilities (in rows). Standard deviations are given between brackets.</caption>
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
MSE (True)
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Brier
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
ECE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
QMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
WMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
LCS
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th">Calibration Method</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0297 (0.0239)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0298 (0.0237)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.936 (0.0126)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9397 (0.016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.786 (0.103)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8671 (0.1265)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0884 (0.0407)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1916 (0.1057)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.316 (0.0687)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4025 (0.161)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1503 (0.0505)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2434 (0.1696)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style="     color: black !important;">0.3153 (0.2667)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.313 (0.2572)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9922 (0.0047)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9958 (0.006)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0389 (0.1109)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0894 (0.1123)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4908 (0.2012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8086 (0.347)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.2121 (0.1554)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.2578 (0.2597)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.262 (0.496)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.5818 (0.9321)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style="     color: black !important;">0.1201 (0.0409)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1227 (0.0429)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.9203 (0.0127)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.945 (0.0171)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.7097 (0.1053)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8714 (0.1292)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.1846 (0.1217)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3161 (0.0766)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5024 (0.2015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3437 (0.1348)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5266 (0.2848)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style="     color: black !important;">1.3525 (0.4675)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.3745 (0.4707)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9754 (0.006)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0015 (0.0094)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9414 (0.133)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.1007 (0.1511)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8615 (0.6419)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.2168 (0.2343)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.5937 (0.437)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">2.8776 (1.3401)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">3.6775 (2.2323)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style="     color: black !important;">0.1073 (0.0433)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1079 (0.0436)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9344 (0.0131)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9444 (0.0165)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7594 (0.1118)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.8384 (0.1352)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0803 (0.0424)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2159 (0.1122)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2659 (0.0677)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4045 (0.1824)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.037 (0.0203)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.1585 (0.1054)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style="     color: black !important;">1.2166 (0.49)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.2182 (0.4834)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9905 (0.0053)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.001 (0.0072)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0071 (0.1453)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0622 (0.138)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4636 (0.2927)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9667 (0.5047)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0029 (0.1757)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.2996 (0.3794)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.313 (0.2056)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0259 (0.5627)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style="     color: black !important;">0.097 (0.0398)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0972 (0.04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9314 (0.013)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9432 (0.0167)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7826 (0.1111)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8716 (0.1255)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0615 (0.0352)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2071 (0.1093)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3172 (0.0865)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4509 (0.1934)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1871 (0.1217)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3153 (0.2323)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style="     color: black !important;">1.1048 (0.4459)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.1043 (0.4373)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9872 (0.0055)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0.0082)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0315 (0.138)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.1022 (0.1489)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3482 (0.2712)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9468 (0.5231)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.2175 (0.2651)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.4517 (0.4187)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.6864 (1.2563)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">2.2896 (1.6303)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style="     color: black !important;">0.1883 (0.061)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1936 (0.0644)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9252 (0.0127)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9491 (0.0177)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.813 (0.1039)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8827 (0.1259)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.056 (0.0357)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2337 (0.1353)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2864 (0.0742)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5333 (0.2408)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1861 (0.1117)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4137 (0.2881)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">2.1273 (0.6846)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">2.1885 (0.7363)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9806 (0.0061)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.0059 (0.0107)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.0704 (0.1354)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.1196 (0.1607)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3226 (0.2733)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.1074 (0.7509)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0968 (0.2248)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.7016 (0.6048)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.6162 (1.0614)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">2.8862 (2.0956)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0268 (0.0233)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.027 (0.0234)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9368 (0.0127)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.9395 (0.016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7985 (0.1015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8733 (0.1226)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0975 (0.0462)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1889 (0.1038)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3176 (0.0722)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.3987 (0.1632)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1365 (0.0574)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2127 (0.1647)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style="     color: black !important;">0.2692 (0.2652)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2682 (0.2588)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9928 (0.0047)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9955 (0.006)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0439 (0.1102)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0958 (0.1106)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5215 (0.2094)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7954 (0.3492)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.2103 (0.1482)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.2456 (0.2626)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.1423 (0.3915)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.41 (0.8697)</span></td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
</div>
<div id="tabset-30-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-30-3-tab">
<div class="cell">
<div class="cell-output-display">
<div id="tbl-recalib-alpha-1-rel" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;2.13: Deviation of the average calibration metrics from the reference (average metric computed using the uncalibrated predicted probabilities) over the 200 replications, for <span class="math inline">\(\alpha=1\)</span>, computed on the calibration and on the test set, using different predicted probabilities (in rows). Standard deviations are given between brackets.</caption>
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
MSE (True)
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Brier
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
ECE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
QMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
WMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
LCS
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th">Calibration Method</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9978 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0022 (0.0038)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9718 (0.0934)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0142 (0.0938)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7572 (0.1843)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.2136 (0.3604)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9602 (0.1492)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0483 (0.1608)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.871 (0.3079)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.1872 (0.4233)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9978 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0022 (0.0038)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9718 (0.0934)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0142 (0.0938)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7572 (0.1843)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.2136 (0.3604)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9602 (0.1492)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0483 (0.1608)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.871 (0.3079)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.1872 (0.4233)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.981 (0.0031)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0078 (0.0072)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.8801 (0.1207)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0221 (0.124)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.3329 (1.0406)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9638 (0.197)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.3234 (0.3034)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.985 (0.8329)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">2.7361 (1.1835)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.981 (0.0031)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0078 (0.0072)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.8801 (0.1207)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0221 (0.124)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.3329 (1.0406)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9638 (0.197)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.3234 (0.3034)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.985 (0.8329)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">2.7361 (1.1835)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9961 (0.0038)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0073 (0.0066)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.934 (0.1213)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.9845 (0.1226)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7529 (0.6115)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.5462 (0.9137)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.8012 (0.1696)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0776 (0.3037)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2136 (0.1464)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.8704 (0.6065)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9961 (0.0038)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0073 (0.0066)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.934 (0.1213)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.9845 (0.1226)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7529 (0.6115)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.5462 (0.9137)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.8012 (0.1696)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0776 (0.3037)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2136 (0.1464)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.8704 (0.6065)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9928 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0062 (0.0066)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9584 (0.1225)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0232 (0.1289)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5337 (0.491)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.5053 (0.9351)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9559 (0.2136)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.1896 (0.2978)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0437 (0.6984)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.5413 (0.7966)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9928 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0062 (0.0066)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9584 (0.1225)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0232 (0.1289)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5337 (0.491)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.5053 (0.9351)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9559 (0.2136)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.1896 (0.2978)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0437 (0.6984)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.5413 (0.7966)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9864 (0.0046)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.0118 (0.0088)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9987 (0.1183)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.034 (0.1321)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5282 (0.4338)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.6578 (1.0619)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8793 (0.1984)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.4028 (0.441)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0685 (0.6941)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">2.0871 (1.1422)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9864 (0.0046)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.0118 (0.0088)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9987 (0.1183)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.034 (0.1321)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5282 (0.4338)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.6578 (1.0619)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8793 (0.1984)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.4028 (0.441)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0685 (0.6941)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">2.0871 (1.1422)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9985 (0.0016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0018 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9804 (0.0921)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0213 (0.0845)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8115 (0.1745)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.1797 (0.3505)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9593 (0.1463)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0359 (0.1628)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.6974 (0.2343)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9334 (0.36)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9985 (0.0016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0018 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9804 (0.0921)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0213 (0.0845)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8115 (0.1745)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.1797 (0.3505)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9593 (0.1463)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0359 (0.1628)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.6974 (0.2343)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9334 (0.36)</span></td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
</div>
<div id="tabset-30-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-30-4-tab">
<div class="cell">
<div class="cell-output-display">
<div id="tbl-recalib-alpha-32-rel" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;2.14: Deviation of the average calibration metrics from the reference (average metric computed using the uncalibrated predicted probabilities) over the 200 replications, for <span class="math inline">\(\alpha=1.5\)</span>, computed on the calibration and on the test set, using different predicted probabilities (in rows). Standard deviations are given between brackets.</caption>
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
MSE (True)
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Brier
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
ECE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
QMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
WMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
LCS
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th">Calibration Method</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0256 (0.0197)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0257 (0.0196)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9223 (0.0142)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9266 (0.0175)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5317 (0.0682)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5774 (0.0681)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0724 (0.0347)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1624 (0.1157)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2446 (0.0484)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3278 (0.1233)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1143 (0.036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1932 (0.1385)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style="     color: black !important;">0.2087 (0.1598)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2083 (0.1549)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9871 (0.0058)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9923 (0.0073)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7642 (0.0941)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8173 (0.0945)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.351 (0.153)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.6891 (0.3311)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5267 (0.0922)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.6382 (0.1246)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3099 (0.1096)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4877 (0.2199)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0983 (0.0336)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1005 (0.0353)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.9068 (0.0143)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9318 (0.0188)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.4826 (0.0735)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5814 (0.0762)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.1562 (0.1153)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2451 (0.0565)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4097 (0.1514)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2531 (0.075)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4124 (0.2329)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style="     color: black !important;">0.7664 (0.264)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7798 (0.2675)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9706 (0.0054)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9977 (0.0085)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.6934 (0.103)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8213 (0.1023)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.6661 (0.3741)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5281 (0.1094)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7994 (0.1858)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7041 (0.2486)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.0463 (0.3602)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0874 (0.0356)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0883 (0.0361)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9207 (0.0144)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9314 (0.0183)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5162 (0.0773)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.5622 (0.069)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.062 (0.0332)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1853 (0.1294)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2038 (0.0473)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3339 (0.1371)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.027 (0.015)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.1294 (0.1162)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style="     color: black !important;">0.6667 (0.2736)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.6689 (0.2708)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9854 (0.0069)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.997 (0.0098)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7388 (0.1033)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7961 (0.1041)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.326 (0.1995)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8247 (0.4336)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4416 (0.1015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.6533 (0.1802)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0753 (0.0498)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3471 (0.2853)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0791 (0.0327)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0797 (0.0328)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9177 (0.0145)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9303 (0.0184)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5286 (0.0743)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5844 (0.0755)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0464 (0.0283)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1798 (0.1393)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2403 (0.0542)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3745 (0.1556)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1271 (0.0786)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2485 (0.2035)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style="     color: black !important;">0.6098 (0.2558)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.6097 (0.2509)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9823 (0.0067)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.996 (0.0088)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7603 (0.0987)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8247 (0.1071)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2235 (0.1429)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7746 (0.3736)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5268 (0.1168)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7197 (0.1766)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3141 (0.2033)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5739 (0.3182)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style="     color: black !important;">0.1522 (0.0491)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1546 (0.0495)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.912 (0.0148)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9352 (0.0198)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5492 (0.0707)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.594 (0.0799)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0445 (0.0291)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2006 (0.1344)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2209 (0.0465)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4376 (0.1966)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1354 (0.0745)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3218 (0.2706)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.1781 (0.397)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.195 (0.3996)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9762 (0.0072)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.0015 (0.01)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7938 (0.0996)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8373 (0.1097)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2417 (0.2026)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8175 (0.4057)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4809 (0.1029)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.834 (0.2492)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3548 (0.2237)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7568 (0.3772)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.023 (0.019)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0231 (0.0191)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9232 (0.0141)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.9264 (0.0175)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5351 (0.0679)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5769 (0.071)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0805 (0.0375)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1604 (0.1167)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2436 (0.0496)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.3243 (0.1252)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0876 (0.0356)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1572 (0.1358)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style="     color: black !important;">0.1795 (0.1493)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1801 (0.1468)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9882 (0.0057)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.992 (0.007)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7781 (0.0923)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8266 (0.0847)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3879 (0.1636)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.6672 (0.3152)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5251 (0.0919)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.6282 (0.1232)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1932 (0.0799)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3383 (0.208)</span></td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
</div>
<div id="tabset-30-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-30-5-tab">
<div class="cell">
<div class="cell-output-display">
<div id="tbl-recalib-alpha-3-rel" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;2.15: Deviation of the average calibration metrics from the reference (average metric computed using the uncalibrated predicted probabilities) over the 200 replications, for <span class="math inline">\(\alpha=3\)</span>, computed on the calibration and on the test set, using different predicted probabilities (in rows). Standard deviations are given between brackets.</caption>
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
MSE (True)
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Brier
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
ECE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
QMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
WMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
LCS
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th">Calibration Method</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.004 (0.0031)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.004 (0.0031)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.6466 (0.0184)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.6496 (0.022)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2956 (0.0438)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3233 (0.0409)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0117 (0.0056)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0266 (0.0134)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0506 (0.0097)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0701 (0.0257)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0213 (0.0062)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.035 (0.0184)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0226 (0.0182)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0227 (0.0179)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.904 (0.0141)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9099 (0.0164)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4547 (0.0642)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4983 (0.0616)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0571 (0.0271)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1336 (0.0646)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1958 (0.0319)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.262 (0.0655)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.081 (0.0253)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1344 (0.0572)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0148 (0.0051)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0151 (0.0053)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.6358 (0.0183)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.6531 (0.0229)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2692 (0.0464)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3261 (0.0434)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0252 (0.0143)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0507 (0.0114)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0874 (0.0321)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0441 (0.0126)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0713 (0.0323)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0779 (0.0268)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0794 (0.0274)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8889 (0.0134)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9147 (0.0164)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4132 (0.0679)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4998 (0.0658)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1238 (0.0665)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1965 (0.0373)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3255 (0.0813)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1833 (0.0529)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.285 (0.0933)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style="     color: black !important;">0.013 (0.0053)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0131 (0.0054)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.6456 (0.0183)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.6527 (0.022)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2921 (0.0478)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3179 (0.0419)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0097 (0.0051)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0298 (0.0136)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0429 (0.0103)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.07 (0.0266)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0047 (0.0024)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0214 (0.0133)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0678 (0.0264)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0682 (0.0262)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9025 (0.0147)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.914 (0.0172)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4427 (0.0679)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4898 (0.0648)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0472 (0.0279)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1494 (0.0706)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1708 (0.0359)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2694 (0.0724)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0202 (0.0112)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.089 (0.0535)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0118 (0.0049)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0119 (0.005)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.6435 (0.0183)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.6519 (0.0224)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2934 (0.0446)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3286 (0.0412)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0067 (0.0042)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0284 (0.0143)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.051 (0.0118)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.079 (0.031)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0209 (0.0132)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0401 (0.0273)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0614 (0.0258)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0615 (0.0252)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9002 (0.0145)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9132 (0.0167)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4545 (0.0673)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5038 (0.0635)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0384 (0.0231)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1447 (0.0638)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1999 (0.0414)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.296 (0.0816)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0525 (0.0337)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1249 (0.0716)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0229 (0.0076)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0232 (0.0076)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.6394 (0.0185)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.6558 (0.0233)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3076 (0.0464)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3316 (0.0436)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0073 (0.0043)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0325 (0.0158)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0458 (0.0091)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0927 (0.0359)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0226 (0.0124)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0534 (0.0321)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style="     color: black !important;">0.1195 (0.0399)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1201 (0.0394)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8941 (0.0147)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9178 (0.0175)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.473 (0.0651)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5079 (0.0668)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0362 (0.0191)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.157 (0.0694)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1788 (0.0338)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.344 (0.1047)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0678 (0.0469)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1815 (0.096)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style="     color: black !important;">0.009 (0.003)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.009 (0.003)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.6492 (0.0181)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.6514 (0.022)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.292 (0.0467)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.3115 (0.0441)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0176 (0.0078)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0309 (0.0144)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0501 (0.0103)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0692 (0.0247)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0234 (0.0101)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0364 (0.0184)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0344 (0.015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0347 (0.0151)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9065 (0.014)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.911 (0.0157)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4765 (0.0623)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5132 (0.0549)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0737 (0.0347)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1387 (0.0661)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1923 (0.0317)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2562 (0.0641)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0356 (0.0182)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0819 (0.0483)</span></td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-32-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-32-2-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-31-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-31-1" role="tab" aria-controls="tabset-31-1" aria-selected="true"><span class="math inline">\(\gamma = 1/3\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-31-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-31-2" role="tab" aria-controls="tabset-31-2" aria-selected="false"><span class="math inline">\(\gamma = 2/3\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-31-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-31-3" role="tab" aria-controls="tabset-31-3" aria-selected="false"><span class="math inline">\(\gamma = 1\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-31-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-31-4" role="tab" aria-controls="tabset-31-4" aria-selected="false"><span class="math inline">\(\gamma = 3/2\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-31-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-31-5" role="tab" aria-controls="tabset-31-5" aria-selected="false"><span class="math inline">\(\gamma = 2\)</span></a></li></ul>
<div class="tab-content">
<div id="tabset-31-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-31-1-tab">
<div class="cell">
<div class="cell-output-display">
<div id="tbl-recalib-gamma-13-rel" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;2.16: Deviation of the average calibration metrics from the reference (average metric computed using the uncalibrated predicted probabilities) over the 200 replications, for <span class="math inline">\(\gamma=0.33\)</span>, computed on the calibration and on the test set, using different predicted probabilities (in rows). Standard deviations are given between brackets.</caption>
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
MSE (True)
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Brier
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
ECE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
QMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
WMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
LCS
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th">Calibration Method</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0055 (0.0046)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0055 (0.0045)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7392 (0.0187)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.7415 (0.0232)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3645 (0.0519)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3991 (0.0499)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0182 (0.0086)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0404 (0.0206)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0797 (0.0163)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1092 (0.048)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0299 (0.0093)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0487 (0.0313)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0658 (0.0616)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0654 (0.0597)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9736 (0.0091)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9762 (0.0104)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0342 (0.1295)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0961 (0.1374)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2131 (0.0987)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3903 (0.1962)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9097 (0.2538)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0229 (0.4015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.46 (0.3116)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.67 (0.6865)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0228 (0.0077)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0232 (0.0081)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.7267 (0.0186)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7457 (0.0239)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.3296 (0.0556)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4012 (0.0524)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0386 (0.0223)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0797 (0.0184)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1357 (0.0569)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0676 (0.0226)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1062 (0.0542)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style="     color: black !important;">0.3141 (0.1088)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3191 (0.1093)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.957 (0.0101)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.982 (0.0132)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9359 (0.1396)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.1067 (0.1738)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4025 (0.2873)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9113 (0.2842)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.2907 (0.5483)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.0123 (0.7162)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.491 (1.6222)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0205 (0.0085)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0207 (0.0085)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7379 (0.0187)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7453 (0.0231)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3522 (0.057)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.387 (0.0518)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0161 (0.0072)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0463 (0.0199)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0665 (0.0164)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1094 (0.0497)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0073 (0.004)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0315 (0.0194)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style="     color: black !important;">0.2816 (0.1183)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2821 (0.1158)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9718 (0.0092)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9815 (0.0104)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0027 (0.1415)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0679 (0.1574)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1881 (0.1159)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4606 (0.2375)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7556 (0.247)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0281 (0.424)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1023 (0.0808)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3982 (0.3399)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0186 (0.0077)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0187 (0.0078)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7355 (0.0187)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7445 (0.0234)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3612 (0.057)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4018 (0.0513)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0117 (0.007)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0439 (0.0194)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0796 (0.0204)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1237 (0.0558)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0366 (0.0222)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0659 (0.0463)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style="     color: black !important;">0.256 (0.106)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2558 (0.1039)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9684 (0.0094)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9806 (0.0118)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0247 (0.1403)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.1067 (0.1661)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1376 (0.0933)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4466 (0.2642)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9121 (0.2943)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.1822 (0.5038)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.6195 (0.6098)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9626 (1.1471)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0356 (0.0114)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0367 (0.0124)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7305 (0.0184)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.749 (0.0241)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3743 (0.0524)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4083 (0.0525)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.011 (0.0069)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.05 (0.0247)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0719 (0.0158)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1434 (0.0597)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0369 (0.0194)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0827 (0.0506)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style="     color: black !important;">0.4947 (0.1607)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5096 (0.1716)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9622 (0.0097)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9862 (0.0139)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.0617 (0.14)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.1277 (0.1831)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1272 (0.0891)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5218 (0.3434)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8236 (0.2388)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.3761 (0.5756)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5872 (0.4857)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.1979 (1.2691)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0062 (0.0044)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0062 (0.0044)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.74 (0.0187)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7416 (0.0231)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3708 (0.0509)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4039 (0.0482)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0209 (0.0102)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0409 (0.0207)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0803 (0.0175)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.1083 (0.0484)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.031 (0.0131)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0462 (0.0332)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0619 (0.0617)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0616 (0.0601)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.974 (0.0091)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9761 (0.0104)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0361 (0.1287)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0987 (0.1373)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2223 (0.1025)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3882 (0.1954)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9089 (0.2517)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0174 (0.3997)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4558 (0.2903)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.6499 (0.6753)</span></td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
</div>
<div id="tabset-31-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-31-2-tab">
<div class="cell">
<div class="cell-output-display">
<div id="tbl-recalib-gamma-23-rel" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;2.17: Deviation of the average calibration metrics from the reference (average metric computed using the uncalibrated predicted probabilities) over the 200 replications, for <span class="math inline">\(\gamma=0.67\)</span>, computed on the calibration and on the test set, using different predicted probabilities (in rows). Standard deviations are given between brackets.</caption>
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
MSE (True)
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Brier
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
ECE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
QMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
WMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
LCS
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th">Calibration Method</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0297 (0.0239)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0298 (0.0237)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.936 (0.0126)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9397 (0.016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.786 (0.103)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8671 (0.1265)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0884 (0.0407)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1916 (0.1057)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.316 (0.0687)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4025 (0.161)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1503 (0.0505)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2434 (0.1696)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style="     color: black !important;">0.3153 (0.2667)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.313 (0.2572)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9922 (0.0047)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9958 (0.006)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0389 (0.1109)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0894 (0.1123)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4908 (0.2012)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8086 (0.347)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.2121 (0.1554)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.2578 (0.2597)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.262 (0.496)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.5818 (0.9321)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style="     color: black !important;">0.1201 (0.0409)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1227 (0.0429)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.9203 (0.0127)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.945 (0.0171)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.7097 (0.1053)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8714 (0.1292)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.1846 (0.1217)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3161 (0.0766)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5024 (0.2015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3437 (0.1348)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5266 (0.2848)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style="     color: black !important;">1.3525 (0.4675)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.3745 (0.4707)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9754 (0.006)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0015 (0.0094)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9414 (0.133)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.1007 (0.1511)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8615 (0.6419)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.2168 (0.2343)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.5937 (0.437)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">2.8776 (1.3401)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">3.6775 (2.2323)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style="     color: black !important;">0.1073 (0.0433)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1079 (0.0436)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9344 (0.0131)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9444 (0.0165)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7594 (0.1118)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.8384 (0.1352)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0803 (0.0424)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2159 (0.1122)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2659 (0.0677)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4045 (0.1824)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.037 (0.0203)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.1585 (0.1054)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style="     color: black !important;">1.2166 (0.49)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.2182 (0.4834)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9905 (0.0053)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.001 (0.0072)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0071 (0.1453)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0622 (0.138)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4636 (0.2927)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9667 (0.5047)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0029 (0.1757)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.2996 (0.3794)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.313 (0.2056)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0259 (0.5627)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style="     color: black !important;">0.097 (0.0398)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0972 (0.04)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9314 (0.013)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9432 (0.0167)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7826 (0.1111)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8716 (0.1255)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0615 (0.0352)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2071 (0.1093)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3172 (0.0865)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4509 (0.1934)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1871 (0.1217)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3153 (0.2323)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style="     color: black !important;">1.1048 (0.4459)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.1043 (0.4373)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9872 (0.0055)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0.0082)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0315 (0.138)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.1022 (0.1489)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3482 (0.2712)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9468 (0.5231)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.2175 (0.2651)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.4517 (0.4187)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.6864 (1.2563)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">2.2896 (1.6303)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style="     color: black !important;">0.1883 (0.061)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1936 (0.0644)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9252 (0.0127)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9491 (0.0177)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.813 (0.1039)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8827 (0.1259)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.056 (0.0357)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2337 (0.1353)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2864 (0.0742)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5333 (0.2408)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1861 (0.1117)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4137 (0.2881)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">2.1273 (0.6846)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">2.1885 (0.7363)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9806 (0.0061)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.0059 (0.0107)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.0704 (0.1354)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.1196 (0.1607)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3226 (0.2733)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.1074 (0.7509)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0968 (0.2248)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.7016 (0.6048)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.6162 (1.0614)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">2.8862 (2.0956)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0268 (0.0233)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.027 (0.0234)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9368 (0.0127)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.9395 (0.016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7985 (0.1015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8733 (0.1226)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0975 (0.0462)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1889 (0.1038)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3176 (0.0722)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.3987 (0.1632)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1365 (0.0574)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2127 (0.1647)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style="     color: black !important;">0.2692 (0.2652)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2682 (0.2588)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9928 (0.0047)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9955 (0.006)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0439 (0.1102)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0958 (0.1106)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5215 (0.2094)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7954 (0.3492)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.2103 (0.1482)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.2456 (0.2626)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.1423 (0.3915)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.41 (0.8697)</span></td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
</div>
<div id="tabset-31-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-31-3-tab">
<div class="cell">
<div class="cell-output-display">
<div id="tbl-recalib-gamma-1-rel" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;2.18: Deviation of the average calibration metrics from the reference (average metric computed using the uncalibrated predicted probabilities) over the 200 replications, for <span class="math inline">\(\gamma=1\)</span>, computed on the calibration and on the test set, using different predicted probabilities (in rows). Standard deviations are given between brackets.</caption>
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
MSE (True)
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Brier
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
ECE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
QMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
WMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
LCS
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th">Calibration Method</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9978 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0022 (0.0038)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9718 (0.0934)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0142 (0.0938)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7572 (0.1843)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.2136 (0.3604)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9602 (0.1492)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0483 (0.1608)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.871 (0.3079)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.1872 (0.4233)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9978 (0.0017)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0022 (0.0038)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9718 (0.0934)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0142 (0.0938)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7572 (0.1843)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.2136 (0.3604)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9602 (0.1492)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0483 (0.1608)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.871 (0.3079)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.1872 (0.4233)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.981 (0.0031)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0078 (0.0072)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.8801 (0.1207)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0221 (0.124)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.3329 (1.0406)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9638 (0.197)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.3234 (0.3034)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.985 (0.8329)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">2.7361 (1.1835)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.981 (0.0031)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0078 (0.0072)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.8801 (0.1207)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0221 (0.124)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.3329 (1.0406)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9638 (0.197)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.3234 (0.3034)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.985 (0.8329)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">2.7361 (1.1835)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9961 (0.0038)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0073 (0.0066)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.934 (0.1213)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.9845 (0.1226)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7529 (0.6115)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.5462 (0.9137)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.8012 (0.1696)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0776 (0.3037)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2136 (0.1464)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.8704 (0.6065)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9961 (0.0038)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0073 (0.0066)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.934 (0.1213)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.9845 (0.1226)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7529 (0.6115)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.5462 (0.9137)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.8012 (0.1696)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0776 (0.3037)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2136 (0.1464)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.8704 (0.6065)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9928 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0062 (0.0066)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9584 (0.1225)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0232 (0.1289)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5337 (0.491)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.5053 (0.9351)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9559 (0.2136)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.1896 (0.2978)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0437 (0.6984)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.5413 (0.7966)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9928 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0062 (0.0066)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9584 (0.1225)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0232 (0.1289)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5337 (0.491)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.5053 (0.9351)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9559 (0.2136)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.1896 (0.2978)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0437 (0.6984)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.5413 (0.7966)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9864 (0.0046)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.0118 (0.0088)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9987 (0.1183)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.034 (0.1321)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5282 (0.4338)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.6578 (1.0619)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8793 (0.1984)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.4028 (0.441)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0685 (0.6941)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">2.0871 (1.1422)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9864 (0.0046)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.0118 (0.0088)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9987 (0.1183)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.034 (0.1321)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5282 (0.4338)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.6578 (1.0619)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8793 (0.1984)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.4028 (0.441)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0685 (0.6941)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">2.0871 (1.1422)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9985 (0.0016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0018 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9804 (0.0921)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0213 (0.0845)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8115 (0.1745)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.1797 (0.3505)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9593 (0.1463)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0359 (0.1628)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.6974 (0.2343)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9334 (0.36)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">Inf (NaN)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9985 (0.0016)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0018 (0.0036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9804 (0.0921)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0213 (0.0845)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8115 (0.1745)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.1797 (0.3505)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9593 (0.1463)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1.0359 (0.1628)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.6974 (0.2343)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9334 (0.36)</span></td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
</div>
<div id="tabset-31-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-31-4-tab">
<div class="cell">
<div class="cell-output-display">
<div id="tbl-recalib-gamma-32-rel" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;2.19: Deviation of the average calibration metrics from the reference (average metric computed using the uncalibrated predicted probabilities) over the 200 replications, for <span class="math inline">\(\gamma=1.5\)</span>, computed on the calibration and on the test set, using different predicted probabilities (in rows). Standard deviations are given between brackets.</caption>
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
MSE (True)
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Brier
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
ECE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
QMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
WMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
LCS
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th">Calibration Method</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">No Calibration</td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">1 (0)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0256 (0.0197)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0257 (0.0196)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9223 (0.0142)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9266 (0.0175)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5317 (0.0682)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5774 (0.0681)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0724 (0.0347)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1624 (0.1157)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2446 (0.0484)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3278 (0.1233)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1143 (0.036)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1932 (0.1385)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">beta</td>
<td style="text-align: left;"><span style="     color: black !important;">0.2087 (0.1598)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2083 (0.1549)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9871 (0.0058)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9923 (0.0073)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7642 (0.0941)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8173 (0.0945)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.351 (0.153)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.6891 (0.3311)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5267 (0.0922)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.6382 (0.1246)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3099 (0.1096)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4877 (0.2199)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0983 (0.0336)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1005 (0.0353)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.9068 (0.0143)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9318 (0.0188)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.4826 (0.0735)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5814 (0.0762)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.1562 (0.1153)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2451 (0.0565)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4097 (0.1514)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2531 (0.075)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4124 (0.2329)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">isotonic</td>
<td style="text-align: left;"><span style="     color: black !important;">0.7664 (0.264)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7798 (0.2675)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9706 (0.0054)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9977 (0.0085)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.6934 (0.103)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8213 (0.1023)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0 (0)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.6661 (0.3741)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5281 (0.1094)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7994 (0.1858)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7041 (0.2486)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.0463 (0.3602)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0874 (0.0356)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0883 (0.0361)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9207 (0.0144)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9314 (0.0183)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5162 (0.0773)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.5622 (0.069)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.062 (0.0332)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1853 (0.1294)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.2038 (0.0473)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3339 (0.1371)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.027 (0.015)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.1294 (0.1162)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_0</td>
<td style="text-align: left;"><span style="     color: black !important;">0.6667 (0.2736)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.6689 (0.2708)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9854 (0.0069)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.997 (0.0098)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7388 (0.1033)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7961 (0.1041)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.326 (0.1995)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8247 (0.4336)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4416 (0.1015)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.6533 (0.1802)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0753 (0.0498)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3471 (0.2853)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style="     color: black !important;">0.0791 (0.0327)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0797 (0.0328)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9177 (0.0145)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9303 (0.0184)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5286 (0.0743)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5844 (0.0755)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0464 (0.0283)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1798 (0.1393)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2403 (0.0542)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3745 (0.1556)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1271 (0.0786)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2485 (0.2035)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_1</td>
<td style="text-align: left;"><span style="     color: black !important;">0.6098 (0.2558)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.6097 (0.2509)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9823 (0.0067)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.996 (0.0088)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7603 (0.0987)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8247 (0.1071)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2235 (0.1429)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7746 (0.3736)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5268 (0.1168)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7197 (0.1766)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3141 (0.2033)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5739 (0.3182)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style="     color: black !important;">0.1522 (0.0491)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1546 (0.0495)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.912 (0.0148)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9352 (0.0198)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5492 (0.0707)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.594 (0.0799)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0445 (0.0291)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2006 (0.1344)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2209 (0.0465)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4376 (0.1966)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1354 (0.0745)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3218 (0.2706)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">locfit_2</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.1781 (0.397)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.195 (0.3996)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9762 (0.0072)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #882255 !important;">1.0015 (0.01)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7938 (0.0996)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8373 (0.1097)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2417 (0.2026)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8175 (0.4057)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.4809 (0.1029)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.834 (0.2492)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3548 (0.2237)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7568 (0.3772)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.023 (0.019)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.0231 (0.0191)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9232 (0.0141)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.9264 (0.0175)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5351 (0.0679)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5769 (0.071)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0805 (0.0375)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1604 (0.1167)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.2436 (0.0496)</span></td>
<td style="text-align: left;"><span style=" font-weight: bold;    color: #44AA99 !important;">0.3243 (0.1252)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.0876 (0.0356)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1572 (0.1358)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">platt</td>
<td style="text-align: left;"><span style="     color: black !important;">0.1795 (0.1493)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1801 (0.1468)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.9882 (0.0057)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.992 (0.007)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.7781 (0.0923)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.8266 (0.0847)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3879 (0.1636)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.6672 (0.3152)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.5251 (0.0919)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.6282 (0.1232)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.1932 (0.0799)</span></td>
<td style="text-align: left;"><span style="     color: black !important;">0.3383 (0.208)</span></td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
</div>
<div id="tabset-31-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-31-5-tab">
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There were 24 warnings in `mutate()`.
The first warning was:
ℹ In argument: `across(...)`.
Caused by warning in `max()`:
! no non-missing arguments, returning NA
ℹ Run `dplyr::last_dplyr_warnings()` to see the 23 remaining warnings.</code></pre>
</div>
<div class="cell-output-display">
<div id="tbl-recalib-gamma-2-rel" class="anchored">
<table class="table" data-quarto-postprocess="true" style="margin-left: auto; margin-right: auto;">
<caption>Table&nbsp;2.20: Deviation of the average calibration metrics from the reference (average metric computed using the uncalibrated predicted probabilities) over the 200 replications, for <span class="math inline">\(\gamma=2\)</span>, computed on the calibration and on the test set, using different predicted probabilities (in rows). Standard deviations are given between brackets.</caption>
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="empty-cells: hide; border-bottom: hidden"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
MSE (True)
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Brier
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
ECE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
QMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
WMSE
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
LCS
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th">Calibration Method</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Calib.</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
</tr>
</thead>
<tbody>
<tr class="header">
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>

</tbody>
</table>
</div>


</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-Kull_2017" class="csl-entry" role="listitem">
Kull, Meelis, Telmo M. Silva Filho, and Peter Flach. 2017. <span>“Beyond Sigmoids: How to Obtain Well-Calibrated Probabilities from Binary Classifiers with Beta Calibration.”</span> <em>Electronic Journal of Statistics</em> 11 (2). <a href="https://doi.org/10.1214/17-ejs1338si">https://doi.org/10.1214/17-ejs1338si</a>.
</div>
<div id="ref-platt1999probabilistic" class="csl-entry" role="listitem">
Platt, John et al. 1999. <span>“Probabilistic Outputs for Support Vector Machines and Comparisons to Regularized Likelihood Methods.”</span> <em>Advances in Large Margin Classifiers</em> 10 (3): 61–74.
</div>
<div id="ref-Zadrozny_2002" class="csl-entry" role="listitem">
Zadrozny, Bianca, and Charles Elkan. 2002. <span>“Transforming Classifier Scores into Accurate Multiclass Probability Estimates.”</span> In <em>Proceedings of the Eighth ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</em>. KDD02. ACM. <a href="https://doi.org/10.1145/775047.775151">https://doi.org/10.1145/775047.775151</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./calibration.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Calibration</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./rf-single.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">(Re)Calibration of a Random Forest</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>